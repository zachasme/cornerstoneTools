/*! cornerstone-tools - 1.1.0 - 2018-02-08 | (c) 2017 Chris Hafey | https://github.com/chafey/cornerstoneTools */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("cornerstone-math")):"function"==typeof define&&define.amd?define("cornerstoneTools",["cornerstone-math"],t):"object"==typeof exports?exports.cornerstoneTools=t(require("cornerstone-math")):e.cornerstoneTools=t(e.cornerstoneMath)}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=60)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.external=t.cornerstoneMath=void 0;var o=n(61),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=window.cornerstone,i=window.$,l=window.Hammer,u={set cornerstone(e){a=e},get cornerstone(){return a},set $(e){i=e},get $(){return i},set Hammer(e){l=e},get Hammer(){return l}};t.cornerstoneMath=r,t.external=u},function(e,t,n){"use strict";function o(e){var t=s.external.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=c.globalImageIdSpecificToolStateManager),t.toolStateManager}function r(e,t,n){o(e).add(e,t,n);var r={toolType:t,element:e,measurementData:n};(0,d.default)(e,"CornerstoneToolsMeasurementAdded",r)}function a(e,t){return o(e).get(e,t)}function i(e,t,n){for(var r=o(e),a=r.get(e,t),i=-1,l=0;l<a.data.length;l++)a.data[l]===n&&(i=l);if(-1!==i){a.data.splice(i,1);var u={toolType:t,element:e,measurementData:n};(0,d.default)(e,"CornerstoneToolsMeasurementRemoved",u)}}function l(e,t){var n=o(e),r=n.get(e,t);void 0!==r&&(r.data=[])}function u(e,t){s.external.cornerstone.getEnabledElement(e).toolStateManager=t}Object.defineProperty(t,"__esModule",{value:!0}),t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=void 0;var s=n(0),c=n(15),f=n(3),d=function(e){return e&&e.__esModule?e:{default:e}}(f);t.addToolState=r,t.getToolState=a,t.removeToolState=i,t.clearToolState=l,t.setElementToolStateManager=u,t.getElementToolStateManager=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return 0!=(t&1<<e-1)}},function(e,t,n){"use strict";function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=void 0;"function"==typeof window.CustomEvent?o=new CustomEvent(t.toLocaleLowerCase(),{detail:n,cancelable:!0}):(o=document.createEvent("CustomEvent"),o.initCustomEvent(t.toLocaleLowerCase(),!0,!0,n));var a=r.external.$.Event(t,n);return r.external.$(e).trigger(a,n),!a.isImmediatePropagationStopped()&&e.dispatchEvent(o)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(0)},function(e,t,n){"use strict";function o(e){d=e}function r(){return d}function a(e){c=e}function i(){return c}function l(e){f=e}function u(){return f}function s(e){return e?f:c}Object.defineProperty(t,"__esModule",{value:!0});var c="white",f="greenyellow",d="transparent",g={setFillColor:o,getFillColor:r,setToolColor:a,getToolColor:i,setActiveColor:l,getActiveColor:u,getColorIfActive:s};t.default=g},function(e,t,n){"use strict";function o(e){l=e}function r(){return l}function a(e){u=e}function i(){return u}Object.defineProperty(t,"__esModule",{value:!0});var l=1,u=2,s={setToolWidth:o,getToolWidth:r,setActiveWidth:a,getActiveWidth:i};t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a,i){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var l=r.default.getFont(),u=r.default.getFontSize(),s=r.default.getBackgroundColor();e.save(),e.font=l,e.textBaseline="top",e.strokeStyle=a;var c=0;t.forEach(function(t){var n=e.measureText(t).width;c=Math.max(c,n)}),e.fillStyle=s;var f={width:c+10,height:5+t.length*(u+5)};return i&&i.centering&&!0===i.centering.x&&(n-=f.width/2),i&&i.centering&&!0===i.centering.y&&(o-=f.height/2),f.left=n,f.top=o,i&&!0===i.debug&&(e.fillStyle="#FF0000"),e.fillRect(f.left,f.top,f.width,f.height),t.forEach(function(t,r){e.fillStyle=a,e.fillText(t,n+5,o+5+r*(u+5))}),e.restore(),f};var o=n(14),r=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){var i=r.external.cornerstone,l=t.element,u=e.createNewMeasurement(t);if(u){var s={mouseButtonMask:t.which};(0,b.addToolState)(t.element,e.toolType,u),r.external.$(l).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||o),r.external.$(l).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),r.external.$(l).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&r.external.$(l).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),i.updateImage(l);var c=void 0;c=1===Object.keys(u.handles).length?d.default:v.default;var f=void 0;f=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,c(t,e.toolType,u,u.handles.end,function(){u.active=!1,u.invalidated=!0,(0,x.default)(t,u.handles)&&(0,b.removeToolState)(l,e.toolType,u),r.external.$(l).on("CornerstoneToolsMouseMove",s,e.mouseMoveCallback||o),r.external.$(l).on("CornerstoneToolsMouseDown",s,e.mouseDownCallback||a),r.external.$(l).on("CornerstoneToolsMouseDownActivate",s,e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&r.external.$(l).on("CornerstoneToolsMouseDoubleClick",s,e.mouseDoubleClickCallback),i.updateImage(l)},f)}}function n(n,o){if((0,y.default)(o.which,n.data.mouseButtonMask))return e.addNewMeasurement?e.addNewMeasurement(o):t(o),!1}function o(t,n){if(i.default.setCoords(n),0===n.which){var o=(0,b.getToolState)(n.element,e.toolType);if(o){for(var a=!1,l=0;l<o.data.length;l++){var u=n.currentPoints.canvas,s=o.data[l];!0===(0,c.default)(n.element,s.handles,u)&&(a=!0),(e.pointNearTool(n.element,s,u)&&!s.active||!e.pointNearTool(n.element,s,u)&&s.active)&&(s.active=!s.active,a=!0)}!0===a&&r.external.cornerstone.updateImage(n.element)}}}function a(t,n){function a(){i.invalidated=!0,(0,x.default)(n,i.handles)&&(0,b.removeToolState)(l,e.toolType,i),r.external.cornerstone.updateImage(l),r.external.$(l).on("CornerstoneToolsMouseMove",n,e.mouseMoveCallback||o)}var i=void 0,l=n.element;if((0,y.default)(n.which,t.data.mouseButtonMask)){var s=n.startPoints.canvas,c=(0,b.getToolState)(t.currentTarget,e.toolType);if(c){var f=void 0,g=void 0;for(g=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,f=0;f<c.data.length;f++){i=c.data[f];var v=(0,u.default)(l,i.handles,s,6);if(v)return r.external.$(l).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||o),i.active=!0,(0,d.default)(n,e.toolType,i,v,a,g),t.stopImmediatePropagation(),!1}if(e.pointNearTool){var h=e.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(f=0;f<c.data.length;f++)if(i=c.data[f],i.active=!1,e.pointNearTool(l,i,s))return i.active=!0,r.external.$(l).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||o),(0,m.default)(t,i,c,e.toolType,h,a),t.stopImmediatePropagation(),!1}}}}function l(t){t.removeEventListener("cornerstoneimagerendered",s),r.external.$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||o),r.external.$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),r.external.$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&r.external.$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),r.external.cornerstone.updateImage(t)}function s(t){e.onImageRendered(t,t.detail)}function f(t){t.removeEventListener("cornerstoneimagerendered",s),r.external.$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||o),r.external.$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),r.external.$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&r.external.$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),t.addEventListener("cornerstoneimagerendered",s),r.external.cornerstone.updateImage(t)}function g(t,i){var l={mouseButtonMask:i};t.removeEventListener("cornerstoneimagerendered",s),r.external.$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||o),r.external.$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),r.external.$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),t.addEventListener("cornerstoneimagerendered",s),r.external.$(t).on("CornerstoneToolsMouseMove",l,e.mouseMoveCallback||o),r.external.$(t).on("CornerstoneToolsMouseDown",l,e.mouseDownCallback||a),r.external.$(t).on("CornerstoneToolsMouseDownActivate",l,e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&(r.external.$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),r.external.$(t).on("CornerstoneToolsMouseDoubleClick",l,e.mouseDoubleClickCallback)),r.external.cornerstone.updateImage(t)}function h(t,i){var l={mouseButtonMask:i},u="CornerstoneToolsToolDeactivated",c={mouseButtonMask:i,toolType:e.toolType,type:u};(0,M.default)(t,u,c),t.removeEventListener("cornerstoneimagerendered",s),r.external.$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||o),r.external.$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),r.external.$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),t.addEventListener("cornerstoneimagerendered",s),r.external.$(t).on("CornerstoneToolsMouseMove",l,e.mouseMoveCallback||o),r.external.$(t).on("CornerstoneToolsMouseDown",l,e.mouseDownCallback||a),e.mouseDoubleClickCallback&&(r.external.$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),r.external.$(t).on("CornerstoneToolsMouseDoubleClick",l,e.mouseDoubleClickCallback)),e.deactivate&&e.deactivate(t,i),r.external.cornerstone.updateImage(t)}function p(){return C}function T(e){C=e}var C={},w={enable:f,disable:l,activate:g,deactivate:h,getConfiguration:p,setConfiguration:T,mouseDownCallback:a,mouseMoveCallback:o,mouseDownActivateCallback:n};return e.pointNearTool&&(w.pointNearTool=e.pointNearTool),e.mouseDoubleClickCallback&&(w.mouseDoubleClickCallback=e.mouseDoubleClickCallback),e.addNewMeasurement&&(w.addNewMeasurement=e.addNewMeasurement),w};var r=n(0),a=n(35),i=o(a),l=n(18),u=o(l),s=n(36),c=o(s),f=n(21),d=o(f),g=n(22),v=o(g),h=n(37),m=o(h),p=n(12),x=o(p),T=n(2),y=o(T),b=n(1),C=n(3),M=o(C)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,l){e.strokeStyle=r,Object.keys(n).forEach(function(r){var u=n[r];if(!0!==u.drawnIndependently&&(!l||!0!==l.drawHandlesIfActive||u.active)){e.beginPath(),u.active?e.lineWidth=a.default.getActiveWidth():e.lineWidth=a.default.getToolWidth();var s=o.external.cornerstone.pixelToCanvas(t.element,u);e.arc(s.x,s.y,i,0,2*Math.PI),l&&l.fill&&(e.fillStyle=l.fill,e.fill()),e.stroke()}})};var o=n(0),r=n(5),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=6},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){Object.keys(e).forEach(function(t){e[t].active=!1})}function a(e){if(e)for(var t=0;t<e.data.length;t++){var n=e.data[t];n.active=!1,n.handles&&r(n.handles)}}function i(e){function t(t){var a=l.external.cornerstone,i=t.element,u=e.createNewMeasurement(t);if(u){if((0,x.addToolState)(i,e.toolType,u),1===Object.keys(u.handles).length&&"CornerstoneToolsTap"===t.type)return u.active=!1,u.handles.end.active=!1,u.handles.end.highlight=!1,u.invalidated=!0,(0,s.default)(t,u.handles)&&(0,x.removeToolState)(i,e.toolType,u),void a.updateImage(i);l.external.$(i).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),l.external.$(i).off("CornerstoneToolsTap",e.tapCallback||o),l.external.$(i).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),a.updateImage(i),(0,h.default)(t,e.toolType,u,u.handles.end,function(){u.active=!1,u.invalidated=!0,(0,s.default)(t,u.handles)&&(0,x.removeToolState)(i,e.toolType,u),l.external.$(i).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),l.external.$(i).on("CornerstoneToolsTap",e.tapCallback||o),l.external.$(i).on("CornerstoneToolsTouchStart",e.touchStartCallback||r),a.updateImage(i)})}}function n(n,o){e.addNewMeasurement?e.addNewMeasurement(o):t(o),n.stopImmediatePropagation(),n.preventDefault()}function o(t,i){function u(){a(h),(0,s.default)(i,m.handles)&&(0,x.removeToolState)(d,e.toolType,m),c.updateImage(d),l.external.$(d).on("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(d).on("CornerstoneToolsTap",e.tapCallback||o)}var c=l.external.cornerstone,d=i.element,v=i.currentPoints.canvas,h=(0,x.getToolState)(t.currentTarget,e.toolType),m=void 0,T=void 0;if(a(h),h)for(T=0;T<h.data.length;T++){m=h.data[T];var y=(0,f.default)(d,m.handles,v,25);if(y)return l.external.$(d).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(d).off("CornerstoneToolsTap",e.tapCallback||o),m.active=!0,y.active=!0,c.updateImage(d),(0,g.default)(t,e.toolType,m,y,u),t.stopImmediatePropagation(),void t.preventDefault()}if(h&&e.pointNearTool)for(T=0;T<h.data.length;T++)if(m=h.data[T],e.pointNearTool(d,m,v))return l.external.$(d).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(d).off("CornerstoneToolsTap",e.tapCallback||o),m.active=!0,c.updateImage(d),(0,p.default)(t,m,h,e.toolType,!0,u),t.stopImmediatePropagation(),void t.preventDefault();return e.touchDownActivateCallback?e.touchDownActivateCallback(t,i):n(t,i),!1}function r(t,n){function a(t,a){d.active=!1,d.invalidated=!0,(0,s.default)(n,d.handles)&&(0,x.removeToolState)(n.element,e.toolType,d),i.updateImage(n.element),l.external.$(u).on("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(u).on("CornerstoneToolsTap",e.tapCallback||o),e.pressCallback&&l.external.$(u).on("CornerstoneToolsTouchPress",e.pressCallback),t&&"CornerstoneToolsTouchPress"===t.type&&(0,y.default)(u,t.type,a)}var i=l.external.cornerstone,u=n.element,c=n.startPoints.canvas,d=void 0,v=(0,x.getToolState)(t.currentTarget,e.toolType),h=void 0;if(v){for(h=0;h<v.data.length;h++){d=v.data[h];var m=(0,f.default)(n.element,d.handles,c,28);if(m)return l.external.$(u).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(u).off("CornerstoneToolsTap",e.tapCallback||o),e.pressCallback&&l.external.$(u).off("CornerstoneToolsTouchPress",e.pressCallback),d.active=!0,(0,g.default)(t,e.toolType,d,m,a),t.stopImmediatePropagation(),void t.preventDefault()}if(e.pointNearTool)for(h=0;h<v.data.length;h++)if(d=v.data[h],e.pointNearTool(n.element,d,c))return l.external.$(u).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(u).off("CornerstoneToolsTap",e.tapCallback||o),e.pressCallback&&l.external.$(u).off("CornerstoneToolsTouchPress",e.pressCallback),(0,p.default)(t,d,v,e.toolType,!0,a),t.stopImmediatePropagation(),void t.preventDefault()}}function i(t){t.removeEventListener("cornerstoneimagerendered",d),l.external.$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),l.external.$(t).off("CornerstoneToolsTap",e.tapCallback||o),e.doubleTapCallback&&l.external.$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&l.external.$(t).off("CornerstoneToolsTouchPress",e.pressCallback),l.external.cornerstone.updateImage(t)}function u(t){t.removeEventListener("cornerstoneimagerendered",d),l.external.$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),l.external.$(t).off("CornerstoneToolsTap",e.tapCallback||o),t.addEventListener("cornerstoneimagerendered",d),e.doubleTapCallback&&l.external.$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&l.external.$(t).off("CornerstoneToolsTouchPress",e.pressCallback),l.external.cornerstone.updateImage(t)}function c(t){t.removeEventListener("cornerstoneimagerendered",d),l.external.$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),l.external.$(t).off("CornerstoneToolsTap",e.tapCallback||o),t.addEventListener("cornerstoneimagerendered",d),l.external.$(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(t).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),l.external.$(t).on("CornerstoneToolsTap",e.tapCallback||o),e.doubleTapCallback&&(l.external.$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),l.external.$(t).on("CornerstoneToolsDoubleTap",e.doubleTapCallback)),e.pressCallback&&(l.external.$(t).off("CornerstoneToolsTouchPress",e.pressCallback),l.external.$(t).on("CornerstoneToolsTouchPress",e.pressCallback)),l.external.cornerstone.updateImage(t)}function d(t){e.onImageRendered(t,t.detail)}function v(t){var a="CornerstoneToolsToolDeactivated",i={toolType:e.toolType,type:a};(0,y.default)(t,a,i),t.removeEventListener("cornerstoneimagerendered",d),l.external.$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||r),l.external.$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),l.external.$(t).off("CornerstoneToolsTap",e.tapCallback||o),t.addEventListener("cornerstoneimagerendered",d),l.external.$(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||r),e.doubleTapCallback&&l.external.$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&l.external.$(t).off("CornerstoneToolsTouchPress",e.pressCallback),l.external.cornerstone.updateImage(t)}var m={enable:u,disable:i,activate:c,deactivate:v,touchStartCallback:e.touchStartCallback||r,touchDownActivateCallback:e.touchDownActivateCallback||n,tapCallback:e.tapCallback||o};return e.pointNearTool&&(m.pointNearTool=e.pointNearTool),e.doubleTapCallback&&(m.doubleTapCallback=e.doubleTapCallback),e.pressCallback&&(m.pressCallback=e.pressCallback),e.addNewMeasurement&&(m.addNewMeasurement=e.addNewMeasurement),m}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),u=n(12),s=o(u),c=n(18),f=o(c),d=n(52),g=o(d),v=n(24),h=o(v),m=n(51),p=o(m),x=n(1),T=n(3),y=o(T);t.default=i},function(e,t,n){"use strict";function o(e){s=e}function r(){return s}function a(e){c=e}function i(){return c}function l(e){f=e}function u(){return f}Object.defineProperty(t,"__esModule",{value:!0});var s=void 0,c=void 0,f=void 0,d={setStartLoadHandler:o,getStartLoadHandler:r,setEndLoadHandler:a,getEndLoadHandler:i,setErrorLoadingHandler:l,getErrorLoadingHandler:u};t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n="CornerstoneToolsTouchDrag";return t&&!0===t.fireOnTouchStart&&(n+=" CornerstoneToolsTouchStart"),{activate:function(r){o.external.$(r).off(n,e),t&&t.eventData?o.external.$(r).on(n,t.eventData,e):o.external.$(r).on(n,e),t&&t.activateCallback&&t.activateCallback(r)},disable:function(r){o.external.$(r).off(n,e),t&&t.disableCallback&&t.disableCallback(r)},enable:function(r){o.external.$(r).off(n,e),t&&t.enableCallback&&t.enableCallback(r)},deactivate:function(r){o.external.$(r).off(n,e),t&&t.deactivateCallback&&t.deactivateCallback(r)}}};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.image,r={left:0,top:0,width:n.width,height:n.height},a=!1;return Object.keys(t).forEach(function(e){var n=t[e];!0!==n.allowedOutsideImage&&!1===o.cornerstoneMath.point.insideRect(n,r)&&(a=!0)}),a};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t,n,r){o.external.$(t).off("CornerstoneToolsMouseDownActivate",e);var a={mouseButtonMask:n,options:r};o.external.$(t).on("CornerstoneToolsMouseDownActivate",a,e)},disable:function(t){o.external.$(t).off("CornerstoneToolsMouseDownActivate",e)},enable:function(t){o.external.$(t).off("CornerstoneToolsMouseDownActivate",e)},deactivate:function(t){o.external.$(t).off("CornerstoneToolsMouseDownActivate",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var o=n(0)},function(e,t,n){"use strict";function o(e){c=e}function r(){return c}function a(e){s=e}function i(){return s}function l(e){f=e}function u(){return f}Object.defineProperty(t,"__esModule",{value:!0});var s=15,c=s+"px Arial",f="transparent",d={setFont:o,getFont:r,setFontSize:a,getFontSize:i,setBackgroundColor:l,getBackgroundColor:u};t.default=d},function(e,t,n){"use strict";function o(){function e(e){return u[e]}function t(e,t){u[e]=t}function n(){return u}function o(e){u=e}function a(e,t,n){var o=r.external.cornerstone.getEnabledElement(e);o.image&&!1!==u.hasOwnProperty(o.image.imageId)||(u[o.image.imageId]={});var a=u[o.image.imageId];!1===a.hasOwnProperty(t)&&(a[t]={data:[]}),a[t].data.push(n)}function i(e,t){var n=r.external.cornerstone.getEnabledElement(e);if(n.image&&!1!==u.hasOwnProperty(n.image.imageId)){var o=u[n.image.imageId];if(!1!==o.hasOwnProperty(t)){return o[t]}}}function l(e){var t=r.external.cornerstone.getEnabledElement(e);t.image&&!1!==u.hasOwnProperty(t.image.imageId)&&delete u[t.image.imageId]}var u={};return{get:i,add:a,clear:l,saveImageIdToolState:e,restoreImageIdToolState:t,saveToolState:n,restoreToolState:o,toolState:u}}Object.defineProperty(t,"__esModule",{value:!0}),t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=void 0;var r=n(0),a=o();t.newImageIdSpecificToolStateManager=o,t.globalImageIdSpecificToolStateManager=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.boundingBox)return o.cornerstoneMath.point.insideRect(t,e.boundingBox)};var o=n(0)},function(e,t,n){"use strict";function o(e){return parseFloat("."+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=r.external.cornerstone,a=n.metaData.get("patientStudyModule",e.imageId),i=n.metaData.get("generalSeriesModule",e.imageId);if(a&&i){if("PT"===i.modality){var l=t*e.slope+e.intercept,u=a.patientWeight;if(u){var s=n.metaData.get("petIsotopeModule",e.imageId);if(s){var c=s.radiopharmaceuticalInfo,f=c.radiopharmaceuticalStartTime,d=c.radionuclideTotalDose,g=c.radionuclideHalfLife,v=i.seriesTime;if(f&&d&&g&&v){var h=o(v.fractionalSeconds||0)+v.seconds+60*v.minutes+60*v.hours*60,m=o(f.fractionalSeconds)+f.seconds+60*f.minutes+60*f.hours*60,p=h-m;return l*u/(d*Math.exp(-p*Math.log(2)/g))*1e3}}}}}};var r=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){var i=void 0;if(t)return Object.keys(t).forEach(function(l){var u=t[l];if(u.hasOwnProperty("pointNearHandle")){if(u.pointNearHandle(e,u,n))return void(i=u)}else if(!0===u.hasBoundingBox){if((0,a.default)(u,n))return void(i=u)}else{var s=o.external.cornerstone.pixelToCanvas(e,u),c=o.cornerstoneMath.point.distance(s,n);if(c<=r)return void(i=u)}}),i};var o=n(0),r=n(16),a=function(e){return e&&e.__esModule?e:{default:e}}(r)},function(e,t,n){"use strict";function o(){var e=navigator.userAgent,t=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],n=void 0;return/trident/i.test(t[1])?(n=/\brv[ :]+(\d+)/g.exec(e)||[],"IE "+(n[1]||"")):"Chrome"===t[1]&&null!==(n=e.match(/\b(OPR|Edge)\/(\d+)/))?n.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(n=e.match(/version\/(\d+)/i))&&t.splice(1,1,n[1]),t.join(" "))}function r(e){u=e}function a(){return u||i()}function i(){var e=o(),t=e.split(" "),n=t[0],r=t[1],a=s[n];return a?a[r]?a[r]:a.default:s.default}function l(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}Object.defineProperty(t,"__esModule",{value:!0});var u=void 0,s={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};t.getDefaultSimultaneousRequests=i,t.getMaxSimultaneousRequests=a,t.setMaxSimultaneousRequests=r,t.getBrowserInfo=o,t.isMobileDevice=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){o.external.$(t).off("CornerstoneToolsMouseWheel",e);var n={};o.external.$(t).on("CornerstoneToolsMouseWheel",n,e)},disable:function(t){o.external.$(t).off("CornerstoneToolsMouseWheel",e)},enable:function(t){o.external.$(t).off("CornerstoneToolsMouseWheel",e)},deactivate:function(t){o.external.$(t).off("CornerstoneToolsMouseWheel",e)}}};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i,l){function u(e,o){!1===r.hasMoved&&(r.hasMoved=!0),r.active=!0,r.x=o.currentPoints.image.x+d.x,r.y=o.currentPoints.image.y+d.y,l&&(r.x=Math.max(r.x,0),r.x=Math.min(r.x,o.image.width),r.y=Math.max(r.y,0),r.y=Math.min(r.y,o.image.height)),c.updateImage(f);var i={toolType:t,element:f,measurementData:n};(0,a.default)(f,"CornerstoneToolsMeasurementModified",i)}function s(){r.active=!1,o.external.$(f).off("CornerstoneToolsMouseDrag",u),o.external.$(f).off("CornerstoneToolsMouseUp",s),o.external.$(f).off("CornerstoneToolsMouseClick",s),c.updateImage(f),"function"==typeof i&&i()}var c=o.external.cornerstone,f=e.element,d={x:r.x-e.currentPoints.image.x,y:r.y-e.currentPoints.image.y};o.external.$(f).on("CornerstoneToolsMouseDrag",u),o.external.$(f).on("CornerstoneToolsMouseUp",s),o.external.$(f).on("CornerstoneToolsMouseClick",s)};var o=n(0),r=n(3),a=function(e){return e&&e.__esModule?e:{default:e}}(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i,l){function u(e,o){r.active=!0,r.x=o.currentPoints.image.x,r.y=o.currentPoints.image.y,l&&(r.x=Math.max(r.x,0),r.x=Math.min(r.x,o.image.width),r.y=Math.max(r.y,0),r.y=Math.min(r.y,o.image.height)),g.updateImage(v);var i={toolType:t,element:v,measurementData:n};(0,a.default)(v,"CornerstoneToolsMeasurementModified",i)}function s(e){o.external.$(v).off("CornerstoneToolsMouseMove",s),o.external.$(v).off("CornerstoneToolsMouseDrag",s),o.external.$(v).on("CornerstoneToolsMouseMove",u),o.external.$(v).on("CornerstoneToolsMouseDrag",u),o.external.$(v).on("CornerstoneToolsMouseClick",d),"CornerstoneToolsMouseDrag"===e.type&&o.external.$(v).on("CornerstoneToolsMouseUp",d)}function c(e,t){t.measurementData===n&&d()}function f(e,n){n.toolType===t&&(o.external.$(v).off("CornerstoneToolsMouseMove",u),o.external.$(v).off("CornerstoneToolsMouseDrag",u),o.external.$(v).off("CornerstoneToolsMouseClick",d),o.external.$(v).off("CornerstoneToolsMouseUp",d),o.external.$(v).off("CornerstoneToolsMeasurementRemoved",c),o.external.$(v).off("CornerstoneToolsToolDeactivated",f),r.active=!1,g.updateImage(v))}function d(){o.external.$(v).off("CornerstoneToolsMouseMove",u),o.external.$(v).off("CornerstoneToolsMouseDrag",u),o.external.$(v).off("CornerstoneToolsMouseClick",d),o.external.$(v).off("CornerstoneToolsMouseUp",d),o.external.$(v).off("CornerstoneToolsMeasurementRemoved",c),o.external.$(v).off("CornerstoneToolsToolDeactivated",f),r.active=!1,g.updateImage(v),"function"==typeof i&&i()}var g=o.external.cornerstone,v=e.element;o.external.$(v).on("CornerstoneToolsMouseDrag",s),o.external.$(v).on("CornerstoneToolsMouseMove",s),o.external.$(v).on("CornerstoneToolsMeasurementRemoved",c),o.external.$(v).on("CornerstoneToolsToolDeactivated",f)};var o=n(0),r=n(3),a=function(e){return e&&e.__esModule?e:{default:e}}(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){e(t,t.detail)}var n={};return{disable:function(e){e.removeEventListener("cornerstoneimagerendered",t)},enable:function(e){e.removeEventListener("cornerstoneimagerendered",t),e.addEventListener("cornerstoneimagerendered",t),o.external.cornerstone.updateImage(e)},getConfiguration:function(){return n},setConfiguration:function(e){n=e}}};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i,l){function u(e,o){r.x=o.currentPoints.image.x+h.x,r.y=o.currentPoints.image.y+h.y,l&&(r.x=Math.max(r.x,0),r.x=Math.min(r.x,o.image.width),r.y=Math.max(r.y,0),r.y=Math.min(r.y,o.image.height)),d.updateImage(g);var i={toolType:t,element:g,measurementData:n};(0,a.default)(g,"CornerstoneToolsMeasurementModified",i)}function s(e,t){if(o.external.$(g).off("CornerstoneToolsTouchDrag",u),o.external.$(g).off("CornerstoneToolsTouchPinch",s),o.external.$(g).off("CornerstoneToolsTouchEnd",s),o.external.$(g).off("CornerstoneToolsTap",s),o.external.$(g).off("CornerstoneToolsTouchStart",c),o.external.$(g).off("CornerstoneToolsToolDeactivated",f),"CornerstoneToolsTouchPinch"===e.type||"CornerstoneToolsTouchPress"===e.type)return r.active=!1,d.updateImage(g),void i();r.active=!1,n.active=!1,r.x=t.currentPoints.image.x+h.x,r.y=t.currentPoints.image.y+h.y,l&&(r.x=Math.max(r.x,0),r.x=Math.min(r.x,t.image.width),r.y=Math.max(r.y,0),r.y=Math.min(r.y,t.image.height)),d.updateImage(g),"function"==typeof i&&i()}function c(e){return e.stopImmediatePropagation(),!1}function f(){o.external.$(g).off("CornerstoneToolsTouchDrag",u),o.external.$(g).off("CornerstoneToolsTouchPinch",s),o.external.$(g).off("CornerstoneToolsTouchEnd",s),o.external.$(g).off("CornerstoneToolsTap",s),o.external.$(g).off("CornerstoneToolsTouchStart",c),o.external.$(g).off("CornerstoneToolsToolDeactivated",f),r.active=!1,n.active=!1,r.x=e.currentPoints.image.x+h.x,r.y=e.currentPoints.image.y+h.y,l&&(r.x=Math.max(r.x,0),r.x=Math.min(r.x,e.image.width),r.y=Math.max(r.y,0),r.y=Math.min(r.y,e.image.height)),d.updateImage(g)}var d=o.external.cornerstone,g=e.element,v=d.pageToPixel(g,e.currentPoints.page.x,e.currentPoints.page.y+50),h={x:r.x-v.x,y:r.y-v.y};r.active=!0,n.active=!0,o.external.$(g).on("CornerstoneToolsTouchDrag",u),o.external.$(g).on("CornerstoneToolsTouchPinch",s),o.external.$(g).on("CornerstoneToolsTouchEnd",s),o.external.$(g).on("CornerstoneToolsTap",s),o.external.$(g).on("CornerstoneToolsTouchStart",c),o.external.$(g).on("CornerstoneToolsToolDeactivated",f)};var o=n(0),r=n(3),a=function(e){return e&&e.__esModule?e:{default:e}}(r)},function(e,t,n){"use strict";function o(){return v}function r(e,t){var n=void 0,o=void 0,r=e.imageIds,a=r.length;return d.external.cornerstone.loadImage(r[0]).then(function(e){n=e.width,o=e.height;var i=n*o*a*h,l=new ArrayBuffer(i),u=new Uint8Array(l),s=r.map(function(e,t){return d.external.cornerstone.loadImage(e).then(function(e){var r=e.slope,a=e.intercept,i=e.getPixelData(),l=n*o;console.log("pixelData: ",i.length),console.log("n: ",l);for(var s=0;s<l;s++){var c=i[s],f=c*r+a,d=f>=m.calciumThresholdHu?1:0;u[t*l+s]=d}})});return Promise.all(s).then(function(){var e={buffer:l,width:n,height:o};return t&&t(e),e})})}function a(e){var t=e.detail,n=t.element,o=(0,g.getToolState)(n,"stack"),r=(0,g.getToolState)(n,"regions");if(r&&r.data&&r.data.length){var a=o.data[0].currentImageIdIndex,i=r.data[0].buffer,l=t.canvasContext,u=t.enabledElement,s=t.image,c=s.width,f=s.height,v=document.createElement("canvas"),h=v.getContext("2d");v.width=c,v.height=f,p=p||h.createImageData(c,f);for(var x=p.data,T=c*f,y=a*T,b=new Uint8Array(i,y,T),C=0;C<b.length;C+=1){var M=b[C],w=4*C;if(M){var P=m.regionColorsRGB[M-1];x[w+0]=P[0],x[w+1]=P[1],x[w+2]=P[2],x[w+3]=255*m.drawAlpha}else x[w+3]=0}h.putImageData(p,0,0),d.external.cornerstone.setToPixelCoordinateSystem(u,l),l.drawImage(v,0,0)}}function i(e,t){var n=(0,g.getToolState)(e,"regions");if(p=null,!n.data[0]||!n.data[0].enabled){v=e;var o=(0,g.getToolState)(e,"stack");if(o&&o.data&&o.data.length){var i={enabled:1,buffer:null,width:null,height:null,history:[]};(0,g.addToolState)(e,"regions",i);var l=o.data[0];setTimeout(function(){r(l,function(n){var o=(0,g.getToolState)(e,"regions");o.data[0].buffer=n.buffer,o.data[0].width=n.width,o.data[0].height=n.height,e.addEventListener("cornerstoneimagerendered",a),d.external.cornerstone.updateImage(e),"function"==typeof t&&t()})},100)}}}function l(e){var t=(0,g.getToolState)(e,"regions");t&&t.data.length&&(t.data[0].enabled=!1)}function u(e){var t=e||v;return new Promise(function(e,n){l(t),i(t,function(){e()})})}function s(e){var t=(0,g.getToolState)(e,"regions"),n=t.data[0],o=n.buffer.slice();n.history.push(o),n.history.length>m.historySize&&n.history.shift()}function c(){return m}function f(e){m=e}Object.defineProperty(t,"__esModule",{value:!0}),t.getLastElement=o,t.update=u,t.createUndoStep=s,t.getConfiguration=c,t.setConfiguration=f;var d=n(0),g=n(1),v=null,h=1,m={historySize:4,historyPosition:0,toolRegionValue:2,calciumThresholdHu:"-",layersAbove:0,layersBelow:0,drawAlpha:1,regionColorsRGB:[[255,0,255],[246,193,91],[237,148,69],[230,103,49],[184,74,41],[106,58,45]],KVPToMultiplier:{150:1.06,140:1.04,130:1.02,120:1,110:.98,100:.96,90:.93,80:.89,70:.85},growIterationsPerChunk:2};m.calciumThresholdHuParsed=parseInt(m.calciumThresholdHu);var p=null;t.default={activate:i,deactivate:l,update:u,enable:i,disable:l,getConfiguration:c,setConfiguration:f}},function(e,t,n){"use strict";function o(e,t){var n=e.clone().sub(t.imagePositionPatient);return{x:t.rowCosines.dot(n)/t.columnPixelSpacing,y:t.columnCosines.dot(n)/t.rowPixelSpacing}}function r(e,t){var n=t.rowCosines.clone().multiplyScalar(e.x);n.multiplyScalar(t.columnPixelSpacing);var o=t.columnCosines.clone().multiplyScalar(e.y);o.multiplyScalar(t.rowPixelSpacing);var r=n.add(o);return r.add(t.imagePositionPatient),r}function a(e){var t=r({x:0,y:0},e),n=r({x:e.columns,y:0},e),o=r({x:0,y:e.rows},e),a=r({x:e.columns,y:e.rows},e);return{top:new u.cornerstoneMath.Line3(t,n),left:new u.cornerstoneMath.Line3(t,o),right:new u.cornerstoneMath.Line3(n,a),bottom:new u.cornerstoneMath.Line3(o,a)}}function i(e,t){var n=[];return Object.keys(t).forEach(function(o){var r=t[o],a=e.intersectLine(r);a&&n.push(a)}),n}function l(e,t){var n=e.rowCosines.clone().cross(e.columnCosines),o=new u.cornerstoneMath.Plane;o.setFromNormalAndCoplanarPoint(n,e.imagePositionPatient);var l=t.rowCosines.clone().cross(t.columnCosines),s=new u.cornerstoneMath.Plane;s.setFromNormalAndCoplanarPoint(l,t.imagePositionPatient);var c=s.clone().intersectPlane(o),f=c.origin,d=c.direction,g=r({x:t.columns,y:t.rows},t),v=t.imagePositionPatient.distanceTo(g),h=new u.cornerstoneMath.Line3;h.start=f,h.end=f.clone().add(d.multiplyScalar(v));var m=a(t),p=i(h,m);if(2===p.length)return{start:p[0],end:p[1]}}Object.defineProperty(t,"__esModule",{value:!0}),t.projectPatientPointToImagePlane=o,t.imagePointToPatientPoint=r,t.planePlaneIntersection=l;var u=n(0)},function(e,t,n){"use strict";function o(e,t,n,o,r,a){if(!d.hasOwnProperty(n))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var i={type:n,imageId:t,preventCache:o,doneCallback:r,failCallback:a},l=c.external.cornerstone.imageCache.getImagePromise(t);if(l)return void l.then(function(e){r(e)},function(e){a(e)});d[n].push(i)}}function r(e){if(!d.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");d[e]=[]}function a(){h&&setTimeout(function(){l()},m)}function i(e){var t=c.external.cornerstone,n=e.type;g[n]++,h=!0;var o=e.imageId,r=e.doneCallback,i=e.failCallback,l=t.imageCache.getImagePromise(o);if(l)return void l.then(function(e){g[n]--,r(e),a()},function(e){g[n]--,i(e),a()});var u=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e),s=void 0;s=!0===e.preventCache?t.loadImage(o,{priority:u,type:e.type}):t.loadAndCacheImage(o,{priority:u,type:e.type}),s.then(function(e){g[n]--,r(e),a()},function(e){g[n]--,i(e),a()})}function l(){var e=(0,f.getMaxSimultaneousRequests)();v={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=g.interaction+g.thumbnail+g.prefetch,n=e-t,o=0;o<n;o++){var r=u();r&&i(r)}}function u(){return d.interaction.length&&g.interaction<v.interaction?d.interaction.shift():d.thumbnail.length&&g.thumbnail<v.thumbnail?d.thumbnail.shift():d.prefetch.length&&g.prefetch<v.prefetch?d.prefetch.shift():(d.interaction.length||d.thumbnail.length||d.prefetch.length||(h=!1),!1)}function s(){return d}Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),f=n(19),d={interaction:[],thumbnail:[],prefetch:[]},g={interaction:0,thumbnail:0,prefetch:0},v={interaction:6,thumbnail:6,prefetch:5},h=!1,m=20;t.default={addRequest:o,clearRequestStack:r,startGrabbing:l,getRequestPool:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n={},r="CornerstoneToolsMultiTouchDrag";return t&&!0===t.fireOnTouchStart&&(r+=" CornerstoneToolsMultiTouchStart"),{activate:function(n){o.external.$(n).off(r,e),t&&t.eventData?o.external.$(n).on(r,t.eventData,e):o.external.$(n).on(r,e),t&&t.activateCallback&&t.activateCallback(n)},disable:function(n){o.external.$(n).off(r,e),t&&t.disableCallback&&t.disableCallback(n)},enable:function(n){o.external.$(n).off(r,e),t&&t.enableCallback&&t.enableCallback(n)},deactivate:function(n){o.external.$(n).off(r,e),t&&t.deactivateCallback&&t.deactivateCallback(n)},getConfiguration:function(){return n},setConfiguration:function(e){n=e}}};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,a.getToolState)(e,"stack");if(o&&o.data&&o.data.length){var i=o.data[0],l=i.currentImageIdIndex+t;if(n){l%=i.imageIds.length}else l=Math.min(i.imageIds.length-1,l),l=Math.max(0,l);(0,r.default)(e,l)}};var o=n(43),r=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.width/2,o=e.height/2;if(n<=0||o<=0)return!1;var r={x:e.left+n,y:e.top+o},a={x:t.x-r.x,y:t.y-r.y};return a.x*a.x/(n*n)+a.y*a.y/(o*o)<=1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,a){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i=o.external.cornerstone.getEnabledElement(e),l=[],u=0,s=i.image.getPixelData(),c=void 0,f=void 0,d=void 0;if(i.image.color)for(f=0;f<a;f++)for(d=0;d<r;d++){c=4*((f+n)*i.image.columns+(d+t));var g=s[c],v=s[c+1],h=s[c+2],m=s[c+3];l[u++]=g,l[u++]=v,l[u++]=h,l[u++]=m}return l};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{page:o.cornerstoneMath.point.copy(e.page),image:o.cornerstoneMath.point.copy(e.image),client:o.cornerstoneMath.point.copy(e.client),canvas:o.cornerstoneMath.point.copy(e.canvas)}};var o=n(0)},function(e,t,n){"use strict";function o(e){a=e.currentPoints.canvas}function r(){return a}Object.defineProperty(t,"__esModule",{value:!0});var a=void 0,i={setCoords:o,getCoords:r};t.default=i},function(e,t,n){"use strict";function o(e){var t=void 0;return Object.keys(e).forEach(function(n){var o=e[n];if(!0===o.active)return void(t=o)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){r||(r=6);var i=o(t),l=(0,a.default)(e,t,n,r);return i!==l&&(void 0!==l&&(l.active=!0),void 0!==i&&(i.active=!1),!0)};var r=n(18),a=function(e){return e&&e.__esModule?e:{default:e}}(r)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a,u){function c(e,n){t.active=!0,Object.keys(t.handles).forEach(function(e){var o=t.handles[e];!0!==o.movesIndependently&&(o.x+=n.deltaPoints.image.x,o.y+=n.deltaPoints.image.y,!0===a.preventHandleOutsideImage&&(o.x=Math.max(o.x,0),o.x=Math.min(o.x,n.image.width),o.y=Math.max(o.y,0),o.y=Math.min(o.y,n.image.height)))}),d.updateImage(g);var r={toolType:o,element:g,measurementData:t};return(0,s.default)(g,"CornerstoneToolsMeasurementModified",r),!1}function f(e,n){t.invalidated=!0,r.external.$(g).off("CornerstoneToolsMouseDrag",c),r.external.$(g).off("CornerstoneToolsMouseUp",f),r.external.$(g).off("CornerstoneToolsMouseClick",f),!0===a.deleteIfHandleOutsideImage&&(0,i.default)(n,t.handles)&&(0,l.removeToolState)(g,o,t),d.updateImage(g),"function"==typeof u&&u()}var d=r.external.cornerstone,g=e.element;return r.external.$(g).on("CornerstoneToolsMouseDrag",c),r.external.$(g).on("CornerstoneToolsMouseUp",f),r.external.$(g).on("CornerstoneToolsMouseClick",f),!0};var r=n(0),a=n(12),i=o(a),l=n(1),u=n(3),s=o(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var a=(0,r.getToolState)(e,"timeSeries");if(a&&a.data&&a.data.length){var l=o.external.cornerstone,u=a.data[0],s=u.stacks[u.currentStackIndex],c=s.currentImageIdIndex,f=u.currentStackIndex+t;if(n?(f>=u.stacks.length&&(f=0),f<0&&(f=u.stacks.length-1)):(f=Math.min(u.stacks.length-1,f),f=Math.max(0,f)),f!==u.currentStackIndex){var d=l.getViewport(e),g=u.stacks[f],v=i.default.getStartLoadHandler(),h=i.default.getEndLoadHandler(),m=i.default.getErrorLoadingHandler();v&&v(e);var p=void 0;p=!0===g.preventCache?l.loadImage(g.imageIds[c]):l.loadAndCacheImage(g.imageIds[c]),p.then(function(t){u.currentImageIdIndex!==c&&(g.currentImageIdIndex=c,u.currentStackIndex=f,l.displayImage(e,t,d),h&&h(e,t))},function(t){var n=g.imageIds[c];m&&m(e,n,t)})}}};var o=n(0),r=n(1),a=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,o.planePlaneIntersection)(e,t);if(n)return{start:(0,o.projectPatientPointToImagePlane)(n.start,e),end:(0,o.projectPatientPointToImagePlane)(n.end,e)}};var o=n(26)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){var a=r.external.cornerstone,l=a.getEnabledElement(n).image,s=a.getEnabledElement(o).image;if(l&&s){var f=a.metaData.get("imagePlaneModule",l.imageId),d=a.metaData.get("imagePlaneModule",s.imageId);if(f&&d&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&d.rowCosines&&d.columnCosines&&d.imagePositionPatient&&f.frameOfReferenceUID===d.frameOfReferenceUID){var g=f.rowCosines.clone().cross(f.columnCosines),v=d.rowCosines.clone().cross(d.columnCosines),h=g.angleTo(v);if(!((h=Math.abs(h))<.5)){var m=(0,i.default)(f,d);if(m){var p=a.pixelToCanvas(t.element,m.start),x=a.pixelToCanvas(t.element,m.end),T=u.default.getActiveColor(),y=c.default.getToolWidth();e.setTransform(1,0,0,1,0,0),e.save(),e.beginPath(),e.strokeStyle=T,e.lineWidth=y,e.moveTo(p.x,p.y),e.lineTo(x.x,x.y),e.stroke(),e.restore()}}}}};var r=n(0),a=n(39),i=o(a),l=n(4),u=o(l),s=n(5),c=o(s)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(64),a=o(r),i=n(65),l=o(i),u={getOrientationString:a.default,invertOrientationString:l.default};t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return o.external.cornerstone.setToPixelCoordinateSystem(e,t,.1),{fontSize:n/e.viewport.scale/.1,lineHeight:n/e.viewport.scale/.1,fontScale:.1}};var o=n(0)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(n){if(v.currentImageIdIndex===t){try{u.getEnabledElement(e)}catch(e){return}f?(f.currentImageIdIndex=t,f.render(e,i.data)):u.displayImage(e,n),m&&m(e,n)}}function o(n){var o=v.imageIds[t];p&&p(e,o,n)}var i=(0,a.getToolState)(e,"stack");if(i&&i.data&&i.data.length){var u=r.external.cornerstone,f=void 0;if(i.data.length>1){var g=(0,a.getToolState)(e,"stackRenderer");g&&g.data&&g.data.length&&(f=g.data[0])}var v=i.data[0];t<0&&(t+=v.imageIds.length);var h=s.default.getStartLoadHandler(),m=s.default.getEndLoadHandler(),p=s.default.getErrorLoadingHandler();if(t!==v.currentImageIdIndex){h&&h(e);var x={newImageIdIndex:t,direction:t-v.currentImageIdIndex};v.currentImageIdIndex=t;var T=v.imageIds[t],y=c.stackScroll.getConfiguration();if(y&&!0===y.retryLoadOnScroll){var b=u.imageCache.getImagePromise(T);b&&"rejected"===b.state()&&u.imageCache.removeImagePromise(T)}var C=Boolean(v.preventCache),M=void 0;M=C?u.loadImage(T):u.loadAndCacheImage(T),M.then(n,o),l.default.startGrabbing(),(0,d.default)(e,"CornerstoneStackScroll",x)}}};var r=n(0),a=n(1),i=n(27),l=o(i),u=n(10),s=o(u),c=n(44),f=n(3),d=o(f)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){s.external.$(t.element).off("CornerstoneToolsMouseDrag",l),s.external.$(t.element).off("CornerstoneToolsMouseUp",r),s.external.$(t.element).off("CornerstoneToolsMouseClick",r)}function a(e,t){if((0,T.default)(t.which,e.data.mouseButtonMask)){var n={deltaY:0};return s.external.$(t.element).on("CornerstoneToolsMouseDrag",n,l),s.external.$(t.element).on("CornerstoneToolsMouseUp",r),s.external.$(t.element).on("CornerstoneToolsMouseClick",r),e.stopImmediatePropagation(),!1}}function i(e,t){var n=-t.direction,o=M.getConfiguration(),r=!1;o&&o.loop&&(r=o.loop),(0,b.default)(t.element,n,r)}function l(e,t){var n=t.element,o=(0,C.getToolState)(n,"stack");if(o&&o.data&&o.data.length){var r=o.data[0],a=M.getConfiguration(),i=Math.max(2,s.external.$(n).height()/Math.max(r.imageIds.length,8));if(a&&a.stackScrollSpeed&&(i=a.stackScrollSpeed),e.data.deltaY=e.data.deltaY||0,e.data.deltaY+=t.deltaPoints.page.y,Math.abs(e.data.deltaY)>=i){var l=e.data.deltaY/i,u=Math.round(l),c=e.data.deltaY%i;e.data.deltaY=c,(0,b.default)(n,u)}return!1}}function u(e,t){var n=I.getConfiguration();n&&n.testPointers(t)&&l(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=void 0;var s=n(0),c=n(11),f=o(c),d=n(28),g=o(d),v=n(13),h=o(v),m=n(20),p=o(m),x=n(2),T=o(x),y=n(29),b=o(y),C=n(1),M=(0,h.default)(a),w=(0,p.default)(i),P={eventData:{deltaY:0}},_=(0,f.default)(l,P),S={testPointers:function(e){return e.numPointers>=3}},I=(0,g.default)(u,P);I.setConfiguration(S),t.stackScroll=M,t.stackScrollWheel=w,t.stackScrollTouchDrag=_,t.stackScrollMultiTouch=I},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,a){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i=o.external.cornerstone.getEnabledElement(e),l=i.image,u=[],s=0,c=l.getPixelData(),f=void 0,d=void 0,g=void 0;if(l.color)for(d=0;d<a;d++)for(g=0;g<r;g++){f=4*((d+n)*l.columns+(g+t));var v=c[f],h=c[f+1],m=c[f+2];u[s++]=.2126*v+.7152*h+.0722*m}else for(d=0;d<a;d++)for(g=0;g<r;g++)f=(d+n)*l.columns+(g+t),u[s++]=c[f]*l.slope+l.intercept;return u};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,r){var a=o/2*.5522848,i=r/2*.5522848,l=t+o,u=n+r,s=t+o/2,c=n+r/2;e.beginPath(),e.moveTo(t,c),e.bezierCurveTo(t,c-i,s-a,n,s,n),e.bezierCurveTo(s+a,n,l,c-i,l,c),e.bezierCurveTo(l,c+i,s+a,u,s,u),e.bezierCurveTo(s-a,u,t,c+i,t,c),e.closePath(),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){e.beginPath(),e.strokeStyle=n,e.lineWidth=o,e.arc(t.x,t.y,6,0,2*Math.PI),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,r){var a=Math.atan2(n.y-t.y,n.x-t.x);e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.strokeStyle=o,e.lineWidth=r,e.stroke(),e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(n.x-10*Math.cos(a-Math.PI/7),n.y-10*Math.sin(a-Math.PI/7)),e.lineTo(n.x-10*Math.cos(a+Math.PI/7),n.y-10*Math.sin(a+Math.PI/7)),e.lineTo(n.x,n.y),e.lineTo(n.x-10*Math.cos(a-Math.PI/7),n.y-10*Math.sin(a-Math.PI/7)),e.strokeStyle=o,e.lineWidth=r,e.stroke(),e.fillStyle=o,e.fill()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=0,o=0,a=0,i=0,l=t.top;l<t.top+t.height;l++)for(var u=t.left;u<t.left+t.width;u++){var s={x:u,y:l};(0,r.default)(t,s)&&(n+=e[i],o+=e[i]*e[i],a++),i++}if(0===a)return{count:a,mean:0,variance:0,stdDev:0};var c=n/a,f=o/a-c*c;return{count:a,mean:c,variance:f,stdDev:Math.sqrt(f)}};var o=n(31),r=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t){o.external.$(t).off("CornerstoneToolsKeyDown",e),o.external.$(t).on("CornerstoneToolsKeyDown",e)},disable:function(t){o.external.$(t).off("CornerstoneToolsKeyDown",e)},enable:function(t){o.external.$(t).off("CornerstoneToolsKeyDown",e)},deactivate:function(t){o.external.$(t).off("CornerstoneToolsKeyDown",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var o=n(0)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a,u){function c(e,n){t.active=!0,Object.keys(t.handles).forEach(function(e){var o=t.handles[e];!0!==o.movesIndependently&&(o.x+=n.deltaPoints.image.x,o.y+=n.deltaPoints.image.y)}),g.updateImage(d);var r={toolType:o,element:d,measurementData:t};return(0,s.default)(d,"CornerstoneToolsMeasurementModified",r),!1}function f(e,n){t.active=!1,t.invalidated=!1,r.external.$(d).off("CornerstoneToolsTouchDrag",c),r.external.$(d).off("CornerstoneToolsTouchPinch",f),r.external.$(d).off("CornerstoneToolsTouchPress",f),r.external.$(d).off("CornerstoneToolsTouchEnd",f),r.external.$(d).off("CornerstoneToolsDragEnd",f),r.external.$(d).off("CornerstoneToolsTap",f),!0===a&&(0,i.default)(n,t.handles)&&(0,l.removeToolState)(d,o,t),g.updateImage(d),"function"==typeof u&&u(e,n)}var d=e.element,g=r.external.cornerstone;return r.external.$(d).on("CornerstoneToolsTouchDrag",c),r.external.$(d).on("CornerstoneToolsTouchPinch",f),r.external.$(d).on("CornerstoneToolsTouchPress",f),r.external.$(d).on("CornerstoneToolsTouchEnd",f),r.external.$(d).on("CornerstoneToolsDragEnd",f),r.external.$(d).on("CornerstoneToolsTap",f),!0};var r=n(0),a=n(12),i=o(a),l=n(1),u=n(3),s=o(u)},function(e,t,n){"use strict";function o(e,t,n,a,i){if(n.value){var l=r.external.cornerstone,u=(new Date).getTime(),s=Math.abs(t.y-i.y),c=s/10;if(console.log("distanceRemaining: "+s),s<1)return t.y=i.y,void(n.value=!1);t.y>i.y?t.y-=c:t.y<i.y&&(t.y+=c),l.updateImage(a.element),l.requestAnimationFrame(function(){o(u,t,n,a,i)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,a,s){function c(e,o){l.value=!1,!1===a.hasMoved&&(a.hasMoved=!0),a.active=!0;var r=o.currentPoints,u={x:r.page.x,y:r.page.y+m};x=d.pageToPixel(g,u.x,u.y),a.x=x.x,a.y=x.y,d.updateImage(g);var s={toolType:t,element:g,measurementData:n};(0,i.default)(g,"CornerstoneToolsMeasurementModified",s)}function f(t,o){l.value=!1,a.active=!1,r.external.$(g).off("CornerstoneToolsTouchDrag",c),r.external.$(g).off(u,f),d.updateImage(g),"CornerstoneToolsTouchPress"===t.type&&(o.handlePressed=n,a.x=e.currentPoints.image.x,a.y=e.currentPoints.image.y),"function"==typeof s&&s(t,o)}l.value=!0;var d=r.external.cornerstone,g=e.element,v=d.getEnabledElement(g),h=(new Date).getTime(),m=-57,p={x:e.currentPoints.page.x,y:e.currentPoints.page.y+m},x=d.pageToPixel(g,p.x,p.y);r.external.$(g).on("CornerstoneToolsTouchDrag",c),r.external.$(g).on(u,f),o(h,a,l,v,x)};var r=n(0),a=n(3),i=function(e){return e&&e.__esModule?e:{default:e}}(a),l={value:!1},u=["CornerstoneToolsTouchEnd","CornerstoneToolsDragEnd","CornerstoneToolsTouchPinch","CornerstoneToolsTouchPress","CornerstoneToolsTap"].join(" ")},function(e,t,n){"use strict";function o(e,t){var n=Date.now();if(e!==f){if(n-d<=s)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;f=e}d=n}function r(e,t,n){var o=n?g:v;t.forEach(function(t){u.external.$(e).on(t,o)})}function a(e,t,n){var o=n?g:v;t.forEach(function(t){u.external.$(e).off(t,o)})}function i(e){a(e,h,c.mouse),a(e,m,c.touch)}function l(e){i(e),r(e,h,c.mouse),r(e,m,c.touch)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),s=2e3,c={mouse:0,touch:1},f=void 0,d=void 0,g=o.bind(null,c.mouse),v=o.bind(null,c.touch),h=["mousedown","mouseup"],m=["touchstart","touchend"],p={enable:l,disable:i};t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){o.external.$(t).off("CornerstoneToolsDoubleTap",e);var n={};o.external.$(t).on("CornerstoneToolsDoubleTap",n,e)},disable:function(t){o.external.$(t).off("CornerstoneToolsDoubleTap",e)},enable:function(t){o.external.$(t).off("CornerstoneToolsDoubleTap",e)},deactivate:function(t){o.external.$(t).off("CornerstoneToolsDoubleTap",e)}}};var o=n(0)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(n){var o=e.createNewMeasurement(n);o&&((0,T.addToolState)(n.element,e.toolType,o),r.external.$(n.element).off("CornerstoneToolsMouseMove",a),(0,d.default)(n,e.toolType,o,o.handles.end,function(){o.active=!1,(0,m.default)(n,o.handles)&&(0,T.removeToolState)(n.element,e.toolType,o),r.external.$(n.element).on("CornerstoneToolsMouseMove",a)},t))}function o(e,t){if((0,x.default)(t.which,e.data.mouseButtonMask))return n(t),!1}function a(t,n){if(i.default.setCoords(n),0===n.which){var o=(0,T.getToolState)(n.element,e.toolType);if(void 0!==o){for(var a=!1,l=n.currentPoints.canvas,u=0;u<o.data.length;u++){var s=o.data[u];!0===(0,c.default)(n.element,s.handles,l)&&(a=!0),(e.pointInsideRect(n.element,s,l)&&!s.active||!e.pointInsideRect(n.element,s,l)&&s.active)&&(s.active=!s.active,a=!0)}!0===a&&r.external.cornerstone.updateImage(n.element)}}}function l(n,o){function i(){s.active=!1,(0,m.default)(o,s.handles)&&(0,T.removeToolState)(o.element,e.toolType,s),l.updateImage(o.element),r.external.$(o.element).on("CornerstoneToolsMouseMove",a)}var l=r.external.cornerstone,s=void 0;if((0,x.default)(o.which,n.data.mouseButtonMask)){var c=o.startPoints.canvas,f=(0,T.getToolState)(n.currentTarget,e.toolType),g=void 0;if(void 0!==f)for(g=0;g<f.data.length;g++){s=f.data[g];var h=(0,u.default)(o.element,s.handles,c,25);if(void 0!==h)return r.external.$(o.element).off("CornerstoneToolsMouseMove",a),s.active=!0,(0,d.default)(o,e.toolType,s,h,i,t),n.stopImmediatePropagation(),!1}var p={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:t};if(void 0!==f&&void 0!==e.pointInsideRect)for(g=0;g<f.data.length;g++)if(s=f.data[g],e.pointInsideRect(o.element,s,c))return r.external.$(o.element).off("CornerstoneToolsMouseMove",a),(0,v.default)(n,s,f,e.toolType,p,i),r.external.$(o.element).on("CornerstoneToolsMouseMove",a),n.stopImmediatePropagation(),!1}}function s(t){e.onImageRendered(t,t.detail)}function f(e){e.removeEventListener("cornerstoneimagerendered",s),r.external.$(e).off("CornerstoneToolsMouseMove",a),r.external.$(e).off("CornerstoneToolsMouseDown",l),r.external.$(e).off("CornerstoneToolsMouseDownActivate",o),r.external.cornerstone.updateImage(e)}function g(e){e.removeEventListener("cornerstoneimagerendered",s),r.external.$(e).off("CornerstoneToolsMouseMove",a),r.external.$(e).off("CornerstoneToolsMouseDown",l),r.external.$(e).off("CornerstoneToolsMouseDownActivate",o),e.addEventListener("cornerstoneimagerendered",s),r.external.cornerstone.updateImage(e)}function h(e,t){var n={mouseButtonMask:t};e.removeEventListener("cornerstoneimagerendered",s),r.external.$(e).off("CornerstoneToolsMouseMove",a),r.external.$(e).off("CornerstoneToolsMouseDown",l),r.external.$(e).off("CornerstoneToolsMouseDownActivate",o),e.addEventListener("cornerstoneimagerendered",s),r.external.$(e).on("CornerstoneToolsMouseMove",n,a),r.external.$(e).on("CornerstoneToolsMouseDown",n,l),r.external.$(e).on("CornerstoneToolsMouseDownActivate",n,o),r.external.cornerstone.updateImage(e)}function p(e,t){var n={mouseButtonMask:t};e.removeEventListener("cornerstoneimagerendered",s),r.external.$(e).off("CornerstoneToolsMouseMove",a),r.external.$(e).off("CornerstoneToolsMouseDown",l),r.external.$(e).off("CornerstoneToolsMouseDownActivate",o),e.addEventListener("cornerstoneimagerendered",s),r.external.$(e).on("CornerstoneToolsMouseMove",n,a),r.external.$(e).on("CornerstoneToolsMouseDown",n,l),r.external.cornerstone.updateImage(e)}return{enable:g,disable:f,activate:h,deactivate:p}};var r=n(0),a=n(35),i=o(a),l=n(18),u=o(l),s=n(36),c=o(s),f=n(21),d=o(f),g=n(37),v=o(g),h=n(12),m=o(h),p=n(2),x=o(p),T=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){o.external.$(t).off("CornerstoneToolsTouchPinch",e);var n={};o.external.$(t).on("CornerstoneToolsTouchPinch",n,e)},disable:function(t){o.external.$(t).off("CornerstoneToolsTouchPinch",e)},enable:function(t){o.external.$(t).off("CornerstoneToolsTouchPinch",e)},deactivate:function(t){o.external.$(t).off("CornerstoneToolsTouchPinch",e)}}};var o=n(0)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t,n){e.onMouseMove(t,n)}function n(a,i){e.onMouseUp(a,i),r.external.$(i.element).off("CornerstoneToolsMouseDrag",t),r.external.$(i.element).off("CornerstoneToolsMouseDrag",o),r.external.$(i.element).off("CornerstoneToolsMouseUp",n),r.external.$(i.element).off("CornerstoneToolsMouseClick",n)}function o(t,n){return e.onDrag(t,n),!1}function i(a,i){if((0,s.default)(i.which,a.data.mouseButtonMask))return r.external.$(i.element).on("CornerstoneToolsMouseDrag",o),r.external.$(i.element).on("CornerstoneToolsMouseUp",n),r.external.$(i.element).on("CornerstoneToolsMouseClick",n),e.onMouseDown(a,i),!1;r.external.$(i.element).on("CornerstoneToolsMouseDrag",t),r.external.$(i.element).on("CornerstoneToolsMouseUp",n)}function u(t){var n=t.detail,o=n.element,i=(0,a.getToolState)(o,c),l=void 0;i?l=i.data[0].pixelData:(l=new Uint8ClampedArray(n.image.width*n.image.height),(0,a.addToolState)(o,c,{pixelData:l}));var u=r.external.cornerstone.getLayer(n.element,f);u.image.setPixelData(l),u.invalid=!0,r.external.cornerstone.updateImage(o),e.onImageRendered(t,n)}function d(e,n){e.removeEventListener("cornerstoneimagerendered",u),e.addEventListener("cornerstoneimagerendered",u);var o={mouseButtonMask:n};r.external.$(e).off("CornerstoneToolsMouseDownActivate",i),r.external.$(e).on("CornerstoneToolsMouseDownActivate",o,i),r.external.$(e).off("CornerstoneToolsMouseMove",t),r.external.$(e).on("CornerstoneToolsMouseMove",t);var l=r.external.cornerstone.getEnabledElement(e),s=l.image,d=s.width,g=s.height,h=new Uint8ClampedArray(d*g),m=v.getConfiguration(),p=m.colormapId;if(!p){p="BrushColorMap";var x=r.external.cornerstone.colors.getColormap(p);x.setNumberOfColors(2),x.setColor(0,[0,0,0,0]),x.setColor(1,[255,0,0,255])}var T={minPixelValue:0,maxPixelValue:1,slope:1,intercept:0,getPixelData:function(){return h},rows:l.image.height,columns:l.image.width,height:g,width:d,pixelData:h,setPixelData:function(e){h=e},colormap:p,color:!1,rgba:!1,labelmap:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:l.image.width*l.image.height},y=void 0,b={viewport:{pixelReplication:!0}};f&&(y=r.external.cornerstone.getLayer(e,f)),y||(f=r.external.cornerstone.addLayer(e,T,b)),(0,a.addToolState)(e,c,{pixelData:h}),m.brushLayerId=f,v.setConfiguration(m),r.external.cornerstone.updateImage(e)}function g(e){e.removeEventListener("cornerstoneimagerendered",u),r.external.$(e).off("CornerstoneToolsMouseDownActivate",i),r.external.$(e).off("CornerstoneToolsMouseMove",t)}var v=(0,l.default)({mouseMoveCallback:t,mouseDownActivateCallback:i,onImageRendered:u,deactivate:g});return v.activate=d,v};var r=n(0),a=n(1),i=n(7),l=o(i),u=n(2),s=o(u),c="brush",f=void 0},function(e,t,n){"use strict";function o(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=Math.round(o),i=Math.round(r);if(1===e)return[[a,i]];for(var l=[],u=0,s=-e;s<=e;s++){var c=i+s;if(!(c>t||c<0))for(var f=-e;f<=e;f++){var d=a+f;d>n||d<0||f*f+s*s<e*e&&(l[u++]=[a+f,i+s])}}return l}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o},function(e,t,n){"use strict";function o(e,t,n,o){var r=function(e,t){return t*o+e};e.forEach(function(e){var o=r(e[0],e[1]);t[o]=n})}function r(e,t,n,o){var r=a.external.cornerstone.pixelToCanvas(o,{x:0,y:0}),i=a.external.cornerstone.pixelToCanvas(o,{x:1,y:1}),l=i.x-r.x,u=i.y-r.y;t.save(),t.fillStyle=n,e.forEach(function(e){var n=a.external.cornerstone.pixelToCanvas(o,{x:e[0],y:e[1]});t.fillRect(n.x,n.y,l,u)}),t.restore()}Object.defineProperty(t,"__esModule",{value:!0}),t.drawBrushOnCanvas=t.drawBrushPixels=void 0;var a=n(0);t.drawBrushPixels=o,t.drawBrushOnCanvas=r},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);Object.defineProperty(t,"external",{enumerable:!0,get:function(){return r.external}});var a=n(62);Object.defineProperty(t,"referenceLines",{enumerable:!0,get:function(){return o(a).default}});var i=n(41);Object.defineProperty(t,"orientation",{enumerable:!0,get:function(){return o(i).default}});var l=n(27);Object.defineProperty(t,"requestPoolManager",{enumerable:!0,get:function(){return o(l).default}});var u=n(42);Object.defineProperty(t,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return o(u).default}});var s=n(43);Object.defineProperty(t,"scrollToIndex",{enumerable:!0,get:function(){return o(s).default}});var c=n(29);Object.defineProperty(t,"scroll",{enumerable:!0,get:function(){return o(c).default}});var f=n(30);Object.defineProperty(t,"roundToDecimal",{enumerable:!0,get:function(){return o(f).default}});var d=n(26);Object.defineProperty(t,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return d.projectPatientPointToImagePlane}}),Object.defineProperty(t,"imagePointToPatientPoint",{enumerable:!0,get:function(){return d.imagePointToPatientPoint}}),Object.defineProperty(t,"planePlaneIntersection",{enumerable:!0,get:function(){return d.planePlaneIntersection}});var g=n(16);Object.defineProperty(t,"pointInsideBoundingBox",{enumerable:!0,get:function(){return o(g).default}});var v=n(31);Object.defineProperty(t,"pointInEllipse",{enumerable:!0,get:function(){return o(v).default}});var h=n(32);Object.defineProperty(t,"pauseEvent",{enumerable:!0,get:function(){return o(h).default}});var m=n(2);Object.defineProperty(t,"isMouseButtonEnabled",{enumerable:!0,get:function(){return o(m).default}});var p=n(33);Object.defineProperty(t,"getRGBPixels",{enumerable:!0,get:function(){return o(p).default}});var x=n(19);Object.defineProperty(t,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return x.getDefaultSimultaneousRequests}}),Object.defineProperty(t,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return x.getMaxSimultaneousRequests}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return x.getBrowserInfo}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return x.isMobileDevice}});var T=n(45);Object.defineProperty(t,"getLuminance",{enumerable:!0,get:function(){return o(T).default}});var y=n(6);Object.defineProperty(t,"drawTextBox",{enumerable:!0,get:function(){return o(y).default}});var b=n(46);Object.defineProperty(t,"drawEllipse",{enumerable:!0,get:function(){return o(b).default}});var C=n(47);Object.defineProperty(t,"drawCircle",{enumerable:!0,get:function(){return o(C).default}});var M=n(48);Object.defineProperty(t,"drawArrow",{enumerable:!0,get:function(){return o(M).default}});var w=n(34);Object.defineProperty(t,"copyPoints",{enumerable:!0,get:function(){return o(w).default}});var P=n(17);Object.defineProperty(t,"calculateSUV",{enumerable:!0,get:function(){return o(P).default}});var _=n(49);Object.defineProperty(t,"calculateEllipseStatistics",{enumerable:!0,get:function(){return o(_).default}});var S=n(66);Object.defineProperty(t,"probeTool4D",{enumerable:!0,get:function(){return o(S).default}});var I=n(38);Object.defineProperty(t,"incrementTimePoint",{enumerable:!0,get:function(){return o(I).default}});var k=n(69);Object.defineProperty(t,"timeSeriesPlayer",{enumerable:!0,get:function(){return o(k).default}});var O=n(70);Object.defineProperty(t,"timeSeriesScroll",{enumerable:!0,get:function(){return O.timeSeriesScroll}}),Object.defineProperty(t,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return O.timeSeriesScrollWheel}}),Object.defineProperty(t,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return O.timeSeriesScrollTouchDrag}});var $=n(71);Object.defineProperty(t,"wwwcSynchronizer",{enumerable:!0,get:function(){return o($).default}});var D=n(72);Object.defineProperty(t,"updateImageSynchronizer",{enumerable:!0,get:function(){return o(D).default}});var j=n(73);Object.defineProperty(t,"Synchronizer",{enumerable:!0,get:function(){return o(j).default}});var E=n(74);Object.defineProperty(t,"stackScrollSynchronizer",{enumerable:!0,get:function(){return o(E).default}});var A=n(75);Object.defineProperty(t,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return o(A).default}});var R=n(76);Object.defineProperty(t,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return o(R).default}});var L=n(77);Object.defineProperty(t,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return o(L).default}});var B=n(78);Object.defineProperty(t,"panZoomSynchronizer",{enumerable:!0,get:function(){return o(B).default}});var N=n(5);Object.defineProperty(t,"toolStyle",{enumerable:!0,get:function(){return o(N).default}});var U=n(1);Object.defineProperty(t,"addToolState",{enumerable:!0,get:function(){return U.addToolState}}),Object.defineProperty(t,"getToolState",{enumerable:!0,get:function(){return U.getToolState}}),Object.defineProperty(t,"removeToolState",{enumerable:!0,get:function(){return U.removeToolState}}),Object.defineProperty(t,"clearToolState",{enumerable:!0,get:function(){return U.clearToolState}}),Object.defineProperty(t,"setElementToolStateManager",{enumerable:!0,get:function(){return U.setElementToolStateManager}}),Object.defineProperty(t,"getElementToolStateManager",{enumerable:!0,get:function(){return U.getElementToolStateManager}});var z=n(35);Object.defineProperty(t,"toolCoordinates",{enumerable:!0,get:function(){return o(z).default}});var V=n(4);Object.defineProperty(t,"toolColors",{enumerable:!0,get:function(){return o(V).default}});var W=n(79);Object.defineProperty(t,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return W.addTimeSeriesStateManager}}),Object.defineProperty(t,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return W.newTimeSeriesSpecificToolStateManager}});var H=n(14);Object.defineProperty(t,"textStyle",{enumerable:!0,get:function(){return o(H).default}});var F=n(80);Object.defineProperty(t,"stackSpecificStateManager",{enumerable:!0,get:function(){return F.stackSpecificStateManager}}),Object.defineProperty(t,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return F.newStackSpecificToolStateManager}}),Object.defineProperty(t,"addStackStateManager",{enumerable:!0,get:function(){return F.addStackStateManager}});var Y=n(10);Object.defineProperty(t,"loadHandlerManager",{enumerable:!0,get:function(){return o(Y).default}});var q=n(15);Object.defineProperty(t,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return q.newImageIdSpecificToolStateManager}}),Object.defineProperty(t,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return q.globalImageIdSpecificToolStateManager}});var X=n(81);Object.defineProperty(t,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return X.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(t,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return X.globalFrameOfReferenceSpecificToolStateManager}});var K=n(82);Object.defineProperty(t,"appState",{enumerable:!0,get:function(){return o(K).default}});var G=n(83);Object.defineProperty(t,"stackScrollKeyboard",{enumerable:!0,get:function(){return o(G).default}});var Z=n(44);Object.defineProperty(t,"stackScroll",{enumerable:!0,get:function(){return Z.stackScroll}}),Object.defineProperty(t,"stackScrollWheel",{enumerable:!0,get:function(){return Z.stackScrollWheel}}),Object.defineProperty(t,"stackScrollTouchDrag",{enumerable:!0,get:function(){return Z.stackScrollTouchDrag}}),Object.defineProperty(t,"stackScrollMultiTouch",{enumerable:!0,get:function(){return Z.stackScrollMultiTouch}});var J=n(84);Object.defineProperty(t,"stackPrefetch",{enumerable:!0,get:function(){return o(J).default}});var Q=n(85);Object.defineProperty(t,"scrollIndicator",{enumerable:!0,get:function(){return o(Q).default}});var ee=n(86);Object.defineProperty(t,"stackRenderers",{enumerable:!0,get:function(){return o(ee).default}});var te=n(88);Object.defineProperty(t,"playClip",{enumerable:!0,get:function(){return te.playClip}}),Object.defineProperty(t,"stopClip",{enumerable:!0,get:function(){return te.stopClip}});var ne=n(12);Object.defineProperty(t,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return o(ne).default}});var oe=n(8);Object.defineProperty(t,"drawHandles",{enumerable:!0,get:function(){return o(oe).default}});var re=n(18);Object.defineProperty(t,"getHandleNearImagePoint",{enumerable:!0,get:function(){return o(re).default}});var ae=n(36);Object.defineProperty(t,"handleActivator",{enumerable:!0,get:function(){return o(ae).default}});var ie=n(37);Object.defineProperty(t,"moveAllHandles",{enumerable:!0,get:function(){return o(ie).default}});var le=n(21);Object.defineProperty(t,"moveHandle",{enumerable:!0,get:function(){return o(le).default}});var ue=n(22);Object.defineProperty(t,"moveNewHandle",{enumerable:!0,get:function(){return o(ue).default}});var se=n(24);Object.defineProperty(t,"moveNewHandleTouch",{enumerable:!0,get:function(){return o(se).default}});var ce=n(51);Object.defineProperty(t,"touchMoveAllHandles",{enumerable:!0,get:function(){return o(ce).default}});var fe=n(52);Object.defineProperty(t,"touchMoveHandle",{enumerable:!0,get:function(){return o(fe).default}});var de=n(89);Object.defineProperty(t,"keyboardInput",{enumerable:!0,get:function(){return o(de).default}});var ge=n(90);Object.defineProperty(t,"mouseInput",{enumerable:!0,get:function(){return o(ge).default}});var ve=n(91);Object.defineProperty(t,"mouseWheelInput",{enumerable:!0,get:function(){return o(ve).default}});var he=n(53);Object.defineProperty(t,"preventGhostClick",{enumerable:!0,get:function(){return o(he).default}});var me=n(92);Object.defineProperty(t,"touchInput",{enumerable:!0,get:function(){return o(me).default}});var pe=n(93);Object.defineProperty(t,"angle",{enumerable:!0,get:function(){return pe.angle}}),Object.defineProperty(t,"angleTouch",{enumerable:!0,get:function(){return pe.angleTouch}});var xe=n(94);Object.defineProperty(t,"arrowAnnotate",{enumerable:!0,get:function(){return xe.arrowAnnotate}}),Object.defineProperty(t,"arrowAnnotateTouch",{enumerable:!0,get:function(){return xe.arrowAnnotateTouch}});var Te=n(95);Object.defineProperty(t,"crosshairs",{enumerable:!0,get:function(){return Te.crosshairs}}),Object.defineProperty(t,"crosshairsTouch",{enumerable:!0,get:function(){return Te.crosshairsTouch}});var ye=n(23);Object.defineProperty(t,"displayTool",{enumerable:!0,get:function(){return o(ye).default}});var be=n(54);Object.defineProperty(t,"doubleTapTool",{enumerable:!0,get:function(){return o(be).default}});var Ce=n(96);Object.defineProperty(t,"doubleTapZoom",{enumerable:!0,get:function(){return o(Ce).default}});var Me=n(97);Object.defineProperty(t,"dragProbe",{enumerable:!0,get:function(){return Me.dragProbe}}),Object.defineProperty(t,"dragProbeTouch",{enumerable:!0,get:function(){return Me.dragProbeTouch}});var we=n(98);Object.defineProperty(t,"ellipticalRoi",{enumerable:!0,get:function(){return we.ellipticalRoi}}),Object.defineProperty(t,"ellipticalRoiTouch",{enumerable:!0,get:function(){return we.ellipticalRoiTouch}});var Pe=n(99);Object.defineProperty(t,"freehand",{enumerable:!0,get:function(){return Pe.freehand}});var _e=n(100);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return _e.highlight}}),Object.defineProperty(t,"highlightTouch",{enumerable:!0,get:function(){return _e.highlightTouch}});var Se=n(101);Object.defineProperty(t,"imageStats",{enumerable:!0,get:function(){return o(Se).default}});var Ie=n(50);Object.defineProperty(t,"keyboardTool",{enumerable:!0,get:function(){return o(Ie).default}});var ke=n(102);Object.defineProperty(t,"length",{enumerable:!0,get:function(){return ke.length}}),Object.defineProperty(t,"lengthTouch",{enumerable:!0,get:function(){return ke.lengthTouch}});var Oe=n(103);Object.defineProperty(t,"magnify",{enumerable:!0,get:function(){return Oe.magnify}}),Object.defineProperty(t,"magnifyTouchDrag",{enumerable:!0,get:function(){return Oe.magnifyTouchDrag}});var $e=n(55);Object.defineProperty(t,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return o($e).default}});var De=n(7);Object.defineProperty(t,"mouseButtonTool",{enumerable:!0,get:function(){return o(De).default}});var je=n(20);Object.defineProperty(t,"mouseWheelTool",{enumerable:!0,get:function(){return o(je).default}});var Ee=n(28);Object.defineProperty(t,"multiTouchDragTool",{enumerable:!0,get:function(){return o(Ee).default}});var Ae=n(104);Object.defineProperty(t,"orientationMarkers",{enumerable:!0,get:function(){return o(Ae).default}});var Re=n(105);Object.defineProperty(t,"pan",{enumerable:!0,get:function(){return Re.pan}}),Object.defineProperty(t,"panTouchDrag",{enumerable:!0,get:function(){return Re.panTouchDrag}});var Le=n(106);Object.defineProperty(t,"panMultiTouch",{enumerable:!0,get:function(){return o(Le).default}});var Be=n(107);Object.defineProperty(t,"probe",{enumerable:!0,get:function(){return Be.probe}}),Object.defineProperty(t,"probeTouch",{enumerable:!0,get:function(){return Be.probeTouch}});var Ne=n(108);Object.defineProperty(t,"rectangleRoi",{enumerable:!0,get:function(){return Ne.rectangleRoi}}),Object.defineProperty(t,"rectangleRoiTouch",{enumerable:!0,get:function(){return Ne.rectangleRoiTouch}});var Ue=n(109);Object.defineProperty(t,"rotate",{enumerable:!0,get:function(){return Ue.rotate}}),Object.defineProperty(t,"rotateTouchDrag",{enumerable:!0,get:function(){return Ue.rotateTouchDrag}});var ze=n(110);Object.defineProperty(t,"rotateTouch",{enumerable:!0,get:function(){return o(ze).default}});var Ve=n(111);Object.defineProperty(t,"saveAs",{enumerable:!0,get:function(){return o(Ve).default}});var We=n(112);Object.defineProperty(t,"seedAnnotate",{enumerable:!0,get:function(){return We.seedAnnotate}}),Object.defineProperty(t,"seedAnnotateTouch",{enumerable:!0,get:function(){return We.seedAnnotateTouch}});var He=n(113);Object.defineProperty(t,"simpleAngle",{enumerable:!0,get:function(){return He.simpleAngle}}),Object.defineProperty(t,"simpleAngleTouch",{enumerable:!0,get:function(){return He.simpleAngleTouch}});var Fe=n(13);Object.defineProperty(t,"simpleMouseButtonTool",{enumerable:!0,get:function(){return o(Fe).default}});var Ye=n(114);Object.defineProperty(t,"textMarker",{enumerable:!0,get:function(){return Ye.textMarker}}),Object.defineProperty(t,"textMarkerTouch",{enumerable:!0,get:function(){return Ye.textMarkerTouch}});var qe=n(11);Object.defineProperty(t,"touchDragTool",{enumerable:!0,get:function(){return o(qe).default}});var Xe=n(56);Object.defineProperty(t,"touchPinchTool",{enumerable:!0,get:function(){return o(Xe).default}});var Ke=n(9);Object.defineProperty(t,"touchTool",{enumerable:!0,get:function(){return o(Ke).default}});var Ge=n(115);Object.defineProperty(t,"wwwc",{enumerable:!0,get:function(){return Ge.wwwc}}),Object.defineProperty(t,"wwwcTouchDrag",{enumerable:!0,get:function(){return Ge.wwwcTouchDrag}});var Ze=n(116);Object.defineProperty(t,"wwwcRegion",{enumerable:!0,get:function(){return Ze.wwwcRegion}}),Object.defineProperty(t,"wwwcRegionTouch",{enumerable:!0,get:function(){return Ze.wwwcRegionTouch}});var Je=n(117);Object.defineProperty(t,"zoom",{enumerable:!0,get:function(){return Je.zoom}}),Object.defineProperty(t,"zoomWheel",{enumerable:!0,get:function(){return Je.zoomWheel}}),Object.defineProperty(t,"zoomTouchPinch",{enumerable:!0,get:function(){return Je.zoomTouchPinch}}),Object.defineProperty(t,"zoomTouchDrag",{enumerable:!0,get:function(){return Je.zoomTouchDrag}});var Qe=n(118);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return Qe.brush}});var et=n(119);Object.defineProperty(t,"adaptiveBrush",{enumerable:!0,get:function(){return et.adaptiveBrush}});var tt=n(120);Object.defineProperty(t,"regionsThreshold",{enumerable:!0,get:function(){return tt.regionsThreshold}}),Object.defineProperty(t,"regionsGrow",{enumerable:!0,get:function(){return tt.regionsGrow}}),Object.defineProperty(t,"regionsDraw",{enumerable:!0,get:function(){return tt.regionsDraw}}),Object.defineProperty(t,"regionsScore",{enumerable:!0,get:function(){return tt.regionsScore}}),Object.defineProperty(t,"regionsUndo",{enumerable:!0,get:function(){return tt.regionsUndo}});var nt=n(128);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return o(nt).default}})},function(t,n){t.exports=e},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(39),a=o(r),i=n(63),l=o(i),u=n(40),s=o(u),c={calculateReferenceLine:a.default,tool:l.default,renderActiveReferenceLine:s.default};t.default=c},function(e,t,n){"use strict";function o(e){var t=e.detail,n=(0,l.getToolState)(e.currentTarget,c);if(void 0!==n){var o=n.data[0].synchronizationContext,r=o.getSourceElements(),a=n.data[0].renderer,u=t.canvasContext.canvas.getContext("2d");i.external.cornerstone.setToPixelCoordinateSystem(t.enabledElement,u),r.forEach(function(n){n!==e.currentTarget&&a(u,t,e.currentTarget,n)})}}function r(e,t,n){n=n||s.default,(0,l.addToolState)(e,c,{synchronizationContext:t,renderer:n}),e.removeEventListener("cornerstoneimagerendered",o),e.addEventListener("cornerstoneimagerendered",o),i.external.cornerstone.updateImage(e)}function a(e){e.removeEventListener("cornerstoneimagerendered",o),i.external.cornerstone.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),l=n(1),u=n(40),s=function(e){return e&&e.__esModule?e:{default:e}}(u),c="referenceLines",f={enable:r,disable:a};t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t="",n=e.x<0?"R":"L",r=e.y<0?"A":"P",a=e.z<0?"F":"H",i=new o.cornerstoneMath.Vector3(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),l=0;l<3;l++)if(i.x>1e-4&&i.x>i.y&&i.x>i.z)t+=n,i.x=0;else if(i.y>1e-4&&i.y>i.x&&i.y>i.z)t+=r,i.y=0;else{if(!(i.z>1e-4&&i.z>i.x&&i.z>i.y))break;t+=a,i.z=0}return t};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace("H","f");return t=t.replace("F","h"),t=t.replace("R","l"),t=t.replace("L","r"),t=t.replace("A","p"),t=t.replace("P","a"),t=t.toUpperCase()}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=l.external.cornerstone,n=[];e.timeSeries.stacks.forEach(function(o){var r=void 0;r=!0===o.preventCache?t.loadImage(o.imageIds[e.imageIdIndex]):t.loadAndCacheImage(o.imageIds[e.imageIdIndex]),r.then(function(t){var o=Math.round(e.handles.end.x)+Math.round(e.handles.end.y)*t.width,r=t.getPixelData()[o];n.push(r)})}),e.lineSample.set(n)}function a(e){var t=(0,v.getToolState)(e.element,"timeSeries");if(void 0!==t&&void 0!==t.data&&0!==t.data.length){var n=t.data[0],o={timeSeries:n,lineSample:new x.default,imageIdIndex:n.stacks[n.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};return r(o),m.default.add(o),o}}function i(e,t){var n=(0,v.getToolState)(e.currentTarget,T);if(n){var o=t.canvasContext.canvas.getContext("2d");l.external.cornerstone.setToPixelCoordinateSystem(t.enabledElement,o);for(var r=0;r<n.data.length;r++){o.save();var a=n.data[r];o.beginPath(),(0,f.default)(o,t,a.handles,"white"),o.stroke();var i=(0,g.default)(t.enabledElement,t.canvasContext,15);o.font=i.fontSize+"px Arial";var u=Math.round(a.handles.end.x),s=Math.round(a.handles.end.y),c=a.handles.end.x+3,d=a.handles.end.y-3;o.fillStyle="white",o.fillText(u+","+s,c,d),o.restore()}}}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),u=n(7),s=o(u),c=n(8),f=o(c),d=n(42),g=o(d),v=n(1),h=n(67),m=o(h),p=n(68),x=o(p),T="probe4D",y=(0,s.default)({createNewMeasurement:a,onImageRendered:i,toolType:T});t.default=y},function(e,t,n){"use strict";function o(){var e=this;e.measurements=[],this.add=function(t){var n=e.measurements.push(t),o={index:n,measurement:t};(0,a.default)(e,"CornerstoneMeasurementAdded",o)},this.remove=function(t){var n=e.measurements[t];e.measurements.splice(t,1);var o={index:t,measurement:n};(0,a.default)(e,"CornerstoneMeasurementRemoved",o)}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=new o;t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=this;e.samples=[],this.set=function(t){e.samples=t,(0,r.default)(e,"CornerstoneLineSampleUpdated")}};var o=n(3),r=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,n){"use strict";function o(e,t){if(void 0===e)throw new Error("playClip: element must not be undefined");void 0===t&&(t=30);var n=(0,a.getToolState)(e,"timeSeries");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){var o=(0,a.getToolState)(e,u),r=void 0;void 0===o||0===o.data.length?(r={intervalId:void 0,framesPerSecond:t,lastFrameTimeStamp:void 0,frameRate:0},(0,a.addToolState)(e,u,r)):(r=o.data[0],r.framesPerSecond=t),void 0===r.intervalId&&(r.intervalId=setInterval(function(){r.framesPerSecond>0?(0,l.default)(e,1,!0):(0,l.default)(e,-1,!0)},1e3/Math.abs(r.framesPerSecond)))}}function r(e){var t=(0,a.getToolState)(e,u);if(t&&t.data&&t.data.length){var n=t.data[0];clearInterval(n.intervalId),n.intervalId=void 0}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),i=n(38),l=function(e){return e&&e.__esModule?e:{default:e}}(i),u="timeSeriesPlayer",s={start:o,stop:r};t.default=s},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){s.external.$(t.element).off("CornerstoneToolsMouseDrag",i),s.external.$(t.element).off("CornerstoneToolsMouseUp",r),s.external.$(t.element).off("CornerstoneToolsMouseClick",r)}function a(e,t){if((0,T.default)(t.which,e.data.mouseButtonMask)){var n={deltaY:0,options:e.data.options};return s.external.$(t.element).on("CornerstoneToolsMouseDrag",n,i),s.external.$(t.element).on("CornerstoneToolsMouseUp",r),s.external.$(t.element).on("CornerstoneToolsMouseClick",r),e.stopImmediatePropagation(),!1}}function i(e,t){e.data.deltaY+=t.deltaPoints.page.y;var n=(0,y.getToolState)(t.element,"timeSeries");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){var o=n.data[0],r=s.external.$(t.element).height()/o.stacks.length;if(void 0!==e.data.options&&void 0!==e.data.options.timeSeriesScrollSpeed&&(r=e.data.options.timeSeriesScrollSpeed),e.data.deltaY>=r||e.data.deltaY<=-r){var a=Math.round(e.data.deltaY/r),i=e.data.deltaY%r;(0,p.default)(t.element,a),e.data.deltaY=i}return!1}}function l(e,t){var n=-t.direction;(0,p.default)(t.element,n)}function u(e){var t=e.originalEvent.detail,n={deltaY:0};n.deltaY+=t.deltaPoints.page.y;var o=(0,y.getToolState)(t.element,"stack");if(void 0!==o&&void 0!==o.data&&0!==o.data.length){if(n.deltaY>=3||n.deltaY<=-3){var r=n.deltaY/3,a=n.deltaY%3;(0,p.default)(n.element,r),n.deltaY=a}return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=void 0;var s=n(0),c=n(13),f=o(c),d=n(11),g=o(d),v=n(20),h=o(v),m=n(38),p=o(m),x=n(2),T=o(x),y=n(1),b=(0,f.default)(a),C=(0,h.default)(l),M=(0,g.default)(u);t.timeSeriesScroll=b,t.timeSeriesScrollWheel=C,t.timeSeriesScrollTouchDrag=M},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n!==t){var r=o.external.cornerstone,a=r.getViewport(t),i=r.getViewport(n);i.voi.windowWidth===a.voi.windowWidth&&i.voi.windowCenter===a.voi.windowCenter&&i.invert===a.invert||(i.voi.windowWidth=a.voi.windowWidth,i.voi.windowCenter=a.voi.windowCenter,i.invert=a.invert,e.setViewport(n,i))}};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n!==t&&o.external.cornerstone.updateImage(n)};var o=n(0)},function(e,t,n){"use strict";function o(e,t){function n(e,t){u.length&&s.length&&(c=!0,s.forEach(function(n){var o=s.indexOf(n);if(-1!==o){var r=f.imageIds.targetElements[o],a=u.indexOf(e);if(-1!==a){var i=f.imageIds.sourceElements[a],c=void 0;i===r?c=0:void 0!==f.distances[i]&&(c=f.distances[i][r]),d(l,e,n,t,c)}}}),c=!1)}function o(e,t){!0!==c&&n(e.currentTarget,t)}function a(e){var t=e.detail.element;l.remove(t)}var i=r.external.cornerstone,l=this,u=[],s=[],c=!1,f={},d=t;this.setHandler=function(e){d=e},this.getHandler=function(){return d},this.getDistances=function(){u.length&&s.length&&(f.distances={},f.imageIds={sourceElements:[],targetElements:[]},u.forEach(function(e){var t=i.getEnabledElement(e);if(t&&t.image){var n=t.image.imageId,o=i.metaData.get("imagePlaneModule",n);if(o&&o.imagePositionPatient){var r=o.imagePositionPatient;f.hasOwnProperty(t)||(f.distances[n]={},f.imageIds.sourceElements.push(n),s.forEach(function(t){var o=i.getEnabledElement(t);if(o&&o.image){var a=o.image.imageId;if(f.imageIds.targetElements.push(a),e!==t&&n!==a&&!f.distances[n].hasOwnProperty(a)){var l=i.metaData.get("imagePlaneModule",a);if(l&&l.imagePositionPatient){var u=l.imagePositionPatient;f.distances[n][a]=u.clone().sub(r)}}}}),Object.keys(f.distances[n]).length||delete f.distances[n])}}}))},this.addSource=function(t){-1===u.indexOf(t)&&(u.push(t),r.external.$(t).on(e,o),l.getDistances(),l.updateDisableHandlers())},this.addTarget=function(e){-1===s.indexOf(e)&&(s.push(e),l.getDistances(),d(l,e,e,0),l.updateDisableHandlers())},this.add=function(e){l.addSource(e),l.addTarget(e)},this.removeSource=function(t){var a=u.indexOf(t);-1!==a&&(u.splice(a,1),r.external.$(t).off(e,o),l.getDistances(),n(t),l.updateDisableHandlers())},this.removeTarget=function(e){var t=s.indexOf(e);-1!==t&&(s.splice(t,1),l.getDistances(),d(l,e,e,0),l.updateDisableHandlers())},this.remove=function(e){l.removeTarget(e),l.removeSource(e)},this.getSourceElements=function(){return u},this.getTargetElements=function(){return s},this.displayImage=function(e,t,n){c=!0,i.displayImage(e,t,n),c=!1},this.setViewport=function(e,t){c=!0,i.setViewport(e,t),c=!1},this.updateDisableHandlers=function(){r.external.$.unique(u.concat(s)).forEach(function(e){e.removeEventListener("cornerstoneelementdisabled",a),e.addEventListener("cornerstoneelementdisabled",a)})},this.destroy=function(){r.external.$.unique(u.concat(s)).forEach(function(e){l.remove(e)})}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,a){if(t!==n&&a&&a.direction){var l=o.external.cornerstone,u=(0,r.getToolState)(n,"stack"),s=u.data[0],c=s.currentImageIdIndex+a.direction;if(c=Math.min(Math.max(c,0),s.imageIds.length-1),s.currentImageIdIndex!==c){var f=i.default.getStartLoadHandler(),d=i.default.getEndLoadHandler(),g=i.default.getErrorLoadingHandler();f&&f(n);var v=void 0;v=!0===s.preventCache?l.loadImage(s.imageIds[c]):l.loadAndCacheImage(s.imageIds[c]),v.then(function(t){var o=l.getViewport(n);s.currentImageIdIndex=c,e.displayImage(n,t,o),d&&d(n,t)},function(e){var t=s.imageIds[c];g&&g(n,t,e)})}}};var o=n(0),r=n(1),a=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n!==t){var a=o.external.cornerstone,l=a.getEnabledElement(t).image,u=a.metaData.get("imagePlaneModule",l.imageId),s=u.imagePositionPatient,c=(0,r.getToolState)(n,"stack"),f=c.data[0],d=Number.MAX_VALUE,g=-1;if(f.imageIds.forEach(function(e,t){var n=a.metaData.get("imagePlaneModule",e),o=n.imagePositionPatient,r=o.distanceToSquared(s);r<d&&(d=r,g=t)}),g!==f.currentImageIdIndex){var v=i.default.getStartLoadHandler(),h=i.default.getEndLoadHandler(),m=i.default.getErrorLoadingHandler();if(v&&v(n),-1!==g){var p=void 0;p=!0===f.preventCache?a.loadImage(f.imageIds[g]):a.loadAndCacheImage(f.imageIds[g]),p.then(function(t){var o=a.getViewport(n);f.currentImageIdIndex=g,e.displayImage(n,t,o),h&&h(n,t)},function(e){var t=f.imageIds[g];m&&m(n,t,e)})}}}};var o=n(0),r=n(1),a=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,a,l){if(n!==t){var u=o.external.cornerstone,s=u.getEnabledElement(t),c=u.metaData.get("imagePlaneModule",s.image.imageId),f=c.imagePositionPatient,d=(0,r.getToolState)(n,"stack"),g=d.data[0],v=Number.MAX_VALUE,h=-1;if(l){var m=f.clone().add(l);if(g.imageIds.forEach(function(e,t){var n=u.metaData.get("imagePlaneModule",e),o=n.imagePositionPatient,r=m.distanceToSquared(o);r<v&&(v=r,h=t)}),h!==g.currentImageIdIndex&&-1!==h){var p=i.default.getStartLoadHandler(),x=i.default.getEndLoadHandler(),T=i.default.getErrorLoadingHandler();p&&p(n);var y=void 0;y=!0===g.preventCache?u.loadImage(g.imageIds[h]):u.loadAndCacheImage(g.imageIds[h]),y.then(function(t){var o=u.getViewport(n);g.currentImageIdIndex=h,e.displayImage(n,t,o),x&&x(n,t)},function(e){var t=g.imageIds[h];T&&T(n,t,e)})}}}};var o=n(0),r=n(1),a=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n!==t){var a=o.external.cornerstone,l=(0,r.getToolState)(t,"stack"),u=l.data[0],s=(0,r.getToolState)(n,"stack"),c=s.data[0],f=u.currentImageIdIndex;if((f=Math.min(Math.max(f,0),c.imageIds.length-1))!==c.currentImageIdIndex){var d=i.default.getStartLoadHandler(),g=i.default.getEndLoadHandler(),v=i.default.getErrorLoadingHandler();d&&d(n);var h=void 0;h=!0===c.preventCache?a.loadImage(c.imageIds[f]):a.loadAndCacheImage(c.imageIds[f]),h.then(function(t){var o=a.getViewport(n);c.currentImageIdIndex=f,e.displayImage(n,t,o),g&&g(n,t)},function(e){var t=c.imageIds[f];v&&v(n,t,e)})}}};var o=n(0),r=n(1),a=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n!==t){var r=o.external.cornerstone,a=r.getViewport(t),i=r.getViewport(n);i.scale===a.scale&&i.translation.x===a.translation.x&&i.translation.y===a.translation.y||(i.scale=a.scale,i.translation.x=a.translation.x,i.translation.y=a.translation.y,e.setViewport(n,i))}};var o=n(0)},function(e,t,n){"use strict";function o(e,t){function n(n,o,a){if(!(e.indexOf(o)>=0))return t.add(n,o,a);!1===r.hasOwnProperty(o)&&(r[o]={data:[]}),r[o].data.push(a)}function o(n,o){return e.indexOf(o)>=0?(!1===r.hasOwnProperty(o)&&(r[o]={data:[]}),r[o]):t.get(n,o)}var r={};return{get:o,add:n}}function r(e,t){t=t||["timeSeries"];var n=(0,i.getElementToolStateManager)(e);void 0===n&&(n=a.globalImageIdSpecificToolStateManager);var r=o(t,n);l.push(r),(0,i.setElementToolStateManager)(e,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=void 0;var a=n(15),i=n(1),l=[];t.addTimeSeriesStateManager=r,t.newTimeSeriesSpecificToolStateManager=o},function(e,t,n){"use strict";function o(e,t){function n(){return i}function o(e){i=e}function r(n,o,r){if(!(e.indexOf(o)>=0))return t.add(n,o,r);!1===i.hasOwnProperty(o)&&(i[o]={data:[]}),i[o].data.push(r)}function a(n,o){return e.indexOf(o)>=0?(!1===i.hasOwnProperty(o)&&(i[o]={data:[]}),i[o]):t.get(n,o)}var i={};return{get:a,add:r,saveToolState:n,restoreToolState:o,toolState:i}}function r(e,t){var n=(0,i.getElementToolStateManager)(e);n||(n=a.globalImageIdSpecificToolStateManager);var r=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(r=r.concat(t));var u=o(r,n);l.push(u),(0,i.setElementToolStateManager)(e,u)}Object.defineProperty(t,"__esModule",{value:!0}),t.addStackStateManager=t.newStackSpecificToolStateManager=t.stackSpecificStateManager=void 0;var a=n(15),i=n(1),l=[],u={newStackSpecificToolStateManager:o,addStackStateManager:r};t.stackSpecificStateManager=u,t.newStackSpecificToolStateManager=o,t.addStackStateManager=r},function(e,t,n){"use strict";function o(){function e(e,t,n){!1===o.hasOwnProperty(e)&&(o[e]={});var r=o[e];!1===r.hasOwnProperty(t)&&(r[t]={data:[]}),r[t].data.push(n)}function t(e,t){if(!1!==o.hasOwnProperty(e)){var n=o[e];if(!1!==n.hasOwnProperty(t)){return n[t]}}}function n(e,t,n){if(!1!==o.hasOwnProperty(e)){var r=o[e];if(!1!==r.hasOwnProperty(t)){for(var a=r[t],i=-1,l=0;l<a.data.length;l++)a.data[l]===n&&(i=l);-1!==i&&a.data.splice(i,1)}}}var o={};return{get:t,add:e,remove:n}}Object.defineProperty(t,"__esModule",{value:!0});var r=o();t.newFrameOfReferenceSpecificToolStateManager=o,t.globalFrameOfReferenceSpecificToolStateManager=r},function(e,t,n){"use strict";function o(e){var t={imageIdToolState:i.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return e.forEach(function(e){var n=(0,l.getElementToolStateManager)(e);n!==i.globalImageIdSpecificToolStateManager&&(t.elementToolState[e.id]=n.saveToolState(),t.elementViewport[e.id]=a.external.cornerstone.getViewport(e))}),t}function r(e){if(e.hasOwnProperty("imageIdToolState")&&e.hasOwnProperty("elementToolState")&&e.hasOwnProperty("elementViewport")){var t=a.external.cornerstone;return i.globalImageIdSpecificToolStateManager.restoreToolState(e.imageIdToolState),Object.keys(e.elementViewport).forEach(function(n){var o=document.getElementById(n);if(o&&e.elementToolState.hasOwnProperty(n)){var r=(0,l.getElementToolStateManager)(o);if(r!==i.globalImageIdSpecificToolStateManager){r.restoreToolState(e.elementToolState[n]);var a=e.elementViewport[n];t.setViewport(o,a),t.updateImage(o)}}}),e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(15),l=n(1),u={save:o,restore:r};t.default=u},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=t.keyCode;if(n===s.UP||n===s.DOWN){var o=1;n===s.DOWN&&(o=-1),(0,i.default)(t.element,o)}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(29),i=o(a),l=n(50),u=o(l),s={UP:38,DOWN:40},c=(0,u.default)(r);t.default=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){e=Math.round(e)||0,t=Math.round(t)||0;var n=[],o=t-e+1;if(o<=0)return n;for(;o--;)n[o]=t--;return n}function a(e,t){var n=[],o=[];return e.forEach(function(e){e<t?n.push(e):e>t&&o.push(e)}),{low:e.indexOf(P(n)),high:e.indexOf(_(o))}}function i(e){function t(e){var t=u.indicesToRequest.indexOf(e);t>-1&&u.indicesToRequest.splice(t,1)}function n(e){t(i.imageIds.indexOf(e.imageId))}function o(t){console.log("prefetch errored: "+t),d&&d(e,c,t,"stackPrefetch")}var r=(0,x.getToolState)(e,"stack");if(r&&r.data&&r.data.length){var i=r.data[0],l=(0,x.getToolState)(e,y);if(l){var u=l.data[0]||{};if(u.indicesToRequest&&u.indicesToRequest.length||(u.enabled=!1),!1!==u.enabled){l.data[0].indicesToRequest.sort(function(e,t){return e-t});if(u.indicesToRequest.slice().forEach(function(e){var n=i.imageIds[e];if(n){var o=g.external.cornerstone.imageCache.getImagePromise(n);o&&"resolved"===o.state()&&t(e)}}),u.indicesToRequest.length){h.default.clearRequestStack(b);for(var s=a(u.indicesToRequest,i.currentImageIdIndex),c=void 0,f=void 0,d=p.default.getErrorLoadingHandler(),v=s.low,m=s.high;v>=0||m<u.indicesToRequest.length;){var T=i.currentImageIdIndex,M=T-u.indicesToRequest[v]>C.maxImagesToPrefetch,w=u.indicesToRequest[m]-T>C.maxImagesToPrefetch,P=!M&&v>=0,_=!w&&m<u.indicesToRequest.length;if(!_&&!P)break;P&&(f=u.indicesToRequest[v--],c=i.imageIds[f],h.default.addRequest(e,c,b,!1,n,o)),_&&(f=u.indicesToRequest[m++],c=i.imageIds[f],h.default.addRequest(e,c,b,!1,n,o))}h.default.startGrabbing()}}}}}function l(e){return function(t){var n=t.detail,o=void 0;try{o=(0,x.getToolState)(e,"stack")}catch(e){return}if(o&&o.data&&o.data.length){var r=o.data[0],a=r.imageIds.indexOf(n.imageId);if(!(a<0)){var i=(0,x.getToolState)(e,y);i&&i.data&&i.data.length&&i.data[0].indicesToRequest.push(a)}}}}function u(e){clearTimeout(M),M=setTimeout(function(){var t=e.target;try{i(t)}catch(e){return}},w)}function s(e){(0,x.getToolState)(e,y).data=[];var t=(0,x.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];if(!0===n.preventCache)return void console.warn("A stack that should not be cached was given the stackPrefetch");var o={indicesToRequest:r(0,n.imageIds.length-1),enabled:!0,direction:1},a=o.indicesToRequest.indexOf(n.currentImageIdIndex);o.indicesToRequest.splice(a,1),(0,x.addToolState)(e,y,o),i(e),e.removeEventListener("cornerstonenewimage",u),e.addEventListener("cornerstonenewimage",u);var s=l(e);g.external.cornerstone.events.removeEventListener("cornerstoneimagecachepromiseremoved",s),g.external.cornerstone.events.addEventListener("cornerstoneimagecachepromiseremoved",s)}}function c(e){clearTimeout(M),e.removeEventListener("cornerstonenewimage",u);var t=l(e);g.external.cornerstone.events.removeEventListener("cornerstoneimagecachepromiseremoved",t);var n=(0,x.getToolState)(e,y);n&&n.data.length&&(n.data[0].enabled=!1,h.default.clearRequestStack(b))}function f(){return C}function d(e){C=e,e.maxSimultaneousRequests&&(0,T.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}Object.defineProperty(t,"__esModule",{value:!0});var g=n(0),v=n(27),h=o(v),m=n(10),p=o(m),x=n(1),T=n(19),y="stackPrefetch",b="prefetch",C={maxImagesToPrefetch:1/0},M=void 0,w=10,P=function(e){return Math.max.apply(null,e)},_=function(e){return Math.min.apply(null,e)},S={enable:s,disable:c,getConfiguration:f,setConfiguration:d};t.default=S},function(e,t,n){"use strict";function o(e,t){var n=t.element,o=t.enabledElement.canvas.width,r=t.enabledElement.canvas.height;if(!o||!r)return!1;var a=t.enabledElement.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0),a.save();var u=s.getConfiguration();a.fillStyle=u.backgroundColor,"horizontal"===u.orientation?a.fillRect(0,r-l,o,l):a.fillRect(0,0,l,r);var c=(0,i.getToolState)(n,"stack");if(c&&c.data&&c.data.length){var f=c.data[0].imageIds,d=c.data[0].currentImageIdIndex,g=o/f.length,v=r/f.length,h=g*d,m=v*d;a.fillStyle=u.fillColor,"horizontal"===u.orientation?a.fillRect(h,r-l,g,l):a.fillRect(0,m,l,v),a.restore()}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=n(1),l=6,u={backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"},s=(0,a.default)(o);s.setConfiguration(u),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(87),r=function(e){return e&&e.__esModule?e:{default:e}}(o),a={};a.FusionRenderer=r.default,t.default=a},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),i=n(1),l=function(){function e(){o(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return r(e,[{key:"render",value:function(e,t){var n=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");if(!t){t=(0,i.getToolState)(e,"stack").data}var o=a.external.cornerstone,r=t[0],l=r.imageIds[this.currentImageIdIndex],u=t.slice(1,t.length);o.loadAndCacheImage(l).then(function(t){var a=n.layerIds[0];a?o.setLayerImage(e,t,a):(a=o.addLayer(e,t,r.options),n.layerIds.push(a)),o.displayImage(e,t),u.forEach(function(t,r){var i=n.findImageFn(t.imageIds,l),u=r+1,s=n.layerIds[u];s||(s=o.addLayer(e,void 0,t.options),n.layerIds.push(s)),i?o.loadAndCacheImage(i).then(function(t){o.setLayerImage(e,t,s),o.updateImage(e)}):(o.setLayerImage(e,void 0,s),o.setActiveLayer(e,a),o.updateImage(e))})})}}]),e}();t.default=l},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=void 0,o=void 0,r=void 0,a=0,i=e.length,l=[];for(l.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),n=1;n<i;n++)r=Number(e[n])/t|0,l.push(r),1===n?o=r:r!==o&&(l.isTimeVarying=!0),a+=r;return l.length>0&&(r=l.isTimeVarying?a/l.length|0:l[0],l.push(r)),l}function a(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function i(e){var t={element:e};(0,v.default)(e,"CornerstoneToolsClipStopped",t)}function l(e,t){var n=void 0,o=void 0;if(void 0===e)throw new Error("playClip: element must not be undefined");var l=(0,d.getToolState)(e,"stack");if(l&&l.data&&l.data.length){var u=s.external.cornerstone,c=void 0;if(l.data.length>1){var g=(0,d.getToolState)(e,"stackRenderer");g&&g.data&&g.data.length&&(c=g.data[0])}var v=l.data[0],m=(0,d.getToolState)(e,h);m&&m.data&&m.data.length?(n=m.data[0],a(n)):(n={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,d.addToolState)(e,h,n)),(t<0||t>0)&&(n.framesPerSecond=Number(t),n.reverse=n.framesPerSecond<0,n.ignoreFrameTimeVector=!0),!0!==n.ignoreFrameTimeVector&&n.frameTimeVector&&n.frameTimeVector.length===v.imageIds.length&&(o=r(n.frameTimeVector,n.speed));var p=function(){var t=void 0,o=void 0,r=void 0,s=void 0,d=v.currentImageIdIndex,g=v.imageIds.length;if(n.reverse?d--:d++,!n.loop&&(d<0||d>=g))return a(n),void i(e);d>=g&&(d=0),d<0&&(d=g-1),d!==v.currentImageIdIndex&&(o=f.default.getStartLoadHandler(),r=f.default.getEndLoadHandler(),s=f.default.getErrorLoadingHandler(),o&&o(e),t=!0===v.preventCache?u.loadImage(v.imageIds[d]):u.loadAndCacheImage(v.imageIds[d]),t.then(function(t){try{v.currentImageIdIndex=d,c?(c.currentImageIdIndex=d,c.render(e,l.data)):u.displayImage(e,t),r&&r(e,t)}catch(e){return}},function(t){var n=v.imageIds[d];s&&s(e,n,t)}))};o&&o.length>0&&o.isTimeVarying?(n.usingFrameTimeVector=!0,n.intervalId=setTimeout(function e(){n.intervalId=setTimeout(e,o[v.currentImageIdIndex]),p()},0)):(n.usingFrameTimeVector=!1,n.intervalId=setInterval(p,1e3/Math.abs(n.framesPerSecond)))}}function u(e){var t=(0,d.getToolState)(e,h);t&&t.data&&t.data.length&&a(t.data[0])}Object.defineProperty(t,"__esModule",{value:!0}),t.stopClip=t.playClip=void 0;var s=n(0),c=n(10),f=o(c),d=n(1),g=n(3),v=o(g),h="playClip";t.playClip=l,t.stopClip=u},function(e,t,n){"use strict";function o(e){var t=l.external.cornerstone,n=e.currentTarget,o={event:window.event||e,element:n,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,currentPoints:{page:{x:c,y:f},image:t.pageToPixel(n,c,f)},keyCode:e.keyCode,which:e.which};o.currentPoints.canvas=t.pixelToCanvas(n,o.currentPoints.image);var r={keydown:"CornerstoneToolsKeyDown",keypress:"CornerstoneToolsKeyPress",keyup:"CornerstoneToolsKeyUp"};(0,s.default)(n,r[e.type],o)}function r(e){c=e.pageX||e.originalEvent.pageX,f=e.pageY||e.originalEvent.pageY}function a(e){i(e),l.external.$(e).on(d,o),l.external.$(e).on("mousemove",r)}function i(e){l.external.$(e).off(d,o),l.external.$(e).off("mousemove",r)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),u=n(3),s=function(e){return e&&e.__esModule?e:{default:e}}(u),c=void 0,f=void 0,d="keydown keypress keyup",g={enable:a,disable:i};t.default=g},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return"number"!=typeof e.buttons?e.which:0===e.buttons?0:e.buttons%2==1?1:e.buttons%4==2?3:e.buttons%8==4?2:0}function a(){x=!1}function i(e){var t=f.external.cornerstone,n=e.currentTarget,o="CornerstoneToolsMouseDoubleClick",a={page:f.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(n,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};a.canvas=t.pixelToCanvas(n,a.image);var i=(0,g.default)(a),l={event:e,which:r(e),viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,startPoints:a,lastPoints:i,currentPoints:a,deltaPoints:{x:0,y:0},type:o};(0,p.default)(l.element,o,l)}function l(e){function t(e){var t={page:f.cornerstoneMath.point.pageToPoint(e),image:o.pageToPixel(i,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};t.canvas=o.pixelToCanvas(i,t.image);var n={page:f.cornerstoneMath.point.subtract(t.page,s.page),image:f.cornerstoneMath.point.subtract(t.image,s.image),client:f.cornerstoneMath.point.subtract(t.client,s.client),canvas:f.cornerstoneMath.point.subtract(t.canvas,s.canvas)},r={which:d,viewport:o.getViewport(i),image:o.getEnabledElement(i).image,element:i,startPoints:l,lastPoints:s,currentPoints:t,deltaPoints:n,type:"CornerstoneToolsMouseDrag",ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};return(0,p.default)(r.element,"CornerstoneToolsMouseDrag",r),s=(0,g.default)(t),(0,h.default)(e)}function n(e){clearTimeout(T);var r="CornerstoneToolsMouseUp";x&&(r="CornerstoneToolsMouseClick");var a={page:f.cornerstoneMath.point.pageToPoint(e),image:o.pageToPixel(i,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};a.canvas=o.pixelToCanvas(i,a.image);var c={page:f.cornerstoneMath.point.subtract(a.page,s.page),image:f.cornerstoneMath.point.subtract(a.image,s.image),client:f.cornerstoneMath.point.subtract(a.client,s.client),canvas:f.cornerstoneMath.point.subtract(a.canvas,s.canvas)},g={event:e,which:d,viewport:o.getViewport(i),image:o.getEnabledElement(i).image,element:i,startPoints:l,lastPoints:s,currentPoints:a,deltaPoints:c,type:r};(0,p.default)(g.element,r,g),f.external.$(document).off("mousemove",t),f.external.$(document).off("mouseup",n),f.external.$(g.element).on("mousemove",u),x=!0}T=setTimeout(a,y);var o=f.external.cornerstone,i=e.currentTarget;f.external.$(i).off("mousemove",u);var l={page:f.cornerstoneMath.point.pageToPoint(e),image:o.pageToPixel(i,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.pixelToCanvas(i,l.image);var s=(0,g.default)(l),c={event:e,which:r(e),viewport:o.getViewport(i),image:o.getEnabledElement(i).image,element:i,startPoints:l,lastPoints:s,currentPoints:l,deltaPoints:{x:0,y:0},type:"CornerstoneToolsMouseDown"};(0,p.default)(c.element,"CornerstoneToolsMouseDown",c)&&(c.type="CornerstoneToolsMouseDownActivate",(0,p.default)(c.element,"CornerstoneToolsMouseDownActivate",c));var d=r(e);return f.external.$(document).on("mousemove",t),f.external.$(document).on("mouseup",n),(0,h.default)(e)}function u(e){var t=f.external.cornerstone,n=e.currentTarget,o={page:f.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(n,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};o.canvas=t.pixelToCanvas(n,o.image);var a=(0,g.default)(o),i=r(e),l={page:f.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(n,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=t.pixelToCanvas(n,l.image);var u={page:f.cornerstoneMath.point.subtract(l.page,a.page),image:f.cornerstoneMath.point.subtract(l.image,a.image),client:f.cornerstoneMath.point.subtract(l.client,a.client),canvas:f.cornerstoneMath.point.subtract(l.canvas,a.canvas)},s={which:i,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,startPoints:o,lastPoints:a,currentPoints:l,deltaPoints:u,type:"CornerstoneToolsMouseMove"};(0,p.default)(n,"CornerstoneToolsMouseMove",s),a=(0,g.default)(l)}function s(e){f.external.$(e).off("mousedown",l),f.external.$(e).off("mousemove",u),f.external.$(e).off("dblclick",i)}function c(e){s(e),f.external.$(e).on("mousedown",l),f.external.$(e).on("mousemove",u),f.external.$(e).on("dblclick",i)}Object.defineProperty(t,"__esModule",{value:!0});var f=n(0),d=n(34),g=o(d),v=n(32),h=o(v),m=n(3),p=o(m),x=!0,T=void 0,y=200,b={enable:c,disable:s};t.default=b},function(e,t,n){"use strict";function o(e){if(!("mousewheel"===e.originalEvent.type&&0===e.originalEvent.wheelDeltaY||"DOMMouseScroll"===e.originalEvent.type&&1===e.originalEvent.axis)){e.preventDefault();var t=i.external.cornerstone,n=e.currentTarget,o=void 0,r=void 0;void 0!==e.pageX&&void 0!==e.pageY?(o=e.pageX,r=e.pageY):e.originalEvent&&void 0!==e.originalEvent.pageX&&void 0!==e.originalEvent.pageY?(o=e.originalEvent.pageX,r=e.originalEvent.pageY):(o=e.x,r=e.y);var a=t.pageToPixel(n,o,r);e=window.event&&window.event.wheelDelta?window.event:e;var l=void 0;l=e.originalEvent&&e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:e.originalEvent&&e.originalEvent.deltaY?-e.originalEvent.deltaY:e.originalEvent&&e.originalEvent.detail?-e.originalEvent.detail:e.wheelDelta;var s=l<0?-1:1,c={element:n,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,direction:s,pageX:o,pageY:r,imageX:a.x,imageY:a.y};(0,u.default)(n,"CornerstoneToolsMouseWheel",c)}}function r(e){a(e),i.external.$(e).on(s,o)}function a(e){i.external.$(e).unbind(s,o)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),l=n(3),u=function(e){return e&&e.__esModule?e:{default:e}}(l),s="mousewheel DOMMouseScroll",c={enable:r,disable:a};t.default=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=l.external.cornerstone,n=e.currentTarget||e.srcEvent.currentTarget,o=void 0,r=void 0,a=void 0,i=void 0,u=void 0;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length>1)&&(S=!1,clearTimeout(C)),e.type){case"tap":S=!1,clearTimeout(C),p={page:l.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(n,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},p.canvas=t.pixelToCanvas(n,p.image),o="CornerstoneToolsTap",y={event:e,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,currentPoints:p,type:o,isTouchEvent:!0},(0,h.default)(n,o,y);break;case"doubletap":S=!1,clearTimeout(C),p={page:l.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(n,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},p.canvas=t.pixelToCanvas(n,p.image),o="CornerstoneToolsDoubleTap",y={event:e,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,currentPoints:p,type:o,isTouchEvent:!0},(0,h.default)(n,o,y);break;case"pinchstart":S=!1,clearTimeout(C),w=1;break;case"pinchmove":if(S=!1,clearTimeout(C),!0===_){w=e.scale,_=!1;break}r=(e.scale-w)/w,m={page:e.center,image:t.pageToPixel(n,e.center.x,e.center.y)},m.canvas=t.pixelToCanvas(n,m.image),o="CornerstoneToolsTouchPinch",y={event:e,startPoints:m,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,direction:e.scale<1?1:-1,scaleChange:r,type:o,isTouchEvent:!0},(0,h.default)(n,o,y),w=e.scale;break;case"touchstart":w=1,clearTimeout(C),clearTimeout(b),b=setTimeout(function(){m={page:l.cornerstoneMath.point.pageToPoint(e.originalEvent.touches[0]),image:t.pageToPixel(n,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}},m.canvas=t.pixelToCanvas(n,m.image),o="CornerstoneToolsTouchStart",e.originalEvent.touches.length>1&&(o="CornerstoneToolsMultiTouchStart"),y={event:e,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,startPoints:m,currentPoints:m,type:o,isTouchEvent:!0},!0===(0,h.default)(n,o,y)&&(o="CornerstoneToolsTouchStartActive",e.originalEvent.touches.length>1&&(o="CornerstoneToolsMultiTouchStartActive"),y.type=o,(0,h.default)(n,o,y)),x=(0,s.default)(m)},50),S=!0,M=0,C=setTimeout(function(){S&&(p={page:l.cornerstoneMath.point.pageToPoint(e.originalEvent.touches[0]),image:t.pageToPixel(n,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}},p.canvas=t.pixelToCanvas(n,m.image),o="CornerstoneToolsTouchPress",y={event:e,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,currentPoints:p,type:o,isTouchEvent:!0},(0,h.default)(n,o,y))},k);break;case"touchend":w=1,S=!1,clearTimeout(C),setTimeout(function(){m={page:l.cornerstoneMath.point.pageToPoint(e.originalEvent.changedTouches[0]),image:t.pageToPixel(n,e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY),client:{x:e.originalEvent.changedTouches[0].clientX,y:e.originalEvent.changedTouches[0].clientY}},m.canvas=t.pixelToCanvas(n,m.image),o="CornerstoneToolsTouchEnd",y={event:e,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,startPoints:m,currentPoints:m,type:o,isTouchEvent:!0},(0,h.default)(n,o,y)},50);break;case"panmove":a={x:e.deltaX-I.x,y:e.deltaY-I.y},I={x:e.deltaX,y:e.deltaY},p={page:{x:x.page.x+a.x,y:x.page.y+a.y},image:t.pageToPixel(n,x.page.x+a.x,x.page.y+a.y),client:{x:x.client.x+a.x,y:x.client.y+a.y}},p.canvas=t.pixelToCanvas(n,p.image),T={page:l.cornerstoneMath.point.subtract(p.page,x.page),image:l.cornerstoneMath.point.subtract(p.image,x.image),client:l.cornerstoneMath.point.subtract(p.client,x.client),canvas:l.cornerstoneMath.point.subtract(p.canvas,x.canvas)},M+=Math.sqrt(T.page.x*T.page.x+T.page.y*T.page.y),M>O&&(S=!1,clearTimeout(C)),o="CornerstoneToolsTouchDrag",e.pointers.length>1&&(o="CornerstoneToolsMultiTouchDrag"),y={viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,startPoints:m,lastPoints:x,currentPoints:p,deltaPoints:T,numPointers:e.pointers.length,type:o,isTouchEvent:!0},(0,h.default)(n,o,y),x=(0,s.default)(p);break;case"panstart":I={x:e.deltaX,y:e.deltaY},p={page:l.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(n,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},p.canvas=t.pixelToCanvas(n,p.image),x=(0,s.default)(p);break;case"panend":return S=!1,(clearTimeout(C),x)?(p={page:l.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(n,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},p.canvas=t.pixelToCanvas(n,p.image),T={page:l.cornerstoneMath.point.subtract(p.page,x.page),image:l.cornerstoneMath.point.subtract(p.image,x.image),client:l.cornerstoneMath.point.subtract(p.client,x.client),canvas:l.cornerstoneMath.point.subtract(p.canvas,x.canvas)},o="CornerstoneToolsDragEnd",y={event:e.srcEvent,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,startPoints:m,lastPoints:x,currentPoints:p,deltaPoints:T,type:o,isTouchEvent:!0},(0,h.default)(n,o,y),i=e.pointers.length-e.changedPointers.length,2===i&&(_=!0),(0,f.default)(e)):!1;case"rotatemove":S=!1,clearTimeout(C),u=e.rotation-P,P=e.rotation,o="CornerstoneToolsTouchRotate",y={event:e.srcEvent,viewport:t.getViewport(n),image:t.getEnabledElement(n).image,element:n,rotation:u,type:o},(0,h.default)(n,o,y)}return!1}function a(e){i(e);var t=l.external.Hammer,n={inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput},o=new t.Manager(e,n),a={pointers:0,direction:t.DIRECTION_ALL,threshold:0},u=new t.Pan(a),s=new t.Pinch({threshold:0}),c=new t.Rotate({threshold:0});s.recognizeWith(u),s.recognizeWith(c),c.recognizeWith(u);var f=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});f.recognizeWith(u),o.add([f,u,c,s]),o.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",r),g.default.enable(e),l.external.$(e).on("touchstart touchend",r),l.external.$(e).data("hammer",o)}function i(e){g.default.disable(e),l.external.$(e).off("touchstart touchend",r);var t=l.external.$(e).data("hammer");t&&t.off("tap doubletap panstart panmove panend pinchmove rotatemove",r)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),u=n(34),s=o(u),c=n(32),f=o(c),d=n(53),g=o(d),v=n(3),h=o(v),m=void 0,p=void 0,x=void 0,T=void 0,y=void 0,b=void 0,C=void 0,M=void 0,w=1,P=0,_=!1,S=!1,I=void 0,k=700,O=5,$={enable:a,disable:i};t.default=$},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1}}}}function a(e,t,n){var o=l.external.cornerstone,r={start:o.pixelToCanvas(e,t.handles.start),end:o.pixelToCanvas(e,t.handles.end)},a=l.cornerstoneMath.lineSegment.distanceToPoint(r,n);return a<5||(r.start=o.pixelToCanvas(e,t.handles.start2),r.end=o.pixelToCanvas(e,t.handles.end2),(a=l.cornerstoneMath.lineSegment.distanceToPoint(r,n))<5)}function i(e,t){var n=(0,w.getToolState)(e.currentTarget,P);if(void 0!==n){var o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);for(var r=void 0,a=p.default.getToolWidth(),i=T.default.getFont(),u=_.getConfiguration(),s=l.external.cornerstone,c=0;c<n.data.length;c++){o.save(),u&&u.shadow&&(o.shadowColor=u.shadowColor||"#000000",o.shadowOffsetX=u.shadowOffsetX||1,o.shadowOffsetY=u.shadowOffsetY||1);var f=n.data[c];r=f.active?b.default.getActiveColor():b.default.getToolColor(),o.beginPath(),o.strokeStyle=r,o.lineWidth=a;var d=s.pixelToCanvas(t.element,f.handles.start),v=s.pixelToCanvas(t.element,f.handles.end);o.moveTo(d.x,d.y),o.lineTo(v.x,v.y),d=s.pixelToCanvas(t.element,f.handles.start2),v=s.pixelToCanvas(t.element,f.handles.end2),o.moveTo(d.x,d.y),o.lineTo(v.x,v.y),o.stroke(),(0,M.default)(o,t,f.handles),o.fillStyle=r;var m=(Math.ceil(f.handles.start.x)-Math.ceil(f.handles.end.x))*t.image.columnPixelSpacing,x=(Math.ceil(f.handles.start.y)-Math.ceil(f.handles.end.y))*t.image.rowPixelSpacing,y=(Math.ceil(f.handles.start2.x)-Math.ceil(f.handles.end2.x))*t.image.columnPixelSpacing,C=(Math.ceil(f.handles.start2.y)-Math.ceil(f.handles.end2.y))*t.image.rowPixelSpacing,S=Math.acos(Math.abs((m*y+x*C)/(Math.sqrt(m*m+x*x)*Math.sqrt(y*y+C*C))));S*=180/Math.PI;var I=(0,h.default)(S,2),k=I.toString()+String.fromCharCode(parseInt("00B0",16)),O=(d.x+v.x)/2,$=(d.y+v.y)/2;o.font=i,(0,g.default)(o,k,O,$,r),o.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.angleTouch=t.angle=void 0;var l=n(0),u=n(7),s=o(u),c=n(9),f=o(c),d=n(6),g=o(d),v=n(30),h=o(v),m=n(5),p=o(m),x=n(14),T=o(x),y=n(4),b=o(y),C=n(8),M=o(C),w=n(1),P="angle",_=(0,s.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:a,toolType:P}),S=(0,f.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:a,toolType:P});t.angle=_,t.angleTouch=S},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){e(prompt("Enter your annotation:"))}function a(e,t,n){n(prompt("Change your annotation:"))}function i(e){function t(t){null===t?(0,U.removeToolState)(e.element,z,n):n.text=t,n.active=!1,o.updateImage(e.element),g.external.$(e.element).on("CornerstoneToolsMouseMove",r,W.mouseMoveCallback),g.external.$(e.element).on("CornerstoneToolsMouseDown",r,W.mouseDownCallback),g.external.$(e.element).on("CornerstoneToolsMouseDownActivate",r,W.mouseDownActivateCallback),g.external.$(e.element).on("CornerstoneToolsMouseDoubleClick",r,W.mouseDoubleClickCallback)}var n=l(e),o=g.external.cornerstone,r={mouseButtonMask:e.which};(0,U.addToolState)(e.element,z,n),g.external.$(e.element).off("CornerstoneToolsMouseMove",W.mouseMoveCallback),g.external.$(e.element).off("CornerstoneToolsMouseDown",W.mouseDownCallback),g.external.$(e.element).off("CornerstoneToolsMouseDownActivate",W.mouseDownActivateCallback),g.external.$(e.element).off("CornerstoneToolsMouseDoubleClick",W.mouseDoubleClickCallback),o.updateImage(e.element),(0,$.default)(e,z,n,n.handles.end,function(){(0,A.default)(e,n.handles)&&(0,U.removeToolState)(e.element,z,n);var r=W.getConfiguration();void 0===n.text&&r.getTextCallback(t),o.updateImage(e.element)})}function l(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function u(e,t,n){var o=g.external.cornerstone,r={start:o.pixelToCanvas(e,t.handles.start),end:o.pixelToCanvas(e,t.handles.end)};return g.cornerstoneMath.lineSegment.distanceToPoint(r,n)<25}function s(e,t){var n=(0,U.getToolState)(e.currentTarget,z);if(n){var o=t.enabledElement,r=g.external.cornerstone,a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var i=void 0,l=b.default.getToolWidth(),u=M.default.getFont(),s=W.getConfiguration(),c=0;c<n.data.length;c++){a.save(),s&&s.shadow&&(a.shadowColor=s.shadowColor||"#000000",a.shadowOffsetX=s.shadowOffsetX||1,a.shadowOffsetY=s.shadowOffsetY||1);var f=n.data[c];i=f.active?P.default.getActiveColor():P.default.getToolColor();var d=r.pixelToCanvas(t.element,f.handles.start),v=r.pixelToCanvas(t.element,f.handles.end);s.arrowFirst?(0,k.default)(a,v,d,i,l):(0,k.default)(a,d,v,i,l);var h={drawHandlesIfActive:s&&s.drawHandlesOnHover};if(s.drawHandles&&(0,S.default)(a,t,f.handles,i,h),f.text&&""!==f.text){a.font=u;var m=a.measureText(f.text).width+10,p=M.default.getFontSize()+10,x=Math.max(m,p)/2+5;v.x<d.x&&(x=-x);var y=void 0;if(!f.handles.textBox.hasMoved){y=s.arrowFirst?{x:v.x-m/2+x,y:v.y-p/2}:{x:d.x-m/2-x,y:d.y-p/2};var C=r.internal.getTransform(o);C.invert();var w=C.transformPoint(y.x,y.y);f.handles.textBox.x=w.x,f.handles.textBox.y=w.y}y=r.pixelToCanvas(t.element,f.handles.textBox);var _=(0,T.default)(a,f.text,y.x,y.y,i);if(f.handles.textBox.boundingBox=_,f.handles.textBox.hasMoved){var I={start:{},end:{}},O={x:(d.x+v.x)/2,y:(d.y+v.y)/2},$=[d,v,O];I.end.x=y.x,I.end.y=y.y,I.start=g.cornerstoneMath.point.findClosestPoint($,I.end);var D=[{x:_.left+_.width/2,y:_.top},{x:_.left,y:_.top+_.height/2},{x:_.left+_.width/2,y:_.top+_.height},{x:_.left+_.width,y:_.top+_.height/2}];I.end=g.cornerstoneMath.point.findClosestPoint(D,I.start),a.beginPath(),a.strokeStyle=i,a.lineWidth=l,a.setLineDash([2,3]),a.moveTo(I.start.x,I.start.y),a.lineTo(I.end.x,I.end.y),a.stroke()}}a.restore()}}}function c(e){function t(e){null===e?(0,U.removeToolState)(n,z,o):o.text=e,o.active=!1,r.updateImage(n),g.external.$(n).on("CornerstoneToolsTouchPress",H.pressCallback),g.external.$(n).on("CornerstoneToolsTouchStartActive",H.touchDownActivateCallback),g.external.$(n).on("CornerstoneToolsTap",H.tapCallback)}var n=e.element,o=l(e),r=g.external.cornerstone;(0,U.addToolState)(n,z,o),g.external.$(n).off("CornerstoneToolsTouchPress",H.pressCallback),g.external.$(n).off("CornerstoneToolsTouchStartActive",H.touchDownActivateCallback),g.external.$(n).off("CornerstoneToolsTap",H.tapCallback),r.updateImage(n),(0,j.default)(e,z,o,o.handles.end,function(){r.updateImage(n),(0,A.default)(e,o.handles)&&(0,U.removeToolState)(n,z,o);var a=W.getConfiguration();void 0===o.text&&a.getTextCallback(t)})}function f(e,t){function n(e,t,n){!0===n?(0,U.removeToolState)(o,z,e):e.text=t,e.active=!1,r.updateImage(o)}var o=t.element,r=g.external.cornerstone,a=void 0;if(!e.data||!e.data.mouseButtonMask||(0,L.default)(t.which,e.data.mouseButtonMask)){var i=W.getConfiguration(),l=t.currentPoints.canvas,s=(0,U.getToolState)(o,z);if(s)for(var c=0;c<s.data.length;c++)if(a=s.data[c],u(o,a,l)||(0,N.default)(a.handles.textBox,l))return a.active=!0,r.updateImage(o),i.changeTextCallback(a,t,n),e.stopImmediatePropagation(),!1}}function d(e,t){function n(e,t,n){console.log("pressCallback doneChangingTextCallback"),!0===n?(0,U.removeToolState)(o,z,e):e.text=t,e.active=!1,r.updateImage(o),g.external.$(o).on("CornerstoneToolsTouchStart",H.touchStartCallback),g.external.$(o).on("CornerstoneToolsTouchStartActive",H.touchDownActivateCallback),g.external.$(o).on("CornerstoneToolsTap",H.tapCallback)}var o=t.element,r=g.external.cornerstone,a=void 0;if(!e.data||!e.data.mouseButtonMask||(0,L.default)(t.which,e.data.mouseButtonMask)){var i=W.getConfiguration(),l=t.currentPoints.canvas,s=(0,U.getToolState)(o,z);if(s){if(t.handlePressed)return g.external.$(o).off("CornerstoneToolsTouchStart",H.touchStartCallback),g.external.$(o).off("CornerstoneToolsTouchStartActive",H.touchDownActivateCallback),g.external.$(o).off("CornerstoneToolsTap",H.tapCallback),i.changeTextCallback(t.handlePressed,t,n),e.stopImmediatePropagation(),!1;for(var c=0;c<s.data.length;c++)if(a=s.data[c],u(o,a,l)||(0,N.default)(a.handles.textBox,l))return a.active=!0,r.updateImage(o),g.external.$(o).off("CornerstoneToolsTouchStart",H.touchStartCallback),g.external.$(o).off("CornerstoneToolsTouchStartActive",H.touchDownActivateCallback),g.external.$(o).off("CornerstoneToolsTap",H.tapCallback),i.changeTextCallback(a,t,n),e.stopImmediatePropagation(),!1;return!1}}}Object.defineProperty(t,"__esModule",{value:!0}),t.arrowAnnotateTouch=t.arrowAnnotate=void 0;var g=n(0),v=n(7),h=o(v),m=n(9),p=o(m),x=n(6),T=o(x),y=n(5),b=o(y),C=n(14),M=o(C),w=n(4),P=o(w),_=n(8),S=o(_),I=n(48),k=o(I),O=n(22),$=o(O),D=n(24),j=o(D),E=n(12),A=o(E),R=n(2),L=o(R),B=n(16),N=o(B),U=n(1),z="arrowAnnotate",V={getTextCallback:r,changeTextCallback:a,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},W=(0,h.default)({addNewMeasurement:i,createNewMeasurement:l,onImageRendered:s,pointNearTool:u,toolType:z,mouseDoubleClickCallback:f});W.setConfiguration(V);var H=(0,p.default)({addNewMeasurement:c,createNewMeasurement:l,onImageRendered:s,pointNearTool:u,toolType:z,pressCallback:d});t.arrowAnnotate=W,t.arrowAnnotateTouch=H},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){e.stopImmediatePropagation();var n=(0,x.getToolState)(e.currentTarget,C);if(n){var o=h.external.cornerstone,r=e.currentTarget,a=o.getEnabledElement(r),i=a.image.imageId,l=o.metaData.get("imagePlaneModule",i),u=t.currentPoints.image,s=(0,b.imagePointToPatientPoint)(u,l);n.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==r){var t=Number.MAX_VALUE,n=-1,a=(0,x.getToolState)(e,"stack");if(void 0!==a){var i=a.data[0];if(i.imageIds.forEach(function(e,r){var a=o.metaData.get("imagePlaneModule",e),i=a.imagePositionPatient,l=a.rowCosines.clone(),u=a.columnCosines.clone(),c=u.clone().cross(l.clone()),f=Math.abs(c.clone().dot(i)-c.clone().dot(s));f<t&&(t=f,n=r)}),n!==i.currentImageIdIndex&&-1!==n&&void 0!==i.imageIds[n]){var l=p.default.getStartLoadHandler(),u=p.default.getEndLoadHandler(),c=p.default.getErrorLoadingHandler();l&&l(e);var f=void 0;f=!0===i.preventCache?o.loadImage(i.imageIds[n]):o.loadAndCacheImage(i.imageIds[n]),f.then(function(t){var r=o.getViewport(e);i.currentImageIdIndex=n,o.displayImage(e,t,r),u&&u(e,t)},function(t){var o=i.imageIds[n];c&&c(e,o,t)})}}}})}}function a(e,t){h.external.$(t.element).off("CornerstoneToolsMouseDrag",l),h.external.$(t.element).off("CornerstoneToolsMouseUp",a)}function i(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask))return h.external.$(t.element).on("CornerstoneToolsMouseDrag",l),h.external.$(t.element).on("CornerstoneToolsMouseUp",a),r(e,t),!1}function l(e,t){return r(e,t),!1}function u(e,t,n){var o={mouseButtonMask:t};(0,x.clearToolState)(e,C),(0,x.addToolState)(e,C,{synchronizationContext:n}),h.external.$(e).off("CornerstoneToolsMouseDown",i),h.external.$(e).on("CornerstoneToolsMouseDown",o,i)}function s(e){h.external.$(e).off("CornerstoneToolsMouseDown",i)}function c(e,t){h.external.$(t.element).off("CornerstoneToolsTouchDrag",d),h.external.$(t.element).off("CornerstoneToolsDragEnd",c)}function f(e,t){return h.external.$(t.element).on("CornerstoneToolsTouchDrag",d),h.external.$(t.element).on("CornerstoneToolsDragEnd",c),r(e,t),!1}function d(e,t){return r(e,t),!1}function g(e,t){(0,x.clearToolState)(e,C),(0,x.addToolState)(e,C,{synchronizationContext:t}),h.external.$(e).off("CornerstoneToolsTouchStart",f),h.external.$(e).on("CornerstoneToolsTouchStart",f)}function v(e){h.external.$(e).off("CornerstoneToolsTouchStart",f)}Object.defineProperty(t,"__esModule",{value:!0}),t.crosshairsTouch=t.crosshairs=void 0;var h=n(0),m=n(10),p=o(m),x=n(1),T=n(2),y=o(T),b=n(26),C="crosshairs",M={activate:u,deactivate:s,enable:u,disable:s},w={activate:g,deactivate:v,enable:g,disable:v};t.crosshairs=M,t.crosshairsTouch=w},function(e,t,n){"use strict";function o(e){a.external.cornerstone.fitToWindow(e.element)}function r(e,t){return u.strategy(t),!1}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(54),l=function(e){return e&&e.__esModule?e:{default:e}}(i),u=(0,l.default)(r);u.strategies={default:o},u.strategy=o,t.default=u},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=c.external.cornerstone,n=t.getEnabledElement(e.element),o=n.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);var r=x.default.getActiveColor(),a=m.default.getFont(),i=m.default.getFontSize(),l=I.getConfiguration();o.save(),l&&l.shadow&&(o.shadowColor=l.shadowColor||"#000000",o.shadowOffsetX=l.shadowOffsetX||1,o.shadowOffsetY=l.shadowOffsetY||1);var u=Math.round(e.currentPoints.image.x),s=Math.round(e.currentPoints.image.y),f=void 0,d=void 0,g=void 0;if(!(u<0||s<0||u>=e.image.columns||s>=e.image.rows)){if(e.image.color)f=(0,C.default)(e.element,u,s,1,1),d=u+", "+s,g="R: "+f[0]+" G: "+f[1]+" B: "+f[2]+" A: "+f[3];else{f=t.getStoredPixels(e.element,u,s,1,1);var v=f[0],h=v*e.image.slope+e.image.intercept,p=(0,w.default)(e.image,v);d=u+", "+s,g="SP: "+v+" MO: "+parseFloat(h.toFixed(3)),p&&(g+=" SUV: "+parseFloat(p.toFixed(3)))}var T={x:e.currentPoints.image.x+3,y:e.currentPoints.image.y-3},b=t.pixelToCanvas(e.element,T);o.font=a,o.fillStyle=r,(0,y.default)(o,g,b.x,b.y+i+5,r),(0,y.default)(o,d,b.x,b.y,r),o.restore()}}function a(e){var t=c.external.cornerstone,n=e.element,o=t.getEnabledElement(n),r=o.image,a=o.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);var i=x.default.getActiveColor(),l=m.default.getFont(),u=I.getConfiguration();a.save(),u&&u.shadow&&(a.shadowColor=u.shadowColor||"#000000",a.shadowOffsetX=u.shadowOffsetX||1,a.shadowOffsetY=u.shadowOffsetY||1);var s=t.metaData.get("generalSeriesModule",r.imageId),f=void 0;s&&(f=s.modality);var d=void 0;d=!0===e.isTouchEvent?t.pageToPixel(n,e.currentPoints.page.x,e.currentPoints.page.y-4*m.default.getFontSize()):t.pageToPixel(n,e.currentPoints.page.x,e.currentPoints.page.y-m.default.getFontSize()/2);var g=void 0,v="";if(!(d.x<0||d.y<0||d.x>=r.columns||d.y>=r.rows)){if(r.color)g=(0,C.default)(n,d.x,d.y,1,1),v="R: "+g[0]+" G: "+g[1]+" B: "+g[2];else{g=t.getStoredPixels(n,d.x,d.y,1,1);var h=g[0],p=h*e.image.slope+e.image.intercept,T=parseFloat(p.toFixed(2));if("CT"===f)v+="HU: "+T;else if("PT"===f){v+=T;var b=(0,w.default)(e.image,h);b&&(v+=" SUV: "+parseFloat(b.toFixed(2)))}else v+=T}var M=t.pixelToCanvas(n,d);a.font=l,a.fillStyle=i;var P=void 0,_=a.measureText(v).width;P=!0===e.isTouchEvent?{x:-_/2-5,y:-m.default.getFontSize()-10-12}:{x:12,y:-(m.default.getFontSize()+10)/2},a.beginPath(),a.strokeStyle=i,a.arc(M.x,M.y,6,0,2*Math.PI),a.stroke(),(0,y.default)(a,v,M.x+P.x,M.y+P.y,i),a.restore()}}function i(e,t){var n=t.element;n.removeEventListener("cornerstoneimagerendered",u),c.external.$(n).off("CornerstoneToolsMouseDrag",s),c.external.$(n).off("CornerstoneToolsMouseUp",i),c.external.$(n).off("CornerstoneToolsMouseClick",i),c.external.cornerstone.updateImage(t.element)}function l(e,t){var n=t.element;if((0,_.default)(t.which,e.data.mouseButtonMask))return n.addEventListener("cornerstoneimagerendered",u),c.external.$(n).on("CornerstoneToolsMouseDrag",s),c.external.$(n).on("CornerstoneToolsMouseUp",i),c.external.$(n).on("CornerstoneToolsMouseClick",i),I.strategy(t),!1}function u(){S&&(I.strategy(S),S=null)}function s(e,t){var n=t.element;return S=t,c.external.cornerstone.updateImage(n),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.dragProbeTouch=t.dragProbe=void 0;var c=n(0),f=n(13),d=o(f),g=n(11),v=o(g),h=n(14),m=o(h),p=n(4),x=o(p),T=n(6),y=o(T),b=n(33),C=o(b),M=n(17),w=o(M),P=n(2),_=o(P),S=void 0,I=(0,d.default)(l);I.strategies={default:r,minimal:a},I.strategy=r;var k={fireOnTouchStart:!0},O=(0,v.default)(s,k);t.dragProbe=I,t.dragProbeTouch=O},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function a(e,t,n,o){var r=c.external.cornerstone,a=r.pixelToCanvas(e,t.handles.start),i=r.pixelToCanvas(e,t.handles.end),l={left:Math.min(a.x,i.x)+o/2,top:Math.min(a.y,i.y)+o/2,width:Math.abs(a.x-i.x)-o,height:Math.abs(a.y-i.y)-o},u={left:Math.min(a.x,i.x)-o/2,top:Math.min(a.y,i.y)-o/2,width:Math.abs(a.x-i.x)+o,height:Math.abs(a.y-i.y)+o},s=(0,_.default)(l,n);return!(!(0,_.default)(u,n)||s)}function i(e,t,n){return a(e,t,n,15)}function l(e,t,n){return a(e,t,n,25)}function u(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function s(e,t){var n=(0,$.getToolState)(e.currentTarget,D);if(n){var o=c.external.cornerstone,r=t.image,a=t.element,i=m.default.getToolWidth(),l=j.getConfiguration(),s=t.canvasContext.canvas.getContext("2d"),f=o.metaData.get("generalSeriesModule",r.imageId),d=void 0;f&&(d=f.modality),s.setTransform(1,0,0,1,0,0);for(var g=0;g<n.data.length;g++){s.save();var v=n.data[g];l&&l.shadow&&(s.shadowColor=l.shadowColor||"#000000",s.shadowOffsetX=l.shadowOffsetX||1,s.shadowOffsetY=l.shadowOffsetY||1);var h=x.default.getColorIfActive(v.active),p=o.pixelToCanvas(a,v.handles.start),T=o.pixelToCanvas(a,v.handles.end),b=Math.min(p.x,T.x),M=Math.min(p.y,T.y),P=Math.abs(p.x-T.x),_=Math.abs(p.y-T.y);if(s.beginPath(),s.strokeStyle=h,s.lineWidth=i,(0,w.default)(s,b,M,P,_),s.closePath(),l&&l.drawHandlesOnHover)if(!0===v.active)(0,y.default)(s,t,v.handles,h);else{var S={drawHandlesIfActive:!0};(0,y.default)(s,t,v.handles,h,S)}else(0,y.default)(s,t,v.handles,h);var k=void 0,E=void 0,A=void 0;if(!1===v.invalidated)E=v.meanStdDev,A=v.meanStdDevSUV,k=v.area;else{var R={left:Math.round(Math.min(v.handles.start.x,v.handles.end.x)),top:Math.round(Math.min(v.handles.start.y,v.handles.end.y)),width:Math.round(Math.abs(v.handles.start.x-v.handles.end.x)),height:Math.round(Math.abs(v.handles.start.y-v.handles.end.y))};if(!r.color){var L=o.getPixels(a,R.left,R.top,R.width,R.height);E=(0,I.default)(L,R),"PT"===d&&(A={mean:(0,O.default)(r,(E.mean-r.intercept)/r.slope),stdDev:(0,O.default)(r,(E.stdDev-r.intercept)/r.slope)}),E&&!isNaN(E.mean)&&(v.meanStdDev=E,v.meanStdDevSUV=A)}var B=r.columnPixelSpacing||1,N=r.rowPixelSpacing||1;k=Math.PI*(R.width*B/2)*(R.height*N/2),isNaN(k)||(v.area=k),v.invalidated=!1}var U=[];if(E&&void 0!==E.mean){var z="";"CT"===d&&(z=" HU");var V="Mean: "+u(E.mean.toFixed(2))+z,W="StdDev: "+u(E.stdDev.toFixed(2))+z;if(A&&void 0!==A.mean){V+=" SUV: "+u(A.mean.toFixed(2)),W+=" SUV: "+u(A.stdDev.toFixed(2))}U.push(V),U.push(W)}if(k){var H=" mm"+String.fromCharCode(178);r.rowPixelSpacing&&r.columnPixelSpacing||(H=" pixels"+String.fromCharCode(178));var F="Area: "+u(k.toFixed(2))+H;U.push(F)}v.handles.textBox.hasMoved||(v.handles.textBox.x=Math.max(v.handles.start.x,v.handles.end.x),v.handles.textBox.y=(v.handles.start.y+v.handles.end.y)/2);var Y=o.pixelToCanvas(a,v.handles.textBox),q={centering:{x:!1,y:!0}},X=(0,C.default)(s,U,Y.x,Y.y,h,q);if(v.handles.textBox.boundingBox=X,v.handles.textBox.hasMoved){var K={start:{},end:{x:Y.x,y:Y.y}},G=[{x:b+P/2,y:M},{x:b,y:M+_/2},{x:b+P/2,y:M+_},{x:b+P,y:M+_/2}];K.start=c.cornerstoneMath.point.findClosestPoint(G,K.end);var Z=[{x:X.left+X.width/2,y:X.top},{x:X.left,y:X.top+X.height/2},{x:X.left+X.width/2,y:X.top+X.height},{x:X.left+X.width,y:X.top+X.height/2}];K.end=c.cornerstoneMath.point.findClosestPoint(Z,K.start),s.beginPath(),s.strokeStyle=h,s.lineWidth=i,s.setLineDash([2,3]),s.moveTo(K.start.x,K.start.y),s.lineTo(K.end.x,K.end.y),s.stroke()}s.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.ellipticalRoiTouch=t.ellipticalRoi=void 0;var c=n(0),f=n(7),d=o(f),g=n(9),v=o(g),h=n(5),m=o(h),p=n(4),x=o(p),T=n(8),y=o(T),b=n(6),C=o(b),M=n(46),w=o(M),P=n(31),_=o(P),S=n(49),I=o(S),k=n(17),O=o(k),$=n(1),D="ellipticalRoi",j=(0,d.default)({createNewMeasurement:r,onImageRendered:s,pointNearTool:i,toolType:D}),E=(0,v.default)({createNewMeasurement:r,onImageRendered:s,pointNearTool:l,toolType:D});t.ellipticalRoi=j,t.ellipticalRoiTouch=E},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=(0,I.getToolState)(e.element,k);if(void 0!==t){var n=$.getConfiguration(),o=t.data[n.currentTool],r={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,lines:[]};o.handles.length&&o.handles[n.currentHandle-1].lines.push(e.currentPoints.image),o.handles.push(r),n.currentHandle+=1,n.freehand=!1,T.external.cornerstone.updateImage(e.element)}}function a(e,t){var n=(0,I.getToolState)(e.element,k);if(void 0!==n){var o=n.data[t];if(void 0!==o.handles)for(var r=e.currentPoints.canvas,a=0;a<o.handles.length;a++){var i=T.external.cornerstone.pixelToCanvas(e.element,o.handles[a]);if(T.cornerstoneMath.point.distance(i,r)<5)return a}}}function i(e){var t=(0,I.getToolState)(e.element,k);if(t)for(var n=void 0,o=0;o<t.data.length;o++)if(void 0!==(n=a(e,o)))return{handleNearby:n,toolIndex:o}}function l(e,t){if(T.external.$(t.element).off("CornerstoneToolsMouseUp",l),void 0!==(0,I.getToolState)(t.element,k)){var n=$.getConfiguration();t.event.shiftKey||(n.freehand=!1),T.external.cornerstone.updateImage(t.element)}}function u(e,t){var n=(0,I.getToolState)(t.element,k);if(n){var o=$.getConfiguration(),r=n.data[o.currentTool],i=Math.max(t.currentPoints.image.x,0);i=Math.min(i,t.image.width),o.mouseLocation.handles.start.x=i;var l=Math.max(t.currentPoints.image.y,0);l=Math.min(l,t.image.height),o.mouseLocation.handles.start.y=l;var u=o.currentHandle;if(o.modifying&&(r.active=!0,r.highlight=!0,r.handles[u].x=o.mouseLocation.handles.start.x,r.handles[u].y=o.mouseLocation.handles.start.y,u)){var s=r.handles[u-1].lines.length-1,c=r.handles[u-1].lines[s];c.x=o.mouseLocation.handles.start.x,c.y=o.mouseLocation.handles.start.y}if(o.freehand)r.handles[u-1].lines.push(t.currentPoints.image);else{var f=a(t,o.currentTool);void 0!==f&&f<r.handles.length-1&&(o.mouseLocation.handles.start.x=r.handles[f].x,o.mouseLocation.handles.start.y=r.handles[f].y)}T.external.cornerstone.updateImage(t.element)}}function s(e){T.external.$(e.element).on("CornerstoneToolsMouseMove",u),T.external.$(e.element).on("CornerstoneToolsMouseUp",l);var t={visible:!0,active:!0,handles:[]},n=$.getConfiguration();n.mouseLocation.handles.start.x=e.currentPoints.image.x,n.mouseLocation.handles.start.y=e.currentPoints.image.y,(0,I.addToolState)(e.element,k,t);var o=(0,I.getToolState)(e.element,k);n.currentTool=o.data.length-1}function c(e,t){var n=(0,I.getToolState)(e.element,k);if(n){var o=$.getConfiguration(),r=n.data[o.currentTool];r.active=!1,r.highlight=!1,void 0!==t&&r.handles[o.currentHandle-1].lines.push({x:r.handles[t].x,y:r.handles[t].y}),o.modifying&&(o.modifying=!1),o.currentHandle=0,o.currentTool=-1,T.external.$(e.element).off("CornerstoneToolsMouseMove",u),T.external.cornerstone.updateImage(e.element)}}function f(e,t){if((0,S.default)(t.which,e.data.mouseButtonMask)){var n=(0,I.getToolState)(t.element,k),o=void 0,f=void 0,d=$.getConfiguration(),g=d.currentTool;if(d.modifying)return void c(t);if(g<0){var v=i(t);v?(o=v.handleNearby,f=v.toolIndex,void 0!==o&&(T.external.$(t.element).on("CornerstoneToolsMouseMove",u),T.external.$(t.element).on("CornerstoneToolsMouseUp",l),d.modifying=!0,d.currentHandle=o,d.currentTool=f)):(s(t),r(t))}else g>=0&&n.data[g].active&&(o=a(t,g),void 0!==o?c(t,o):t.event.shiftKey?d.freehand=!0:r(t));return!1}}function d(e){var t=e.detail,n=(0,I.getToolState)(e.currentTarget,k);if(void 0!==n){var o=T.external.cornerstone,r=$.getConfiguration(),a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var i=void 0,l=b.default.getToolWidth(),u=M.default.getFillColor(),s=0;s<n.data.length;s++){a.save();var c=n.data[s];c.active?(i=M.default.getActiveColor(),u=M.default.getFillColor()):(i=M.default.getToolColor(),u=M.default.getToolColor());var f=void 0;if(c.handles.length)for(var d=0;d<c.handles.length;d++){f=c.handles[d];var g=o.pixelToCanvas(t.element,f);a.beginPath(),a.strokeStyle=i,a.lineWidth=l,a.moveTo(g.x,g.y);for(var v=0;v<c.handles[d].lines.length;v++){var h=o.pixelToCanvas(t.element,c.handles[d].lines[v]);a.lineTo(h.x,h.y),a.stroke()}var m=o.pixelToCanvas(t.element,r.mouseLocation.handles.start);d===c.handles.length-1&&(!c.active||r.freehand||r.modifying||(a.lineTo(m.x,m.y),a.stroke()))}var p={fill:u};c.active&&(0,P.default)(a,t,r.mouseLocation.handles,i,p),(0,P.default)(a,t,c.handles,i,p),a.restore()}}}function g(e){T.external.$(e).off("CornerstoneToolsMouseDown",f),T.external.$(e).off("CornerstoneToolsMouseUp",l),T.external.$(e).off("CornerstoneToolsMouseMove",u),e.removeEventListener("cornerstoneimagerendered",d),e.addEventListener("cornerstoneimagerendered",d),T.external.cornerstone.updateImage(e)}function v(e){T.external.$(e).off("CornerstoneToolsMouseDown",f),T.external.$(e).off("CornerstoneToolsMouseUp",l),T.external.$(e).off("CornerstoneToolsMouseMove",u),e.removeEventListener("cornerstoneimagerendered",d),T.external.cornerstone.updateImage(e)}function h(e,t){var n={mouseButtonMask:t};T.external.$(e).off("CornerstoneToolsMouseDown",n,f),T.external.$(e).off("CornerstoneToolsMouseUp",l),T.external.$(e).off("CornerstoneToolsMouseMove",u),e.removeEventListener("cornerstoneimagerendered",d),e.addEventListener("cornerstoneimagerendered",d),T.external.$(e).on("CornerstoneToolsMouseDown",n,f),T.external.cornerstone.updateImage(e)}function m(e){T.external.$(e).off("CornerstoneToolsMouseDown",f),T.external.$(e).off("CornerstoneToolsMouseUp",l),T.external.$(e).off("CornerstoneToolsMouseMove",u),e.removeEventListener("cornerstoneimagerendered",d),e.addEventListener("cornerstoneimagerendered",d),T.external.cornerstone.updateImage(e)}function p(){return O}function x(e){O=e}Object.defineProperty(t,"__esModule",{value:!0}),t.freehand=void 0;var T=n(0),y=n(5),b=o(y),C=n(4),M=o(C),w=n(8),P=o(w),_=n(2),S=o(_),I=n(1),k="freehand",O={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},freehand:!1,modifying:!1,currentHandle:0,currentTool:-1},$={enable:g,disable:v,activate:h,deactivate:m,getConfiguration:p,setConfiguration:x};t.freehand=$},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=(0,T.getToolState)(e.event.currentTarget,y);if(!(t&&t.data&&t.data.length>0)){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}}function a(e,t,n){var o=u.external.cornerstone,r=o.pixelToCanvas(e,t.handles.start),a=o.pixelToCanvas(e,t.handles.end),i={left:Math.min(r.x,a.x),top:Math.min(r.y,a.y),width:Math.abs(r.x-a.x),height:Math.abs(r.y-a.y)},l=!1;return n.x>=i.left&&n.x<=i.left+i.width&&n.y>=i.top&&n.y<=i.top+i.height&&(l=!0),l}function i(e,t,n){var o=u.external.cornerstone,r=o.pixelToCanvas(e,t.handles.start),a=o.pixelToCanvas(e,t.handles.end),i={left:Math.min(r.x,a.x),top:Math.min(r.y,a.y),width:Math.abs(r.x-a.x),height:Math.abs(r.y-a.y)};return u.cornerstoneMath.rect.distanceToPoint(i,n)<5}function l(e,t){var n=(0,T.getToolState)(e.currentTarget,y);if(void 0!==n){var o=u.external.cornerstone,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);var a=void 0,i=v.default.getToolWidth();r.save();var l=n.data[0];if(l){a=l.active?m.default.getActiveColor():m.default.getToolColor();var s=o.pixelToCanvas(t.element,l.handles.start),c=o.pixelToCanvas(t.element,l.handles.end),f={left:Math.min(s.x,c.x),top:Math.min(s.y,c.y),width:Math.abs(s.x-c.x),height:Math.abs(s.y-c.y)};r.beginPath(),r.strokeStyle="transparent",r.rect(0,0,r.canvas.clientWidth,r.canvas.clientHeight),r.rect(f.width+f.left,f.top,-f.width,f.height),r.stroke(),r.fillStyle="rgba(0,0,0,0.7)",r.fill(),r.closePath(),r.beginPath(),r.strokeStyle=a,r.lineWidth=i,r.setLineDash([4]),r.strokeRect(f.left,f.top,f.width,f.height),r.setLineDash([]),(0,x.default)(r,t,l.handles,a),r.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.highlightTouch=t.highlight=void 0;var u=n(0),s=n(55),c=o(s),f=n(9),d=o(f),g=n(5),v=o(g),h=n(4),m=o(h),p=n(8),x=o(p),T=n(1),y="highlight",b=(0,c.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,pointInsideRect:a,toolType:y},!0),C=(0,d.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,pointInsideRect:a,toolType:y},!0);t.highlight=b,t.highlightTouch=C},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=t.image,o=n.stats,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);var a=[];Object.keys(o).forEach(function(e){var t=e+" : "+o[e];a.push(t)}),(0,u.default)(r,a,0,0,"orange"),a.forEach(function(e){console.log(e)})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(23),i=o(a),l=n(6),u=o(l),s=(0,i.default)(r);t.default=s},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function a(e,t,n){var o=l.external.cornerstone,r={start:o.pixelToCanvas(e,t.handles.start),end:o.pixelToCanvas(e,t.handles.end)};return l.cornerstoneMath.lineSegment.distanceToPoint(r,n)<25}function i(e,t){var n=(0,y.getToolState)(e.currentTarget,b);if(n){var o=l.external.cornerstone,r=t.canvasContext.canvas.getContext("2d"),a=t.image,i=t.element;r.setTransform(1,0,0,1,0,0);var u=h.default.getToolWidth(),s=C.getConfiguration(),c=o.metaData.get("imagePlaneModule",a.imageId),f=void 0,d=void 0;c?(f=c.rowPixelSpacing||c.rowImagePixelSpacing,d=c.columnPixelSpacing||c.colImagePixelSpacing):(f=a.rowPixelSpacing,d=a.columnPixelSpacing);for(var v=0;v<n.data.length;v++){r.save(),s&&s.shadow&&(r.shadowColor=s.shadowColor||"#000000",r.shadowOffsetX=s.shadowOffsetX||1,r.shadowOffsetY=s.shadowOffsetY||1);var m=n.data[v],x=p.default.getColorIfActive(m.active),M=o.pixelToCanvas(i,m.handles.start),w=o.pixelToCanvas(i,m.handles.end);r.beginPath(),r.strokeStyle=x,r.lineWidth=u,r.moveTo(M.x,M.y),r.lineTo(w.x,w.y),r.stroke();var P={drawHandlesIfActive:s&&s.drawHandlesOnHover};(0,T.default)(r,t,m.handles,x,P),r.fillStyle=x;var _=(m.handles.end.x-m.handles.start.x)*(f||1),S=(m.handles.end.y-m.handles.start.y)*(d||1),I=Math.sqrt(_*_+S*S);m.length=I;var k=" mm";f&&d||(k=" pixels");var O=""+I.toFixed(2)+k;if(!m.handles.textBox.hasMoved){var $={x:Math.max(m.handles.start.x,m.handles.end.x)};$.x===m.handles.start.x?$.y=m.handles.start.y:$.y=m.handles.end.y,m.handles.textBox.x=$.x,m.handles.textBox.y=$.y}var D=o.pixelToCanvas(t.element,m.handles.textBox);D.x+=10;var j={centering:{x:!1,y:!0}},E=(0,g.default)(r,O,D.x,D.y,x,j);if(m.handles.textBox.boundingBox=E,m.handles.textBox.hasMoved){var A={start:{},end:{}},R={x:(M.x+w.x)/2,y:(M.y+w.y)/2},L=[M,w,R];A.end.x=D.x,A.end.y=D.y,A.start=l.cornerstoneMath.point.findClosestPoint(L,A.end);var B=[{x:E.left+E.width/2,y:E.top},{x:E.left,y:E.top+E.height/2},{x:E.left+E.width/2,y:E.top+E.height},{x:E.left+E.width,y:E.top+E.height/2}];A.end=l.cornerstoneMath.point.findClosestPoint(B,A.start),r.beginPath(),r.strokeStyle=x,r.lineWidth=u,r.setLineDash([2,3]),r.moveTo(A.start.x,A.start.y),r.lineTo(A.end.x,A.end.y),r.stroke()}r.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthTouch=t.length=void 0;var l=n(0),u=n(7),s=o(u),c=n(9),f=o(c),d=n(6),g=o(d),v=n(5),h=o(v),m=n(4),p=o(m),x=n(8),T=o(x),y=n(1),b="length",C=(0,s.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:a,toolType:b}),M=(0,f.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:a,toolType:b});t.length=C,t.lengthTouch=M},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=t.element;x.external.$(n).off("CornerstoneToolsMouseDrag",s),x.external.$(n).off("CornerstoneToolsMouseUp",r),x.external.$(n).off("CornerstoneToolsMouseClick",r),n.removeEventListener("cornerstonenewimage",l),a(t)}function a(e){x.external.$(e.element).find(".magnifyTool").hide(),document.body.style.cursor="default"}function i(e,t){var n=t.element;if((0,M.default)(t.which,e.data.mouseButtonMask))return x.external.$(n).on("CornerstoneToolsMouseDrag",t,s),x.external.$(n).on("CornerstoneToolsMouseUp",t,r),x.external.$(n).on("CornerstoneToolsMouseClick",t,r),_=t.currentPoints,n.addEventListener("cornerstonenewimage",l),c(t),!1}function l(e){var t=e.detail;t.currentPoints=_,c(t)}function u(e,t){var n=t.element;x.external.$(t.element).off("CornerstoneToolsDragEnd",u),x.external.$(t.element).off("CornerstoneToolsTouchEnd",u),n.removeEventListener("cornerstonenewimage",l),a(t)}function s(e,t){return _=t.currentPoints,c(t),!0===t.isTouchEvent&&(x.external.$(t.element).on("CornerstoneToolsDragEnd",u),x.external.$(t.element).on("CornerstoneToolsTouchEnd",u)),!1}function c(e){var t=x.external.$(e.element).find(".magnifyTool").get(0);t||f(e.element);var n=S.getConfiguration(),o=n.magnifySize,r=n.magnificationLevel,a=x.external.$(e.element).find("canvas").not(".magnifyTool").get(0);a.getContext("2d").setTransform(1,0,0,1,0,0);var i=t.getContext("2d");i.setTransform(1,0,0,1,0,0);var l=o/r,u=x.external.cornerstone.pixelToCanvas(e.element,e.currentPoints.image);!0===e.isTouchEvent&&(u.y-=1.25*l),u.x=Math.max(u.x,0),u.x=Math.min(u.x,a.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,a.height),i.clearRect(0,0,o,o),i.fillStyle="transparent",i.fillRect(0,0,o,o);var s={x:u.x-.5*l,y:u.y-.5*l};"Safari"===P&&(s.x=Math.max(s.x,0),s.y=Math.max(s.y,0)),s.x=Math.min(s.x,a.width),s.y=Math.min(s.y,a.height);var c={x:(a.width-s.x)*r,y:(a.height-s.y)*r};i.drawImage(a,s.x,s.y,a.width-s.x,a.height-s.y,0,0,c.x,c.y),t.style.top=u.y-.5*o+"px",t.style.left=u.x-.5*o+"px",t.style.display="block",document.body.style.cursor="none"}function f(e){if(0===x.external.$(e).find(".magnifyTool").length){var t=document.createElement("canvas");t.classList.add("magnifyTool");var n=S.getConfiguration();t.width=n.magnifySize,t.height=n.magnifySize,t.style.position="absolute",e.appendChild(t)}}function d(e){x.external.$(e).find(".magnifyTool").remove()}function g(e){x.external.$(e).off("CornerstoneToolsMouseDown",i),d(e)}function v(e){if(!P){var t=(0,b.getBrowserInfo)(),n=t.split(" ");P=n[0]}f(e)}function h(e,t){var n={mouseButtonMask:t};x.external.$(e).off("CornerstoneToolsMouseDown",i),x.external.$(e).on("CornerstoneToolsMouseDown",n,i),f(e)}function m(){return w}function p(e){w=e}Object.defineProperty(t,"__esModule",{value:!0}),t.magnifyTouchDrag=t.magnify=void 0;var x=n(0),T=n(11),y=o(T),b=n(19),C=n(2),M=o(C),w={magnifySize:100,magnificationLevel:2},P=void 0,_=void 0,S={enable:v,activate:h,deactivate:g,disable:g,getConfiguration:m,setConfiguration:p},I={fireOnTouchStart:!0,activateCallback:f,disableCallback:d},k=(0,y.default)(s,I);t.magnify=S,t.magnifyTouchDrag=k},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=l.external.cornerstone,n=t.getEnabledElement(e),o=t.metaData.get("imagePlaneModule",n.image.imageId);if(o&&o.rowCosines&&o.columnCosines){var r=s.default.getOrientationString(o.rowCosines),a=s.default.getOrientationString(o.columnCosines),i=s.default.invertOrientationString(r);return{top:s.default.invertOrientationString(a),bottom:a,left:i,right:r}}}function a(e){var t=l.external.cornerstone,n=t.getEnabledElement(e),o=void 0;o={x:n.image.width/2,y:5};var r=t.pixelToCanvas(e,o);o={x:n.image.width/2,y:n.image.height-5};var a=t.pixelToCanvas(e,o);o={x:5,y:n.image.height/2};var i=t.pixelToCanvas(e,o);return o={x:n.image.width-10,y:n.image.height/2},{top:r,bottom:a,left:i,right:t.pixelToCanvas(e,o)}}function i(e,t){var n=t.element,o=r(n);if(o){var i=a(n,o),l=t.canvasContext.canvas.getContext("2d");l.setTransform(1,0,0,1,0,0);var u=g.default.getToolColor(),s={top:l.measureText(o.top).width,left:l.measureText(o.left).width,right:l.measureText(o.right).width,bottom:l.measureText(o.bottom).width};(0,h.default)(l,o.top,i.top.x-s.top/2,i.top.y,u),(0,h.default)(l,o.left,i.left.x-s.left/2,i.left.y,u);var c=m.getConfiguration();c&&c.drawAllMarkers&&((0,h.default)(l,o.right,i.right.x-s.right/2,i.right.y,u),(0,h.default)(l,o.bottom,i.bottom.x-s.bottom/2,i.bottom.y,u))}}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),u=n(41),s=o(u),c=n(23),f=o(c),d=n(4),g=o(d),v=n(6),h=o(v),m=(0,f.default)(i);t.default=m},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){l.external.$(t.element).off("CornerstoneToolsMouseDrag",i),l.external.$(t.element).off("CornerstoneToolsMouseUp",r),l.external.$(t.element).off("CornerstoneToolsMouseClick",r)}function a(e,t){if((0,g.default)(t.which,e.data.mouseButtonMask))return l.external.$(t.element).on("CornerstoneToolsMouseDrag",i),l.external.$(t.element).on("CornerstoneToolsMouseUp",r),l.external.$(t.element).on("CornerstoneToolsMouseClick",r),!1}function i(e,t){var n=t.viewport.scale,o=t.viewport.scale;return t.image.rowPixelSpacing<t.image.columnPixelSpacing?n*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(o*=t.image.rowPixelSpacing/t.image.columnPixelSpacing),t.viewport.translation.x+=t.deltaPoints.page.x/n,t.viewport.translation.y+=t.deltaPoints.page.y/o,l.external.cornerstone.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.panTouchDrag=t.pan=void 0;var l=n(0),u=n(13),s=o(u),c=n(11),f=o(c),d=n(2),g=o(d),v=(0,s.default)(a),h=(0,f.default)(i);t.pan=v,t.panTouchDrag=h},function(e,t,n){"use strict";function o(e,t){var n=u.getConfiguration();if(n&&n.testPointers(t))return t.viewport.translation.x+=t.deltaPoints.page.x/t.viewport.scale,t.viewport.translation.y+=t.deltaPoints.page.y/t.viewport.scale,r.external.cornerstone.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(28),i=function(e){return e&&e.__esModule?e:{default:e}}(a),l={testPointers:function(e){return e.numPointers>=2}},u=(0,i.default)(o);u.setConfiguration(l),t.default=u},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function a(e,t,n){var o=l.external.cornerstone.pixelToCanvas(e,t.handles.end);return l.cornerstoneMath.point.distance(o,n)<5}function i(e,t){var n=(0,w.getToolState)(e.currentTarget,P);if(n){var o=l.external.cornerstone,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var a=void 0,i=h.default.getFont(),u=h.default.getFontSize(),s=0;s<n.data.length;s++){r.save();var c=n.data[s];a=c.active?g.default.getActiveColor():g.default.getToolColor(),(0,p.default)(r,t,c.handles,a);var f=Math.round(c.handles.end.x),d=Math.round(c.handles.end.y),v=void 0,m=void 0,x=void 0;if(f<0||d<0||f>=t.image.columns||d>=t.image.rows)return;if(t.image.color)m=f+", "+d,v=(0,b.default)(t.element,f,d,1,1),x="R: "+v[0]+" G: "+v[1]+" B: "+v[2];else{v=o.getStoredPixels(t.element,f,d,1,1);var y=v[0],C=y*t.image.slope+t.image.intercept,_=(0,M.default)(t.image,y);m=f+", "+d,x="SP: "+y+" MO: "+parseFloat(C.toFixed(3)),_&&(x+=" SUV: "+parseFloat(_.toFixed(3)))}var S={x:c.handles.end.x+3,y:c.handles.end.y-3},I=o.pixelToCanvas(t.element,S);r.font=i,r.fillStyle=a,(0,T.default)(r,x,I.x,I.y+u+5,a),(0,T.default)(r,m,I.x,I.y,a),r.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.probeTouch=t.probe=void 0;var l=n(0),u=n(7),s=o(u),c=n(9),f=o(c),d=n(4),g=o(d),v=n(14),h=o(v),m=n(8),p=o(m),x=n(6),T=o(x),y=n(33),b=o(y),C=n(17),M=o(C),w=n(1),P="probe",_=(0,s.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:a,toolType:P}),S=(0,f.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:a,toolType:P});t.probe=_,t.probeTouch=S},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function a(e,t,n){var o=s.external.cornerstone,r=o.pixelToCanvas(e,t.handles.start),a=o.pixelToCanvas(e,t.handles.end),i={left:Math.min(r.x,a.x),top:Math.min(r.y,a.y),width:Math.abs(r.x-a.x),height:Math.abs(r.y-a.y)};return s.cornerstoneMath.rect.distanceToPoint(i,n)<5}function i(e,t){for(var n=0,o=0,r=0,a=0,i=t.top;i<t.top+t.height;i++)for(var l=t.left;l<t.left+t.width;l++)n+=e[a],o+=e[a]*e[a],r++,a++;if(0===r)return{count:r,mean:0,variance:0,stdDev:0};var u=n/r,s=o/r-u*u;return{count:r,mean:u,variance:s,stdDev:Math.sqrt(s)}}function l(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function u(e,t){var n=(0,w.getToolState)(e.currentTarget,P);if(n){var o=s.external.cornerstone,r=t.image,a=t.element,u=h.default.getToolWidth(),c=_.getConfiguration(),f=t.canvasContext.canvas.getContext("2d"),d=o.metaData.get("generalSeriesModule",r.imageId),g=void 0;d&&(g=d.modality),f.setTransform(1,0,0,1,0,0);for(var v=0;v<n.data.length;v++){f.save();var m=n.data[v];c&&c.shadow&&(f.shadowColor=c.shadowColor||"#000000",f.shadowOffsetX=c.shadowOffsetX||1,f.shadowOffsetY=c.shadowOffsetY||1);var x=p.default.getColorIfActive(m.active),y=o.pixelToCanvas(a,m.handles.start),C=o.pixelToCanvas(a,m.handles.end),S=Math.min(y.x,C.x),I=Math.min(y.y,C.y),k=Math.abs(y.x-C.x),O=Math.abs(y.y-C.y);if(f.beginPath(),f.strokeStyle=x,f.lineWidth=u,f.rect(S,I,k,O),f.stroke(),c&&c.drawHandlesOnHover)if(!0===m.active)(0,T.default)(f,t,m.handles,x);else{var $={drawHandlesIfActive:!0};(0,T.default)(f,t,m.handles,x,$)}else(0,T.default)(f,t,m.handles,x);var D=void 0,j=void 0,E=void 0;if(!1===m.invalidated)j=m.meanStdDev,E=m.meanStdDevSUV,D=m.area;else{var A={left:Math.min(m.handles.start.x,m.handles.end.x),top:Math.min(m.handles.start.y,m.handles.end.y),width:Math.abs(m.handles.start.x-m.handles.end.x),height:Math.abs(m.handles.start.y-m.handles.end.y)};if(!r.color){j=i(o.getPixels(a,A.left,A.top,A.width,A.height),A),"PT"===g&&(E={mean:(0,M.default)(r,(j.mean-r.intercept)/r.slope),stdDev:(0,M.default)(r,(j.stdDev-r.intercept)/r.slope)}),j&&!isNaN(j.mean)&&(m.meanStdDev=j,m.meanStdDevSUV=E)}D=A.width*(r.columnPixelSpacing||1)*(A.height*(r.rowPixelSpacing||1)),isNaN(D)||(m.area=D),m.invalidated=!1}var R=[];if(j&&j.mean){var L="";"CT"===g&&(L=" HU");var B="Mean: "+l(j.mean.toFixed(2))+L,N="StdDev: "+l(j.stdDev.toFixed(2))+L;if(E&&void 0!==E.mean){B+=" SUV: "+l(E.mean.toFixed(2)),N+=" SUV: "+l(E.stdDev.toFixed(2))}R.push(B),R.push(N)}if(D){var U=" mm"+String.fromCharCode(178);r.rowPixelSpacing&&r.columnPixelSpacing||(U=" pixels"+String.fromCharCode(178));var z="Area: "+l(D.toFixed(2))+U;R.push(z)}m.handles.textBox.hasMoved||(m.handles.textBox.x=Math.max(m.handles.start.x,m.handles.end.x),m.handles.textBox.y=(m.handles.start.y+m.handles.end.y)/2);var V=o.pixelToCanvas(a,m.handles.textBox),W={centering:{x:!1,y:!0}},H=(0,b.default)(f,R,V.x,V.y,x,W);if(m.handles.textBox.boundingBox=H,m.handles.textBox.hasMoved){var F={start:{},end:{x:V.x,y:V.y}},Y=[{x:S+k/2,y:I},{x:S,y:I+O/2},{x:S+k/2,y:I+O},{x:S+k,y:I+O/2}];F.start=s.cornerstoneMath.point.findClosestPoint(Y,F.end);var q=[{x:H.left+H.width/2,y:H.top},{x:H.left,y:H.top+H.height/2},{x:H.left+H.width/2,y:H.top+H.height},{x:H.left+H.width,y:H.top+H.height/2}];F.end=s.cornerstoneMath.point.findClosestPoint(q,F.start),f.beginPath(),f.strokeStyle=x,f.lineWidth=u,f.setLineDash([2,3]),f.moveTo(F.start.x,F.start.y),f.lineTo(F.end.x,F.end.y),f.stroke()}f.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleRoiTouch=t.rectangleRoi=void 0;var s=n(0),c=n(7),f=o(c),d=n(9),g=o(d),v=n(5),h=o(v),m=n(4),p=o(m),x=n(8),T=o(x),y=n(6),b=o(y),C=n(17),M=o(C),w=n(1),P="rectangleRoi",_=(0,f.default)({createNewMeasurement:r,onImageRendered:u,pointNearTool:a,toolType:P}),S=(0,g.default)({createNewMeasurement:r,onImageRendered:u,pointNearTool:a,toolType:P});t.rectangleRoi=_,t.rectangleRoiTouch=S},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.element.getBoundingClientRect(e.element),n={x:e.currentPoints.client.x,y:e.currentPoints.client.y},o=e.element.clientWidth,r=e.element.clientHeight,a={x:n.x-t.left-o/2,y:-1*(n.y-t.top-r/2)},i=Math.atan2(a.y,a.x),l=i*(180/Math.PI),u=-1*l+90;e.viewport.rotation=u,c.external.cornerstone.setViewport(e.element,e.viewport)}function a(e){e.viewport.rotation+=e.deltaPoints.page.x/e.viewport.scale,c.external.cornerstone.setViewport(e.element,e.viewport)}function i(e){e.viewport.rotation+=e.deltaPoints.page.y/e.viewport.scale,c.external.cornerstone.setViewport(e.element,e.viewport)}function l(e,t){c.external.$(t.element).off("CornerstoneToolsMouseDrag",s),c.external.$(t.element).off("CornerstoneToolsMouseUp",l),c.external.$(t.element).off("CornerstoneToolsMouseClick",l)}function u(e,t){if((0,m.default)(t.which,e.data.mouseButtonMask))return c.external.$(t.element).on("CornerstoneToolsMouseDrag",s),c.external.$(t.element).on("CornerstoneToolsMouseUp",l),c.external.$(t.element).on("CornerstoneToolsMouseClick",l),!1}function s(e,t){return p.strategy(t),c.external.cornerstone.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.rotateTouchDrag=t.rotate=void 0;var c=n(0),f=n(13),d=o(f),g=n(11),v=o(g),h=n(2),m=o(h),p=(0,d.default)(u);p.strategies={default:r,horizontal:a,vertical:i},p.strategy=r;var x=(0,v.default)(s);t.rotate=p,t.rotateTouchDrag=x},function(e,t,n){"use strict";function o(e,t){return t.viewport.rotation+=t.rotation,i.external.cornerstone.setViewport(t.element,t.viewport),!1}function r(e){i.external.$(e).off("CornerstoneToolsTouchRotate",o)}function a(e){i.external.$(e).off("CornerstoneToolsTouchRotate",o),i.external.$(e).on("CornerstoneToolsTouchRotate",o)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),l={activate:a,disable:r};t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n=n||"image/png";var r=o.external.$(e).find("canvas").get(0),a=document.createElement("a");if(a.download=t,a.href=r.toDataURL(n),document.createEvent){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(i)}else a.fireEvent&&a.fireEvent("onclick")};var o=n(0)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){e(prompt("Enter your annotation:"))}function a(e,t,n){n(prompt("Change your annotation:"))}function i(e){function t(e){null===e?(0,B.removeToolState)(o,N,a):a.text=e,a.active=!1,n.updateImage(o)}var n=g.external.cornerstone,o=e.element,r=z.getConfiguration(),a=l(e);(0,B.addToolState)(o,N,a),n.updateImage(o),(0,k.default)(e,N,a,a.handles.end,function(){(0,S.default)(e,a.handles)&&(0,B.removeToolState)(o,N,a),void 0===a.text&&r.getTextCallback(t),n.updateImage(o)})}function l(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function u(e,t,n){if(t.handles.end){var o=g.external.cornerstone.pixelToCanvas(e,t.handles.end);return g.cornerstoneMath.point.distance(o,n)<25}}function s(e,t){var n=(0,B.getToolState)(e.currentTarget,N);if(n){var o=g.external.cornerstone,r=t.enabledElement,a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var i=t.canvasContext.canvas.width,l=void 0,u=M.default.getToolWidth(),s=b.default.getFont(),c=z.getConfiguration(),f=0;f<n.data.length;f++){a.save(),c&&c.shadow&&(a.shadowColor=c.shadowColor||"#000000",a.shadowOffsetX=c.shadowOffsetX||1,a.shadowOffsetY=c.shadowOffsetY||1);var d=n.data[f];l=d.active?P.default.getActiveColor():P.default.getToolColor();var v=o.pixelToCanvas(t.element,d.handles.end);(0,j.default)(a,v,l,u);var h={drawHandlesIfActive:c&&c.drawHandlesOnHover};if(c.drawHandles&&(0,$.default)(a,t,v,l,h),d.text&&""!==d.text){a.font=s;var m="";m=c.showCoordinates?d.text+" x: "+Math.round(d.handles.end.x)+" y: "+Math.round(d.handles.end.y):d.text;var p=a.measureText(m).width+10,x=b.default.getFontSize()+10,y=Math.max(p,x)/2+5;v.x>i/2&&(y=-y);var C=void 0;if(!d.handles.textBox.hasMoved){C={x:v.x-p/2+y,y:v.y-x/2};var w=o.internal.getTransform(r);w.invert();var _=w.transformPoint(C.x,C.y);d.handles.textBox.x=_.x,d.handles.textBox.y=_.y}C=o.pixelToCanvas(t.element,d.handles.textBox);var S=(0,T.default)(a,m,C.x,C.y,l);if(d.handles.textBox.boundingBox=S,d.handles.textBox.hasMoved){var I={start:{},end:{}};I.end.x=C.x,I.end.y=C.y,I.start=v;var k=[{x:S.left+S.width/2,y:S.top},{x:S.left,y:S.top+S.height/2},{x:S.left+S.width/2,y:S.top+S.height},{x:S.left+S.width,y:S.top+S.height/2}];I.end=g.cornerstoneMath.point.findClosestPoint(k,I.start),a.beginPath(),a.strokeStyle=l,a.lineWidth=u,a.setLineDash([2,3]),a.moveTo(I.start.x,I.start.y),a.lineTo(I.end.x,I.end.y),a.stroke()}}a.restore()}}}function c(e){function t(e){null===e?(0,B.removeToolState)(o,N,a):a.text=e,a.active=!1,n.updateImage(o)}var n=g.external.cornerstone,o=e.element,r=z.getConfiguration(),a=l(e);(0,B.addToolState)(o,N,a),n.updateImage(o),(0,k.default)(e,N,a,a.handles.end,function(){(0,S.default)(e,a.handles)&&(0,B.removeToolState)(o,N,a),void 0===a.text&&r.getTextCallback(t),n.updateImage(o)})}function f(e,t){function n(e,t,n){!0===n?(0,B.removeToolState)(r,N,e):e.text=t,e.active=!1,o.updateImage(r)}var o=g.external.cornerstone,r=t.element,a=void 0;if(!e.data||!e.data.mouseButtonMask||(0,A.default)(t.which,e.data.mouseButtonMask)){var i=z.getConfiguration(),l=t.currentPoints.canvas,s=(0,B.getToolState)(r,N);if(s){for(var c=0;c<s.data.length;c++)if(a=s.data[c],u(r,a,l)||(0,L.default)(a.handles.textBox,l))return a.active=!0,o.updateImage(r),i.changeTextCallback(a,t,n),e.stopImmediatePropagation(),!1;return!1}}}function d(e,t){function n(e,t,n){console.log("pressCallback doneChangingTextCallback"),!0===n?(0,B.removeToolState)(r,N,e):e.text=t,e.active=!1,o.updateImage(r),g.external.$(r).on("CornerstoneToolsTouchStart",V.touchStartCallback),g.external.$(r).on("CornerstoneToolsTouchStartActive",V.touchDownActivateCallback),g.external.$(r).on("CornerstoneToolsTap",V.tapCallback)}var o=g.external.cornerstone,r=t.element,a=void 0;if(e.data&&e.data.mouseButtonMask&&!(0,A.default)(t.which,e.data.mouseButtonMask))return!1;var i=z.getConfiguration(),l=t.currentPoints.canvas,s=(0,B.getToolState)(r,N);if(!s)return!1;if(t.handlePressed)return g.external.$(r).off("CornerstoneToolsTouchStart",V.touchStartCallback),g.external.$(r).off("CornerstoneToolsTouchStartActive",V.touchDownActivateCallback),g.external.$(r).off("CornerstoneToolsTap",V.tapCallback),i.changeTextCallback(t.handlePressed,t,n),e.stopImmediatePropagation(),!1;for(var c=0;c<s.data.length;c++)if(a=s.data[c],u(r,a,l)||(0,L.default)(a.handles.textBox,l))return a.active=!0,o.updateImage(r),g.external.$(r).off("CornerstoneToolsTouchStart",V.touchStartCallback),g.external.$(r).off("CornerstoneToolsTouchStartActive",V.touchDownActivateCallback),g.external.$(r).off("CornerstoneToolsTap",V.tapCallback),i.changeTextCallback(a,t,n),e.stopImmediatePropagation(),!1;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.seedAnnotateTouch=t.seedAnnotate=void 0;var g=n(0),v=n(7),h=o(v),m=n(9),p=o(m),x=n(6),T=o(x),y=n(14),b=o(y),C=n(5),M=o(C),w=n(4),P=o(w),_=n(12),S=o(_),I=n(21),k=o(I),O=n(8),$=o(O),D=n(47),j=o(D),E=n(2),A=o(E),R=n(16),L=o(R),B=n(1),N="seedAnnotate",U={getTextCallback:r,changeTextCallback:a,drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0},z=(0,h.default)({addNewMeasurement:i,createNewMeasurement:l,onImageRendered:s,pointNearTool:u,toolType:N,mouseDoubleClickCallback:f});z.setConfiguration(U);var V=(0,p.default)({addNewMeasurement:c,createNewMeasurement:l,onImageRendered:s,pointNearTool:u,toolType:N,pressCallback:d});t.seedAnnotate=z,t.seedAnnotateTouch=V},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function a(e,t,n){var o=c.external.cornerstone,r={start:o.pixelToCanvas(e,t.handles.start),end:o.pixelToCanvas(e,t.handles.middle)},a=c.cornerstoneMath.lineSegment.distanceToPoint(r,n);return a<25||(r.start=o.pixelToCanvas(e,t.handles.middle),r.end=o.pixelToCanvas(e,t.handles.end),(a=c.cornerstoneMath.lineSegment.distanceToPoint(r,n))<25)}function i(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function l(e,t){var n=(0,j.getToolState)(e.currentTarget,E);if(n){var o=c.external.cornerstone,r=t.enabledElement,a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var l=void 0,u=y.default.getToolWidth(),s=x.default.getFont(),f=A.getConfiguration(),d=0;d<n.data.length;d++){a.save(),f&&f.shadow&&(a.shadowColor=f.shadowColor||"#000000",a.shadowOffsetX=f.shadowOffsetX||1,a.shadowOffsetY=f.shadowOffsetY||1);var g=n.data[d];l=g.active?C.default.getActiveColor():C.default.getToolColor();var h=o.pixelToCanvas(t.element,g.handles.start),p=o.pixelToCanvas(t.element,g.handles.middle),T=o.pixelToCanvas(t.element,g.handles.end);a.beginPath(),a.strokeStyle=l,a.lineWidth=u,a.moveTo(h.x,h.y),a.lineTo(p.x,p.y),a.lineTo(T.x,T.y),a.stroke();var b={drawHandlesIfActive:f&&f.drawHandlesOnHover};(0,O.default)(a,t,g.handles,l,b),a.fillStyle=l;var M=t.image.columnPixelSpacing||1,w=t.image.rowPixelSpacing||1,P="";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(P=" (isotropic)");var _={x:(Math.ceil(g.handles.middle.x)-Math.ceil(g.handles.start.x))*M,y:(Math.ceil(g.handles.middle.y)-Math.ceil(g.handles.start.y))*w},S={x:(Math.ceil(g.handles.end.x)-Math.ceil(g.handles.middle.x))*M,y:(Math.ceil(g.handles.end.y)-Math.ceil(g.handles.middle.y))*w},I={x:(Math.ceil(g.handles.end.x)-Math.ceil(g.handles.start.x))*M,y:(Math.ceil(g.handles.end.y)-Math.ceil(g.handles.start.y))*w},k=i(_),$=i(S),D=i(I),R=Math.acos((Math.pow(k,2)+Math.pow($,2)-Math.pow(D,2))/(2*k*$));R*=180/Math.PI;var L=(0,m.default)(R,2);if(L){var B=L.toString()+String.fromCharCode(parseInt("00B0",16))+P,N=void 0;if(g.handles.textBox.hasMoved)N=o.pixelToCanvas(t.element,g.handles.textBox);else{N={x:p.x,y:p.y},a.font=s;var U=a.measureText(B).width;p.x<h.x?N.x-=15+U+10:N.x+=15;var z=o.internal.getTransform(r);z.invert();var V=z.transformPoint(N.x,N.y);g.handles.textBox.x=V.x,g.handles.textBox.y=V.y}var W={centering:{x:!1,y:!0}},H=(0,v.default)(a,B,N.x,N.y,l,W);if(g.handles.textBox.boundingBox=H,g.handles.textBox.hasMoved){var F={start:{},end:{}},Y=[h,T,p];F.end.x=N.x,F.end.y=N.y,F.start=c.cornerstoneMath.point.findClosestPoint(Y,F.end);var q=[{x:H.left+H.width/2,y:H.top},{x:H.left,y:H.top+H.height/2},{x:H.left+H.width/2,y:H.top+H.height},{x:H.left+H.width,y:H.top+H.height/2}];F.end=c.cornerstoneMath.point.findClosestPoint(q,F.start),a.beginPath(),a.strokeStyle=l,a.lineWidth=u,a.setLineDash([2,3]),a.moveTo(F.start.x,F.start.y),a.lineTo(F.end.x,F.end.y),a.stroke()}}a.restore()}}}function u(e){var t=c.external.cornerstone,n=r(e),o=e.element,a={mouseButtonMask:e.which};(0,j.addToolState)(o,E,n),c.external.$(o).off("CornerstoneToolsMouseMove",A.mouseMoveCallback),c.external.$(o).off("CornerstoneToolsMouseDrag",A.mouseMoveCallback),c.external.$(o).off("CornerstoneToolsMouseDown",A.mouseDownCallback),c.external.$(o).off("CornerstoneToolsMouseDownActivate",A.mouseDownActivateCallback),t.updateImage(o),(0,_.default)(e,E,n,n.handles.middle,function(){if(n.active=!1,(0,w.default)(e,n.handles))return(0,j.removeToolState)(o,E,n),c.external.$(o).on("CornerstoneToolsMouseMove",A.mouseMoveCallback),c.external.$(o).on("CornerstoneToolsMouseDrag",A.mouseMoveCallback),c.external.$(o).on("CornerstoneToolsMouseDown",a,A.mouseDownCallback),c.external.$(o).on("CornerstoneToolsMouseDownActivate",a,A.mouseDownActivateCallback),void t.updateImage(o);n.handles.end.active=!0,t.updateImage(o),(0,_.default)(e,E,n,n.handles.end,function(){n.active=!1,(0,w.default)(e,n.handles)&&(0,j.removeToolState)(o,E,n),c.external.$(o).on("CornerstoneToolsMouseMove",A.mouseMoveCallback),c.external.$(o).on("CornerstoneToolsMouseDrag",A.mouseMoveCallback),c.external.$(o).on("CornerstoneToolsMouseDown",a,A.mouseDownCallback),c.external.$(o).on("CornerstoneToolsMouseDownActivate",a,A.mouseDownActivateCallback),t.updateImage(o)})})}function s(e){var t=c.external.cornerstone,n=r(e),o=e.element;(0,j.addToolState)(o,E,n),c.external.$(o).off("CornerstoneToolsTouchDrag",R.touchMoveCallback),c.external.$(o).off("CornerstoneToolsTouchStartActive",R.touchDownActivateCallback),c.external.$(o).off("CornerstoneToolsTouchStart",R.touchStartCallback),c.external.$(o).off("CornerstoneToolsTap",R.tapCallback),t.updateImage(o),(0,I.default)(e,E,n,n.handles.middle,function(){if((0,w.default)(e,n.handles))return(0,j.removeToolState)(o,E,n),c.external.$(o).on("CornerstoneToolsTouchDrag",R.touchMoveCallback),c.external.$(o).on("CornerstoneToolsTouchStart",R.touchStartCallback),c.external.$(o).on("CornerstoneToolsTouchStartActive",R.touchDownActivateCallback),c.external.$(o).on("CornerstoneToolsTap",R.tapCallback),void t.updateImage(o);(0,I.default)(e,E,n,n.handles.end,function(){(0,w.default)(e,n.handles)&&((0,j.removeToolState)(o,E,n),t.updateImage(o)),c.external.$(o).on("CornerstoneToolsTouchDrag",R.touchMoveCallback),c.external.$(o).on("CornerstoneToolsTouchStart",R.touchStartCallback),c.external.$(o).on("CornerstoneToolsTouchStartActive",R.touchDownActivateCallback),c.external.$(o).on("CornerstoneToolsTap",R.tapCallback)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAngleTouch=t.simpleAngle=void 0;var c=n(0),f=n(7),d=o(f),g=n(6),v=o(g),h=n(30),m=o(h),p=n(14),x=o(p),T=n(5),y=o(T),b=n(4),C=o(b),M=n(12),w=o(M),P=n(22),_=o(P),S=n(24),I=o(S),k=n(8),O=o(k),$=n(9),D=o($),j=n(1),E="simpleAngle",A=(0,d.default)({createNewMeasurement:r,addNewMeasurement:u,onImageRendered:l,pointNearTool:a,toolType:E}),R=(0,D.default)({createNewMeasurement:r,addNewMeasurement:s,onImageRendered:l,pointNearTool:a,toolType:E});t.simpleAngle=A,t.simpleAngleTouch=R},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=w.getConfiguration();if(t.current){var n={visible:!0,active:!0,text:t.current,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},o={left:0,top:0,width:e.image.width,height:e.image.height};if(s.cornerstoneMath.point.insideRect(n.handles.end,o)){var r=t.markers.indexOf(t.current);return t.ascending?(r+=1)>=t.markers.length&&(t.loop?r-=t.markers.length:r=-1):(r-=1)<0&&(t.loop?r+=t.markers.length:r=-1),t.current=t.markers[r],n}}}function a(e,t,n){if(t.handles.end.boundingBox){var o=s.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,n),r=(0,h.default)(t.handles.end,n);return o<10||r}}function i(e,t){var n=(0,C.getToolState)(t.element,M);if(n){var o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);for(var r=w.getConfiguration(),a=0;a<n.data.length;a++){var i=n.data[a],l=p.default.getToolColor();i.active&&(l=p.default.getActiveColor()),o.save(),r&&r.shadow&&(o.shadowColor=r.shadowColor||"#000000",o.shadowOffsetX=r.shadowOffsetX||1,o.shadowOffsetY=r.shadowOffsetY||1),o.fillStyle=l;var u=o.measureText(i.text);i.textWidth=u.width+10;var c=s.external.cornerstone.pixelToCanvas(t.element,i.handles.end),f={centering:{x:!0,y:!0}},d=(0,b.default)(o,i.text,c.x,c.y-10,l,f);i.handles.end.boundingBox=d,o.restore()}}}function l(e,t){function n(t,n,a){!0===a?(0,C.removeToolState)(r,M,t):t.text=n,t.active=!1,o.updateImage(r);var i={mouseButtonMask:e.data.mouseButtonMask};s.external.$(r).on("CornerstoneToolsMouseMove",i,w.mouseMoveCallback),s.external.$(r).on("CornerstoneToolsMouseDown",i,w.mouseDownCallback),s.external.$(r).on("CornerstoneToolsMouseDownActivate",i,w.mouseDownActivateCallback),s.external.$(r).on("CornerstoneToolsMouseDoubleClick",i,w.mouseDoubleClickCallback)}var o=s.external.cornerstone,r=t.element,i=void 0;if(!e.data||!e.data.mouseButtonMask||(0,T.default)(t.which,e.data.mouseButtonMask)){var l=w.getConfiguration(),u=t.currentPoints.canvas,c=(0,C.getToolState)(r,M);if(c){for(var f=0;f<c.data.length;f++)if(i=c.data[f],a(r,i,u))return i.active=!0,o.updateImage(r),s.external.$(r).off("CornerstoneToolsMouseMove",w.mouseMoveCallback),s.external.$(r).off("CornerstoneToolsMouseDown",w.mouseDownCallback),s.external.$(r).off("CornerstoneToolsMouseDownActivate",w.mouseDownActivateCallback),s.external.$(r).off("CornerstoneToolsMouseDoubleClick",w.mouseDoubleClickCallback),l.changeTextCallback(i,t,n),e.stopImmediatePropagation(),!1;return!1}}}function u(e,t){function n(e,t,n){!0===n?(0,C.removeToolState)(r,M,e):e.text=t,e.active=!1,o.updateImage(r),s.external.$(r).on("CornerstoneToolsTouchDrag",P.touchMoveCallback),s.external.$(r).on("CornerstoneToolsTouchStartActive",P.touchDownActivateCallback),s.external.$(r).on("CornerstoneToolsTouchStart",P.touchStartCallback),s.external.$(r).on("CornerstoneToolsTap",P.tapCallback),s.external.$(r).on("CornerstoneToolsTouchPress",P.pressCallback)}var o=s.external.cornerstone,r=t.element,i=void 0,l=w.getConfiguration(),u=t.currentPoints.canvas,c=(0,C.getToolState)(r,M);if(!c)return!1;if(t.handlePressed)return t.handlePressed.active=!0,o.updateImage(r),s.external.$(r).off("CornerstoneToolsTouchDrag",P.touchMoveCallback),s.external.$(r).off("CornerstoneToolsTouchStartActive",P.touchDownActivateCallback),s.external.$(r).off("CornerstoneToolsTouchStart",P.touchStartCallback),s.external.$(r).off("CornerstoneToolsTap",P.tapCallback),s.external.$(r).off("CornerstoneToolsTouchPress",P.pressCallback),l.changeTextCallback(t.handlePressed,t,n),e.stopImmediatePropagation(),!1;for(var f=0;f<c.data.length;f++)if(i=c.data[f],a(r,i,u))return i.active=!0,o.updateImage(r),s.external.$(r).off("CornerstoneToolsTouchDrag",P.touchMoveCallback),s.external.$(r).off("CornerstoneToolsTouchStartActive",P.touchDownActivateCallback),s.external.$(r).off("CornerstoneToolsTouchStart",P.touchStartCallback),s.external.$(r).off("CornerstoneToolsTap",P.tapCallback),s.external.$(r).off("CornerstoneToolsTouchPress",P.pressCallback),l.changeTextCallback(i,t,n),e.stopImmediatePropagation(),!1;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.textMarkerTouch=t.textMarker=void 0;var s=n(0),c=n(7),f=o(c),d=n(9),g=o(d),v=n(16),h=o(v),m=n(4),p=o(m),x=n(2),T=o(x),y=n(6),b=o(y),C=n(1),M="textMarker",w=(0,f.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:a,toolType:M,mouseDoubleClickCallback:l}),P=(0,g.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:a,toolType:M,pressCallback:u});t.textMarker=w,t.textMarkerTouch=P},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){s.external.$(t.element).off("CornerstoneToolsMouseDrag",l),s.external.$(t.element).off("CornerstoneToolsMouseUp",r),s.external.$(t.element).off("CornerstoneToolsMouseClick",r)}function a(e,t){if((0,h.default)(t.which,e.data.mouseButtonMask))return s.external.$(t.element).on("CornerstoneToolsMouseDrag",l),s.external.$(t.element).on("CornerstoneToolsMouseUp",r),s.external.$(t.element).on("CornerstoneToolsMouseClick",r),!1}function i(e){var t=e.image.maxPixelValue*e.image.slope+e.image.intercept,n=e.image.minPixelValue*e.image.slope+e.image.intercept,o=t-n,r=o/1024,a=e.deltaPoints.page.x*r,i=e.deltaPoints.page.y*r;e.viewport.voi.windowWidth+=a,e.viewport.voi.windowCenter+=i}function l(e,t){return m.strategy(t),s.external.cornerstone.setViewport(t.element,t.viewport),!1}function u(e,t){e.stopImmediatePropagation();var n=t,o=n.image.maxPixelValue*n.image.slope+n.image.intercept,r=n.image.minPixelValue*n.image.slope+n.image.intercept,a=o-r,i=a/1024,l=n.deltaPoints.page.x*i,u=n.deltaPoints.page.y*i,c=m.getConfiguration();c.orientation?0===c.orientation?(n.viewport.voi.windowWidth+=l,n.viewport.voi.windowCenter+=u):(n.viewport.voi.windowWidth+=u,n.viewport.voi.windowCenter+=l):(n.viewport.voi.windowWidth+=l,n.viewport.voi.windowCenter+=u),s.external.cornerstone.setViewport(n.element,n.viewport)}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcTouchDrag=t.wwwc=void 0;var s=n(0),c=n(13),f=o(c),d=n(11),g=o(d),v=n(2),h=o(v),m=(0,f.default)(a);m.strategies={default:i},m.strategy=i;var p=(0,g.default)(u);t.wwwc=m,t.wwwcTouchDrag=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){var o=e.length;if(o<2)return{min:t,max:n,mean:(t+n)/2};for(var r=n,a=t,i=0,l=0;l<o;l++){var u=e[l];r=Math.min(r,u),a=Math.max(a,u),i+=u}return{min:r,max:a,mean:i/o}}function a(e){var t=e.detail,n=(0,w.getToolState)(t.element,k);n&&n.data&&(n.data=[]),T.external.$(t.element).off("CornerstoneToolsMouseMove",f),T.external.$(t.element).off("CornerstoneToolsMouseDrag",f),T.external.$(t.element).off("CornerstoneToolsMouseUp",i),T.external.$(t.element).off("CornerstoneToolsMouseClick",i);var o={mouseButtonMask:$};T.external.$(t.element).on("CornerstoneToolsMouseDown",o,s)}function i(e,t){T.external.$(t.element).off("CornerstoneToolsMouseMove",f),T.external.$(t.element).off("CornerstoneToolsMouseDrag",f),T.external.$(t.element).off("CornerstoneToolsMouseUp",i),T.external.$(t.element).off("CornerstoneToolsMouseClick",i);var n={mouseButtonMask:$};T.external.$(t.element).on("CornerstoneToolsMouseDown",n,s);var o=(0,w.getToolState)(t.element,k);o&&o.data&&o.data.length&&(o.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},l(t))}function l(e){var t=T.external.cornerstone,n=(0,w.getToolState)(e.element,k);if(n&&n.data&&n.data.length){var o=n.data[0].startPoint,a=n.data[0].endPoint,i=Math.abs(o.x-a.x),l=Math.abs(o.y-a.y),u=Math.min(o.x,a.x),s=Math.min(o.y,a.y);u=Math.max(u,0),u=Math.min(u,e.image.width),s=Math.max(s,0),s=Math.min(s,e.image.height),i=Math.floor(Math.min(i,Math.abs(e.image.width-u))),l=Math.floor(Math.min(l,Math.abs(e.image.height-s)));var c=(0,_.default)(e.element,u,s,i,l),f=r(c,e.image.minPixelValue,e.image.maxPixelValue),d=D.getConfiguration(),g=t.getViewport(e.element);void 0===d.minWindowWidth&&(d.minWindowWidth=10),g.voi.windowWidth=Math.max(Math.abs(f.max-f.min),d.minWindowWidth),g.voi.windowCenter=f.mean,t.setViewport(e.element,g),n.data=[],t.updateImage(e.element)}}function u(e,t){var n=t.element;T.external.$(n).off("CornerstoneToolsMouseMove"),T.external.$(n).off("CornerstoneToolsMouseDrag"),T.external.$(n).on("CornerstoneToolsMouseMove",f),T.external.$(n).on("CornerstoneToolsMouseDrag",f),T.external.$(n).on("CornerstoneToolsMouseClick",i),"CornerstoneToolsMouseDrag"===e.type&&T.external.$(n).on("CornerstoneToolsMouseUp",i)}function s(e,t){if((0,I.default)(t.which,e.data.mouseButtonMask))return T.external.$(t.element).on("CornerstoneToolsMouseDrag",t,u),T.external.$(t.element).on("CornerstoneToolsMouseMove",t,u),T.external.$(t.element).off("CornerstoneToolsMouseDown",s),c(t),!1}function c(e){var t=(0,w.getToolState)(e.element,k);t&&t.data&&(t.data=[]);var n={startPoint:{x:e.currentPoints.image.x,y:e.currentPoints.image.y}};(0,w.addToolState)(e.element,k,n)}function f(e,t){var n=(0,w.getToolState)(t.element,k);if(n&&n.data&&n.data.length){var o={x:t.currentPoints.image.x,y:t.currentPoints.image.y};n.data[0].endPoint=o,T.external.cornerstone.updateImage(t.element)}}function d(e){var t=e.detail,n=T.external.cornerstone,o=(0,w.getToolState)(t.element,k);if(o&&o.data&&o.data.length){var r=o.data[0].startPoint,a=o.data[0].endPoint;if(r&&a){var i=T.external.$(t.element).find("canvas").get(0),l=i.getContext("2d");l.setTransform(1,0,0,1,0,0);var u=M.default.getActiveColor(),s=n.pixelToCanvas(t.element,r),c=n.pixelToCanvas(t.element,a),f=Math.min(s.x,c.x),d=Math.min(s.y,c.y),g=Math.abs(s.x-c.x),v=Math.abs(s.y-c.y),h=b.default.getToolWidth(),m=D.getConfiguration();l.save(),m&&m.shadow&&(l.shadowColor=m.shadowColor||"#000000",l.shadowOffsetX=m.shadowOffsetX||1,l.shadowOffsetY=m.shadowOffsetY||1),l.beginPath(),l.strokeStyle=u,l.lineWidth=h,l.rect(f,d,g,v),l.stroke(),l.restore()}}}function g(e){T.external.$(e).off("CornerstoneToolsMouseDown",s),T.external.$(e).off("CornerstoneToolsMouseUp",i),T.external.$(e).off("CornerstoneToolsMouseClick",i),T.external.$(e).off("CornerstoneToolsMouseDrag",f),T.external.$(e).off("CornerstoneToolsMouseMove",f),e.removeEventListener("cornerstoneimagerendered",d),e.removeEventListener("cornerstonenewimage",a),T.external.cornerstone.updateImage(e)}function v(e,t){var n={mouseButtonMask:t};if($=t,!(0,w.getToolState)(e,k)){var o=[];(0,w.addToolState)(e,k,o)}T.external.$(e).off("CornerstoneToolsMouseDown",s),T.external.$(e).off("CornerstoneToolsMouseUp",i),T.external.$(e).off("CornerstoneToolsMouseClick",i),T.external.$(e).off("CornerstoneToolsMouseDrag",f),T.external.$(e).off("CornerstoneToolsMouseMove",f),e.removeEventListener("cornerstoneimagerendered",d),e.removeEventListener("cornerstonenewimage",a),T.external.$(e).on("CornerstoneToolsMouseDown",n,s),e.addEventListener("cornerstoneimagerendered",d),e.addEventListener("cornerstonenewimage",a),T.external.cornerstone.updateImage(e)}function h(e){T.external.$(e).off("CornerstoneToolsTouchDrag",f),T.external.$(e).off("CornerstoneToolsTouchStart",c),T.external.$(e).off("CornerstoneToolsDragEnd",l),e.removeEventListener("cornerstoneimagerendered",d)}function m(e){if(!(0,w.getToolState)(e,k)){var t=[];(0,w.addToolState)(e,k,t)}T.external.$(e).off("CornerstoneToolsTouchDrag",f),T.external.$(e).off("CornerstoneToolsTouchStart",c),T.external.$(e).off("CornerstoneToolsDragEnd",l),e.removeEventListener("cornerstoneimagerendered",d),T.external.$(e).on("CornerstoneToolsTouchDrag",f),T.external.$(e).on("CornerstoneToolsTouchStart",c),T.external.$(e).on("CornerstoneToolsDragEnd",l),e.addEventListener("cornerstoneimagerendered",d)}function p(){return O}function x(e){O=e}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcRegionTouch=t.wwwcRegion=void 0;var T=n(0),y=n(5),b=o(y),C=n(4),M=o(C),w=n(1),P=n(45),_=o(P),S=n(2),I=o(S),k="wwwcRegion",O={minWindowWidth:10},$=void 0,D={activate:v,deactivate:g,disable:g,setConfiguration:x,getConfiguration:p},j={activate:m,deactivate:h,disable:h};t.wwwcRegion=D,t.wwwcRegionTouch=j},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=S.getConfiguration(),o=Math.log(e.scale)/Math.log(1.7),r=o+t,a=Math.pow(1.7,r);return n.maxScale&&a>n.maxScale?e.scale=n.maxScale:n.minScale&&a<n.minScale?e.scale=n.minScale:e.scale=a,e}function a(e,t,n){return e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),e.x=Math.min(e.x,t),e.y=Math.min(e.y,n),e}function i(e,t){if(t.hflip&&(e.x*=-1),t.vflip&&(e.y*=-1),0!==t.rotation){var n=t.rotation*Math.PI/180,o=Math.cos(n),r=Math.sin(n),a=e.x*o-e.y*r,i=e.x*r+e.y*o;e.x=a,e.y=i}return e}function l(e,t){var n=h.external.cornerstone,o=e.element,a=r(e.viewport,t);n.setViewport(o,a);var l=n.pageToPixel(o,e.startPoints.page.x,e.startPoints.page.y),u={x:e.startPoints.image.x-l.x,y:e.startPoints.image.y-l.y};u=i(u,a),a.translation.x-=u.x,a.translation.y-=u.y,n.setViewport(o,a)}function u(e,t){var n=e.element,o=e.image,l=S.getConfiguration(),u=r(e.viewport,t),s={x:0,y:0};if(t<0)u.scale<3&&(Math.abs(u.translation.x)<.01?u.translation.x=0:s.x=u.translation.x/8,Math.abs(u.translation.y)<.01?u.translation.y=0:s.y=u.translation.y/8);else{l&&l.preventZoomOutsideImage&&(_.image=a(_.image,o.width,o.height));var c={x:o.width/2-_.image.x,y:o.height/2-_.image.y};c=i(c,u);var f={x:u.translation.x-c.x,y:u.translation.y-c.y};Math.abs(f.x)<.01?u.translation.x=c.x:s.x=f.x/8,Math.abs(f.y)<.01?u.translation.y=c.y:s.y=f.y/8}u.translation.x-=s.x,u.translation.y-=s.y,h.external.cornerstone.setViewport(n,u)}function s(e,t){var n=e.element,o=r(e.viewport,t);h.external.cornerstone.setViewport(n,o)}function c(e,t){h.external.$(t.element).off("CornerstoneToolsMouseDrag",d),h.external.$(t.element).off("CornerstoneToolsMouseUp",c),h.external.$(t.element).off("CornerstoneToolsMouseClick",c)}function f(e,t){if((0,T.default)(t.which,e.data.mouseButtonMask))return _=t.startPoints,h.external.$(t.element).on("CornerstoneToolsMouseDrag",d),h.external.$(t.element).on("CornerstoneToolsMouseUp",c),h.external.$(t.element).on("CornerstoneToolsMouseClick",c),!1}function d(e,t){if(!t.deltaPoints.page.y)return!1;var n=t.deltaPoints.page.y/100;return S.strategy(t,n),!1}function g(e,t){var n=-t.direction/4,o=S.getConfiguration();o&&o.invert&&(n*=-1);var a=r(t.viewport,n);h.external.cornerstone.setViewport(t.element,a)}function v(e,t){var n=h.external.cornerstone,o=S.getConfiguration(),r=t.viewport,a=t.element;r.scale+=t.scaleChange*r.scale,o.maxScale&&r.scale>o.maxScale?r.scale=o.maxScale:o.minScale&&r.scale<o.minScale&&(r.scale=o.minScale),n.setViewport(a,r);var l=n.pageToPixel(a,t.startPoints.page.x,t.startPoints.page.y),u={x:t.startPoints.image.x-l.x,y:t.startPoints.image.y-l.y};u=i(u,r),r.translation.x-=u.x,r.translation.y-=u.y,n.setViewport(a,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=void 0;var h=n(0),m=n(13),p=o(m),x=n(2),T=o(x),y=n(20),b=o(y),C=n(56),M=o(C),w=n(11),P=o(w),_=void 0,S=(0,p.default)(f);S.strategies={default:l,translate:u,zoomToCenter:s},S.strategy=l;var I=(0,b.default)(g),k=(0,M.default)(v),O=(0,P.default)(d);t.zoom=S,t.zoomWheel=I,t.zoomTouchPinch=k,t.zoomTouchDrag=O},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=b.getConfiguration(),n=e.element,o=c.external.cornerstone.getLayer(n,t.brushLayerId),r=o.image,a=r.rows,i=r.columns,l=e.currentPoints.image,u=l.x,s=l.y,d=(0,f.getToolState)(n,p),g=d.data[0].pixelData,v=t.draw,x=t.radius;if(!(u<0||u>i||s<0||s>a)){var T=(0,h.default)(x,a,i,u,s);(0,m.drawBrushPixels)(T,g,v,i),o.invalid=!0,c.external.cornerstone.updateImage(n)}}function a(e,t){T=t.currentPoints.image,y=!1}function i(e,t){r(t),y=!0,T=t.currentPoints.image}function l(e,t){T=t.currentPoints.image,c.external.cornerstone.updateImage(t.element)}function u(e,t){r(t),y=!0,T=t.currentPoints.image}function s(e,t){if(T){var n=t.image,o=n.rows,r=n.columns,a=T,i=a.x,l=a.y;if(!(i<0||i>r||l<0||l>o)){var u=b.getConfiguration(),s=u.radius,c=t.canvasContext,f=y?u.dragColor:u.hoverColor,d=t.element;c.setTransform(1,0,0,1,0,0);var g=(0,h.default)(s,o,r,i,l);(0,m.drawBrushOnCanvas)(g,c,f,d)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.brush=void 0;var c=n(0),f=n(1),d=n(57),g=o(d),v=n(58),h=o(v),m=n(59),p="brush",x={draw:1,radius:3,hoverColor:"green",dragColor:"yellow"},T=void 0,y=!1,b=(0,g.default)({onMouseMove:l,onMouseDown:i,onMouseUp:a,onDrag:u,toolType:"brush",onImageRendered:s});b.setConfiguration(x),t.brush=b},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){var o=S.getConfiguration(),r=o.tolerance,a=Number.MAX_VALUE,i=-Number.MAX_VALUE;e.forEach(function(e){var o=e[1]*n+e[0],r=t[o];a=Math.min(r,a),i=Math.max(r,i)}),w=a-r,M=i+r}function a(e,t,n,o){for(var r=S.getConfiguration(),a=r.draw,i=Math.round(C.x),l=Math.round(C.y),u=null,s=[],c=r.radius;0!==u&&c>r.minRadius;){u=0,s=(0,x.default)(c,n,o,i,l);for(var f=0;f<s.length;f++){var d=s[f][0],g=s[f][1],v=g*o+d,h=e[v];if(h>M||h<w){u++;break}}c--}return 0===u&&(0,T.drawBrushPixels)(s,t,a,o),c}function i(e){var t=S.getConfiguration(),n=e.element,o=g.external.cornerstone.getLayer(n,t.brushLayerId),r=g.external.cornerstone.getLayers(n)[0],i=o.image,l=i.rows,u=i.columns,s=(0,v.getToolState)(n,y),c=s.data[0];P=a(r.image.getPixelData(),c.pixelData,l,u),o.invalid=!0,g.external.cornerstone.updateImage(n)}function l(e){var t=S.getConfiguration(),n=e.element,o=g.external.cornerstone.getLayer(n,t.brushLayerId),r=o.image,a=r.rows,i=r.columns,l=e.currentPoints.image,u=l.x,s=l.y,c=(0,v.getToolState)(n,y),f=c.data[0].pixelData,d=t.draw,h=t.radius;if(!(u<0||u>i||s<0||s>a)){var m=(0,x.default)(h,a,i,u,s);(0,T.drawBrushPixels)(m,f,d,i),o.invalid=!0,g.external.cornerstone.updateImage(n)}}function u(e,t){C=t.currentPoints.image;var n=S.getConfiguration();_=!1,P=n.radius,g.external.cornerstone.updateImage(t.element)}function s(e,t){var n=t.element,o=S.getConfiguration(),a=g.external.cornerstone.getLayer(n,o.brushLayerId),u=g.external.cornerstone.getLayers(n)[0],s=t.currentPoints.image,c=s.x,f=s.y,d=a.image,v=d.rows,h=d.columns,m=(0,x.default)(o.radius,v,h,c,f);0===o.draw?l(t):(r(m,u.image.getPixelData(),h),i(t)),_=!0,C=t.currentPoints.image}function c(e,t){C=t.currentPoints.image,g.external.cornerstone.updateImage(t.element)}function f(e,t){0===b.draw?l(t):i(t),_=!0,C=t.currentPoints.image}function d(e,t){if(C){var n=t.image,o=n.rows,r=n.columns,a=C,i=a.x,l=a.y;if(!(i<0||i>r||l<0||l>o)){var u=S.getConfiguration(),s=t.canvasContext,c=_?u.dragColor:u.hoverColor,f=t.element;P=P||u.radius,s.setTransform(1,0,0,1,0,0);var d=(0,x.default)(P,o,r,i,l);(0,T.drawBrushOnCanvas)(d,s,c,f)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.adaptiveBrush=void 0;var g=n(0),v=n(1),h=n(57),m=o(h),p=n(58),x=o(p),T=n(59),y="brush",b={draw:1,radius:3,tolerance:5,minRadius:1,hoverColor:"green",dragColor:"yellow"},C=void 0,M=void 0,w=void 0,P=void 0,_=void 0,S=(0,m.default)({onMouseMove:c,onMouseDown:s,onMouseUp:u,onDrag:f,toolType:"adaptiveBrush",onImageRendered:d});S.setConfiguration(b),t.adaptiveBrush=S},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(25);Object.defineProperty(t,"regionsThreshold",{enumerable:!0,get:function(){return o(r).default}});var a=n(121);Object.defineProperty(t,"regionsGrow",{enumerable:!0,get:function(){return o(a).default}});var i=n(122);Object.defineProperty(t,"regionsDraw",{enumerable:!0,get:function(){return o(i).default}});var l=n(123);Object.defineProperty(t,"regionsScore",{enumerable:!0,get:function(){return o(l).default}});var u=n(127);Object.defineProperty(t,"regionsUndo",{enumerable:!0,get:function(){return o(u).default}})},function(e,t,n){"use strict";function o(e,t,n,o,r){var a=e*t,i=[r-1,r+1,r-e,r+e],l=Math.floor(r/a);return l<n&&i.push(r+a),l>o&&i.push(r-a),i}function r(e,t,n,r){return new Promise(function(n){function a(){for(var t=0;t<l;t++){if(0===k.length)return n();k.forEach(function(e){M[e]=c});var r=k.map(function(e){return o(v,h,b,C,e)}).reduce(function(e,t){return e.concat(t)},[]).filter(function(e,t,n){return n.indexOf(e)===t}).filter(function(e){return M[e]===I});k=r}s.external.cornerstone.updateImage(e),setTimeout(a,0)}var i=(0,g.getConfiguration)(),l=i.growIterationsPerChunk,c=i.toolRegionValue,f=i.layersAbove,d=i.layersBelow,v=t.width,h=t.height,m=t.buffer,p=u(r,3),x=p[0],T=p[1],y=p[2],b=y+d,C=y-f,M=new Uint8Array(m),w=v*h,P=w*y,_=T*v+x,S=P+_,I=M[S];if(0!==I&&I!==c){var k=[S];a()}})}function a(e,t){var n=t.element;if(console.log("*** e.data (grow.js) ***",e.data),console.log("*** eventData (grow.js) ***",t),(0,d.default)(t.which,e.data.mouseButtonMask)){(0,g.createUndoStep)(n);var o=u((0,c.getToolState)(n,"stack").data,1),a=o[0],i=u((0,c.getToolState)(n,"regions").data,1),l=i[0],s=a.currentImageIdIndex,f=a.imageIds,v=t.currentPoints.image,h=v.x,m=v.y,p=[Math.round(h),Math.round(m),s];r(n,l,f.length,p)}}function i(e,t){var n=(0,c.getToolState)(e,"stack"),o=(0,c.getToolState)(e,"regions");n&&n.data&&n.data.length&&o&&o.data&&o.data.length&&s.external.$(e).on("CornerstoneToolsMouseDown",{mouseButtonMask:t},a)}function l(e){s.external.$(e).off("CornerstoneToolsMouseDown",a)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var n=[],o=!0,r=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(o=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=n(0),c=n(1),f=n(2),d=function(e){return e&&e.__esModule?e:{default:e}}(f),g=n(25);t.default={enable:i,disable:l,activate:i,deactivate:l}},function(e,t,n){"use strict";function o(e,t){for(var n=g(e,2),o=n[0],r=n[1],a=!1,i=0,l=t.length-1;i<t.length;l=i++){var u=g(t[i],2),s=u[0],c=u[1],f=g(t[l],2),d=f[0],v=f[1];c>r!=v>r&&o<(d-s)*(r-c)/(v-c)+s&&(a=!a)}return a}function r(e,t){var n=t.canvasContext,o=t.enabledElement,r=t.element;v.external.cornerstone.setToPixelCoordinateSystem(o,n);var a=(0,h.getToolState)(r,y),i=t.canvasContext,l=a.data[0].points;if(!(l.length<2)){var u=l[0],s=u[0],c=u[1];i.fillStyle="rgba(255,255,255,.2)",i.strokeStyle="white",i.beginPath(),i.moveTo(s,c),l.slice(1).forEach(function(e){i.lineTo(e[0],e[1])}),i.closePath(),i.stroke(),i.fill()}}function a(e){var t=T.getConfiguration(),n=t.toolRegionValue,r=t.layersAbove,a=t.layersBelow;T.createUndoStep(e);for(var i=(0,h.getToolState)(e,"stack"),l=(0,h.getToolState)(e,"regions"),u=(0,h.getToolState)(e,y),s=i.data[0].currentImageIdIndex,c=i.data[0].imageIds.length,f=l.data[0],d=u.data[0].points,g=f.buffer,v=f.width,m=f.height,p=Math.max(0,s-r),x=Math.min(c,s+a),C=v*m,M=p*C,w=new Uint8Array(g,M),P=0;P<=x-p;P+=1)for(var _=0;_<v;_+=1)for(var S=0;S<m;S+=1){var I=_+S*v+P*C,k=w[I],O=void 0;O=!b.snap||k>0,O&&o([_,S],d)&&(w[I]=n)}}function i(e,t){v.external.$(t.element).off("CornerstoneToolsMouseDrag",u),v.external.$(t.element).off("CornerstoneToolsMouseUp",i),v.external.$(t.element).off("CornerstoneImageRendered",r),a(t.element),v.external.cornerstone.updateImage(t.element)}function l(e,t){if(console.log("*** e.data (draw.js) ***",e.data),console.log("*** eventData (draw.js) ***",t),(0,p.default)(t.which,e.data.mouseButtonMask)){return(0,h.getToolState)(e.currentTarget,y).data[0].points=[],v.external.$(t.element).on("CornerstoneToolsMouseDrag",u),v.external.$(t.element).on("CornerstoneToolsMouseUp",i),v.external.$(t.element).on("CornerstoneImageRendered",r),u(e,t)}}function u(e,t){e.stopImmediatePropagation();var n=(0,h.getToolState)(e.currentTarget,y);if(n){var o=t.currentPoints.image;return n.data[0].points.push([o.x,o.y]),v.external.cornerstone.updateImage(t.element),!1}}function s(e,t){var n={mouseButtonMask:t};(0,h.clearToolState)(e,y),(0,h.addToolState)(e,y,{points:[]}),v.external.$(e).off("CornerstoneToolsMouseDown",l),v.external.$(e).on("CornerstoneToolsMouseDown",n,l)}function c(e){v.external.$(e).off("CornerstoneToolsMouseDown",l)}function f(){return b}function d(e){b=e}Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(e,t){var n=[],o=!0,r=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(o=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getConfiguration=f,t.setConfiguration=d;var v=n(0),h=n(1),m=n(2),p=function(e){return e&&e.__esModule?e:{default:e}}(m),x=n(25),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(x),y="drawing",b={snap:!1};t.default={enable:s,disable:c,activate:s,deactivate:c,getConfiguration:f,setConfiguration:d}},function(e,t,n){"use strict";function o(e){return e<130?0:e<200?1:e<300?2:e<400?3:4}function r(e){if(0===e.length)return null;for(var t={},n=e[0],o=1,r=0;r<e.length;r++){var a=e[r];null===t[a]?t[a]=1:t[a]++,t[a]>o&&(n=a,o=t[a])}return n}function a(e){if(0===e.sliceThickness||0===e.pixelSpacing[0]||0===e.pixelSpacing[1])throw new Error("sliceThickness or pixelSpacing was 0");return e.sliceThickness*e.pixelSpacing[0]*e.pixelSpacing[1]}function i(e,t){var n=a(e)/3,r=o(e.maxHU),i=t.length*n,l=(0,d.getConfiguration)(),u=l.KVPToMultiplier,s=u[e.KVP],c=i*r*s;return console.log('modeOverlapFactor", '+e.modeOverlapFactor),console.log("voxels.length: "+t.length),console.log("voxelSizeScaled: "+n),console.log("Volume: "+i),console.log("Max HU: "+e.maxHU),console.log("densityFactor: "+r),console.log("KVPMultiplier: "+s),console.log("CAscore: "+c),e.modeOverlapFactor?c*e.modeOverlapFactor:c}function l(e,t){var n=new f.cornerstoneMath.Vector3;n.fromArray(e[0]);var o=new f.cornerstoneMath.Vector3;o.fromArray(e[1]);var r=new f.cornerstoneMath.Vector3;r.fromArray(t[0]);var a=new f.cornerstoneMath.Vector3;a.fromArray(t[1]);var i=new f.cornerstoneMath.Vector3;i.crossVectors(r,a);var l=n.projectOnVector(i),u=o.projectOnVector(i);return l.distanceTo(u)}function u(e,t){if(e<=0)throw new Error("Distance must be > 0");return e>=t?1:(t+e)/(2*t)}function s(e,t,n,o,r,a,i){for(var l=[[e,t]];l.length>0;){var u=l.shift(),s=u[0],c=u[1];if(n[c]&&n[c][s]===o){l.push([s-1,c]),l.push([s+1,c]),l.push([s,c-1]),l.push([s,c+1]);var f=n[0].length,d=a[s+c*f],g=d*parseInt(i.rescaleSlope)+parseInt(i.rescaleIntercept);g>=130&&r.push(g),n[c][s]=0}}return r.length>0}function c(){var e=(0,d.getLastElement)(),t=(0,g.getToolState)(e,"regions"),n=(0,g.getToolState)(e,"stack"),o=n.data[0].imageIds,a=(0,d.getConfiguration)(),c=a.regionColorsRGB,h=(a.KVPToMultiplier,c.slice(1).map(function(){return o.map(function(){return[]})})),m=c.slice(1).map(function(){return o.map(function(){return[]})}),p=t.data[0].buffer,x=new Uint8Array(p),T=void 0,y=void 0,b=[],C={},M=o.map(function(e,t){return f.external.cornerstone.loadImage(e).then(function(e){var n=e.data;C.sliceThickness=n.floatString("x00180050"),C.pixelSpacing=n.string("x00280030").split("\\").map(parseFloat),C.KVP=n.floatString("x00180060"),C.rescaleSlope=n.floatString("x00281053"),C.rescaleIntercept=n.floatString("x00281052"),C.rescaleType=n.string("x00281054");var o=(n.floatString("x00201041"),n.string("x00200032").split("\\").map(parseFloat)),a=n.string("x00200037").split("\\").map(parseFloat),i=[a.slice(0,3),a.slice(3)];if("HU"!==C.rescaleType)return void console.warn("Modality LUT does not convert to Hounsfield units but to "+C.rescaleType+". Agatston score is not defined for this unit type.");if(y){var c=l([y,o],i);T=u(c,C.sliceThickness),b.push(T),C.modeOverlapFactor=r(b),y=o}else y=o;for(var f=e.width,d=e.height,g=f*d,p=e.getPixelData(),M=t*g,w=[],P=0;P<d;P+=1)w[P]=x.slice(M+f*P,M+f*P+f);for(var _=(0,v.cloneDeep)(w),S=0;S<_.length;S+=1)for(var I=0;I<_[S].length;I+=1){var k=[],O=_[I][S];_[I]&&O>1&&s(S,I,_,O,k,p,C)&&(h[O-2][t].push(k),m[O-2][t].push(Math.max.apply(null,k)))}})});return Promise.all(M).then(function(){return h.map(function(e,t){var n=[];e.map(function(e,o){e.map(function(e,r){C.maxHU=m[t][o][r];var a=i(C,e);n.push(a)})}),console.log(n);var o=n.reduce(function(e,t){return e+t},0);return console.log("cascoreAccumulated: ",o),o})})}Object.defineProperty(t,"__esModule",{value:!0}),t.score=c;var f=n(0),d=n(25),g=n(1),v=n(124);t.default=c},function(e,t,n){(function(e,o){var r;(function(){function a(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function i(e,t,n,o){for(var r=-1,a=null==e?0:e.length;++r<a;){var i=e[r];t(o,i,n(i),e)}return o}function l(e,t){for(var n=-1,o=null==e?0:e.length;++n<o&&!1!==t(e[n],n,e););return e}function u(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function s(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(!t(e[n],n,e))return!1;return!0}function c(e,t){for(var n=-1,o=null==e?0:e.length,r=0,a=[];++n<o;){var i=e[n];t(i,n,e)&&(a[r++]=i)}return a}function f(e,t){return!!(null==e?0:e.length)&&C(e,t,0)>-1}function d(e,t,n){for(var o=-1,r=null==e?0:e.length;++o<r;)if(n(t,e[o]))return!0;return!1}function g(e,t){for(var n=-1,o=null==e?0:e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r}function v(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}function h(e,t,n,o){var r=-1,a=null==e?0:e.length;for(o&&a&&(n=e[++r]);++r<a;)n=t(n,e[r],r,e);return n}function m(e,t,n,o){var r=null==e?0:e.length;for(o&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function p(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}function x(e){return e.split("")}function T(e){return e.match(Bt)||[]}function y(e,t,n){var o;return n(e,function(e,n,r){if(t(e,n,r))return o=n,!1}),o}function b(e,t,n,o){for(var r=e.length,a=n+(o?1:-1);o?a--:++a<r;)if(t(e[a],a,e))return a;return-1}function C(e,t,n){return t===t?G(e,t,n):b(e,w,n)}function M(e,t,n,o){for(var r=n-1,a=e.length;++r<a;)if(o(e[r],t))return r;return-1}function w(e){return e!==e}function P(e,t){var n=null==e?0:e.length;return n?O(e,t)/n:Ee}function _(e){return function(t){return null==t?oe:t[e]}}function S(e){return function(t){return null==e?oe:e[t]}}function I(e,t,n,o,r){return r(e,function(e,r,a){n=o?(o=!1,e):t(n,e,r,a)}),n}function k(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function O(e,t){for(var n,o=-1,r=e.length;++o<r;){var a=t(e[o]);a!==oe&&(n=n===oe?a:n+a)}return n}function $(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}function D(e,t){return g(t,function(t){return[t,e[t]]})}function j(e){return function(t){return e(t)}}function E(e,t){return g(t,function(t){return e[t]})}function A(e,t){return e.has(t)}function R(e,t){for(var n=-1,o=e.length;++n<o&&C(t,e[n],0)>-1;);return n}function L(e,t){for(var n=e.length;n--&&C(t,e[n],0)>-1;);return n}function B(e,t){for(var n=e.length,o=0;n--;)e[n]===t&&++o;return o}function N(e){return"\\"+_n[e]}function U(e,t){return null==e?oe:e[t]}function z(e){return pn.test(e)}function V(e){return xn.test(e)}function W(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function H(e){var t=-1,n=Array(e.size);return e.forEach(function(e,o){n[++t]=[o,e]}),n}function F(e,t){return function(n){return e(t(n))}}function Y(e,t){for(var n=-1,o=e.length,r=0,a=[];++n<o;){var i=e[n];i!==t&&i!==se||(e[n]=se,a[r++]=n)}return a}function q(e,t){return"__proto__"==t?oe:e[t]}function X(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function K(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function G(e,t,n){for(var o=n-1,r=e.length;++o<r;)if(e[o]===t)return o;return-1}function Z(e,t,n){for(var o=n+1;o--;)if(e[o]===t)return o;return o}function J(e){return z(e)?ee(e):Wn(e)}function Q(e){return z(e)?te(e):x(e)}function ee(e){for(var t=hn.lastIndex=0;hn.test(e);)++t;return t}function te(e){return e.match(hn)||[]}function ne(e){return e.match(mn)||[]}var oe,re=200,ae="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ie="Expected a function",le="__lodash_hash_undefined__",ue=500,se="__lodash_placeholder__",ce=1,fe=2,de=4,ge=1,ve=2,he=1,me=2,pe=4,xe=8,Te=16,ye=32,be=64,Ce=128,Me=256,we=512,Pe=30,_e="...",Se=800,Ie=16,ke=1,Oe=2,$e=1/0,De=9007199254740991,je=1.7976931348623157e308,Ee=NaN,Ae=4294967295,Re=Ae-1,Le=Ae>>>1,Be=[["ary",Ce],["bind",he],["bindKey",me],["curry",xe],["curryRight",Te],["flip",we],["partial",ye],["partialRight",be],["rearg",Me]],Ne="[object Arguments]",Ue="[object Array]",ze="[object AsyncFunction]",Ve="[object Boolean]",We="[object Date]",He="[object DOMException]",Fe="[object Error]",Ye="[object Function]",qe="[object GeneratorFunction]",Xe="[object Map]",Ke="[object Number]",Ge="[object Null]",Ze="[object Object]",Je="[object Proxy]",Qe="[object RegExp]",et="[object Set]",tt="[object String]",nt="[object Symbol]",ot="[object Undefined]",rt="[object WeakMap]",at="[object WeakSet]",it="[object ArrayBuffer]",lt="[object DataView]",ut="[object Float32Array]",st="[object Float64Array]",ct="[object Int8Array]",ft="[object Int16Array]",dt="[object Int32Array]",gt="[object Uint8Array]",vt="[object Uint8ClampedArray]",ht="[object Uint16Array]",mt="[object Uint32Array]",pt=/\b__p \+= '';/g,xt=/\b(__p \+=) '' \+/g,Tt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yt=/&(?:amp|lt|gt|quot|#39);/g,bt=/[&<>"']/g,Ct=RegExp(yt.source),Mt=RegExp(bt.source),wt=/<%-([\s\S]+?)%>/g,Pt=/<%([\s\S]+?)%>/g,_t=/<%=([\s\S]+?)%>/g,St=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,It=/^\w*$/,kt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,$t=RegExp(Ot.source),Dt=/^\s+|\s+$/g,jt=/^\s+/,Et=/\s+$/,At=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Rt=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,Bt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Nt=/\\(\\)?/g,Ut=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,zt=/\w*$/,Vt=/^[-+]0x[0-9a-f]+$/i,Wt=/^0b[01]+$/i,Ht=/^\[object .+?Constructor\]$/,Ft=/^0o[0-7]+$/i,Yt=/^(?:0|[1-9]\d*)$/,qt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xt=/($^)/,Kt=/['\n\r\u2028\u2029\\]/g,Gt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Zt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Jt="["+Zt+"]",Qt="["+Gt+"]",en="[a-z\\xdf-\\xf6\\xf8-\\xff]",tn="[^\\ud800-\\udfff"+Zt+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",nn="\\ud83c[\\udffb-\\udfff]",on="(?:\\ud83c[\\udde6-\\uddff]){2}",rn="[\\ud800-\\udbff][\\udc00-\\udfff]",an="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ln="(?:"+en+"|"+tn+")",un="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",sn="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",on,rn].join("|")+")[\\ufe0e\\ufe0f]?"+un+")*",cn="[\\ufe0e\\ufe0f]?"+un+sn,fn="(?:"+["[\\u2700-\\u27bf]",on,rn].join("|")+")"+cn,dn="(?:"+["[^\\ud800-\\udfff]"+Qt+"?",Qt,on,rn,"[\\ud800-\\udfff]"].join("|")+")",gn=RegExp("[']","g"),vn=RegExp(Qt,"g"),hn=RegExp(nn+"(?="+nn+")|"+dn+cn,"g"),mn=RegExp([an+"?"+en+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[Jt,an,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[Jt,an+ln,"$"].join("|")+")",an+"?"+ln+"+(?:['](?:d|ll|m|re|s|t|ve))?",an+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",fn].join("|"),"g"),pn=RegExp("[\\u200d\\ud800-\\udfff"+Gt+"\\ufe0e\\ufe0f]"),xn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Tn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yn=-1,bn={};bn[ut]=bn[st]=bn[ct]=bn[ft]=bn[dt]=bn[gt]=bn[vt]=bn[ht]=bn[mt]=!0,bn[Ne]=bn[Ue]=bn[it]=bn[Ve]=bn[lt]=bn[We]=bn[Fe]=bn[Ye]=bn[Xe]=bn[Ke]=bn[Ze]=bn[Qe]=bn[et]=bn[tt]=bn[rt]=!1;var Cn={};Cn[Ne]=Cn[Ue]=Cn[it]=Cn[lt]=Cn[Ve]=Cn[We]=Cn[ut]=Cn[st]=Cn[ct]=Cn[ft]=Cn[dt]=Cn[Xe]=Cn[Ke]=Cn[Ze]=Cn[Qe]=Cn[et]=Cn[tt]=Cn[nt]=Cn[gt]=Cn[vt]=Cn[ht]=Cn[mt]=!0,Cn[Fe]=Cn[Ye]=Cn[rt]=!1;var Mn={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"},wn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Pn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},_n={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Sn=parseFloat,In=parseInt,kn="object"==typeof e&&e&&e.Object===Object&&e,On="object"==typeof self&&self&&self.Object===Object&&self,$n=kn||On||Function("return this")(),Dn="object"==typeof t&&t&&!t.nodeType&&t,jn=Dn&&"object"==typeof o&&o&&!o.nodeType&&o,En=jn&&jn.exports===Dn,An=En&&kn.process,Rn=function(){try{return An&&An.binding&&An.binding("util")}catch(e){}}(),Ln=Rn&&Rn.isArrayBuffer,Bn=Rn&&Rn.isDate,Nn=Rn&&Rn.isMap,Un=Rn&&Rn.isRegExp,zn=Rn&&Rn.isSet,Vn=Rn&&Rn.isTypedArray,Wn=_("length"),Hn=S(Mn),Fn=S(wn),Yn=S(Pn),qn=function e(t){function n(e){if(tu(e)&&!gd(e)&&!(e instanceof x)){if(e instanceof r)return e;if(dc.call(e,"__wrapped__"))return Ja(e)}return new r(e)}function o(){}function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=oe}function x(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ae,this.__views__=[]}function S(){var e=new x(this.__wrapped__);return e.__actions__=Er(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Er(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Er(this.__views__),e}function G(){if(this.__filtered__){var e=new x(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function ee(){var e=this.__wrapped__.value(),t=this.__dir__,n=gd(e),o=t<0,r=n?e.length:0,a=Ma(0,r,this.__views__),i=a.start,l=a.end,u=l-i,s=o?l:i-1,c=this.__iteratees__,f=c.length,d=0,g=Vc(u,this.__takeCount__);if(!n||!o&&r==u&&g==u)return pr(e,this.__actions__);var v=[];e:for(;u--&&d<g;){s+=t;for(var h=-1,m=e[s];++h<f;){var p=c[h],x=p.iteratee,T=p.type,y=x(m);if(T==Oe)m=y;else if(!y){if(T==ke)continue e;break e}}v[d++]=m}return v}function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Bt(){this.__data__=Jc?Jc(null):{},this.size=0}function Gt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Zt(e){var t=this.__data__;if(Jc){var n=t[e];return n===le?oe:n}return dc.call(t,e)?t[e]:oe}function Jt(e){var t=this.__data__;return Jc?t[e]!==oe:dc.call(t,e)}function Qt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Jc&&t===oe?le:t,this}function en(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function tn(){this.__data__=[],this.size=0}function nn(e){var t=this.__data__,n=Xn(t,e);return!(n<0)&&(n==t.length-1?t.pop():_c.call(t,n,1),--this.size,!0)}function on(e){var t=this.__data__,n=Xn(t,e);return n<0?oe:t[n][1]}function rn(e){return Xn(this.__data__,e)>-1}function an(e,t){var n=this.__data__,o=Xn(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}function ln(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function un(){this.size=0,this.__data__={hash:new te,map:new(Xc||en),string:new te}}function sn(e){var t=Ta(this,e).delete(e);return this.size-=t?1:0,t}function cn(e){return Ta(this,e).get(e)}function fn(e){return Ta(this,e).has(e)}function dn(e,t){var n=Ta(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}function hn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new ln;++t<n;)this.add(e[t])}function mn(e){return this.__data__.set(e,le),this}function pn(e){return this.__data__.has(e)}function xn(e){var t=this.__data__=new en(e);this.size=t.size}function Mn(){this.__data__=new en,this.size=0}function wn(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Pn(e){return this.__data__.get(e)}function _n(e){return this.__data__.has(e)}function kn(e,t){var n=this.__data__;if(n instanceof en){var o=n.__data__;if(!Xc||o.length<re-1)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new ln(o)}return n.set(e,t),this.size=n.size,this}function On(e,t){var n=gd(e),o=!n&&dd(e),r=!n&&!o&&hd(e),a=!n&&!o&&!r&&yd(e),i=n||o||r||a,l=i?$(e.length,ac):[],u=l.length;for(var s in e)!t&&!dc.call(e,s)||i&&("length"==s||r&&("offset"==s||"parent"==s)||a&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||$a(s,u))||l.push(s);return l}function Dn(e){var t=e.length;return t?e[Jo(0,t-1)]:oe}function jn(e,t){return Xa(Er(e),eo(t,0,e.length))}function An(e){return Xa(Er(e))}function Rn(e,t,n){(n===oe||zl(e[t],n))&&(n!==oe||t in e)||Jn(e,t,n)}function Wn(e,t,n){var o=e[t];dc.call(e,t)&&zl(o,n)&&(n!==oe||t in e)||Jn(e,t,n)}function Xn(e,t){for(var n=e.length;n--;)if(zl(e[n][0],t))return n;return-1}function Kn(e,t,n,o){return ff(e,function(e,r,a){t(o,e,n(e),a)}),o}function Gn(e,t){return e&&Ar(t,Ru(t),e)}function Zn(e,t){return e&&Ar(t,Lu(t),e)}function Jn(e,t,n){"__proto__"==t&&Oc?Oc(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Qn(e,t){for(var n=-1,o=t.length,r=Js(o),a=null==e;++n<o;)r[n]=a?oe:ju(e,t[n]);return r}function eo(e,t,n){return e===e&&(n!==oe&&(e=e<=n?e:n),t!==oe&&(e=e>=t?e:t)),e}function to(e,t,n,o,r,a){var i,u=t&ce,s=t&fe,c=t&de;if(n&&(i=r?n(e,o,r,a):n(e)),i!==oe)return i;if(!eu(e))return e;var f=gd(e);if(f){if(i=_a(e),!u)return Er(e,i)}else{var d=Mf(e),g=d==Ye||d==qe;if(hd(e))return wr(e,u);if(d==Ze||d==Ne||g&&!r){if(i=s||g?{}:Sa(e),!u)return s?Lr(e,Zn(i,e)):Rr(e,Gn(i,e))}else{if(!Cn[d])return r?e:{};i=Ia(e,d,u)}}a||(a=new xn);var v=a.get(e);if(v)return v;if(a.set(e,i),Td(e))return e.forEach(function(o){i.add(to(o,t,n,o,e,a))}),i;if(pd(e))return e.forEach(function(o,r){i.set(r,to(o,t,n,r,e,a))}),i;var h=c?s?ha:va:s?Lu:Ru,m=f?oe:h(e);return l(m||e,function(o,r){m&&(r=o,o=e[r]),Wn(i,r,to(o,t,n,r,e,a))}),i}function no(e){var t=Ru(e);return function(n){return oo(n,e,t)}}function oo(e,t,n){var o=n.length;if(null==e)return!o;for(e=oc(e);o--;){var r=n[o],a=t[r],i=e[r];if(i===oe&&!(r in e)||!a(i))return!1}return!0}function ro(e,t,n){if("function"!=typeof e)throw new ic(ie);return _f(function(){e.apply(oe,n)},t)}function ao(e,t,n,o){var r=-1,a=f,i=!0,l=e.length,u=[],s=t.length;if(!l)return u;n&&(t=g(t,j(n))),o?(a=d,i=!1):t.length>=re&&(a=A,i=!1,t=new hn(t));e:for(;++r<l;){var c=e[r],v=null==n?c:n(c);if(c=o||0!==c?c:0,i&&v===v){for(var h=s;h--;)if(t[h]===v)continue e;u.push(c)}else a(t,v,o)||u.push(c)}return u}function io(e,t){var n=!0;return ff(e,function(e,o,r){return n=!!t(e,o,r)}),n}function lo(e,t,n){for(var o=-1,r=e.length;++o<r;){var a=e[o],i=t(a);if(null!=i&&(l===oe?i===i&&!du(i):n(i,l)))var l=i,u=a}return u}function uo(e,t,n,o){var r=e.length;for(n=xu(n),n<0&&(n=-n>r?0:r+n),o=o===oe||o>r?r:xu(o),o<0&&(o+=r),o=n>o?0:Tu(o);n<o;)e[n++]=t;return e}function so(e,t){var n=[];return ff(e,function(e,o,r){t(e,o,r)&&n.push(e)}),n}function co(e,t,n,o,r){var a=-1,i=e.length;for(n||(n=Oa),r||(r=[]);++a<i;){var l=e[a];t>0&&n(l)?t>1?co(l,t-1,n,o,r):v(r,l):o||(r[r.length]=l)}return r}function fo(e,t){return e&&gf(e,t,Ru)}function go(e,t){return e&&vf(e,t,Ru)}function vo(e,t){return c(t,function(t){return Zl(e[t])})}function ho(e,t){t=Cr(t,e);for(var n=0,o=t.length;null!=e&&n<o;)e=e[Ka(t[n++])];return n&&n==o?e:oe}function mo(e,t,n){var o=t(e);return gd(e)?o:v(o,n(e))}function po(e){return null==e?e===oe?ot:Ge:kc&&kc in oc(e)?Ca(e):Va(e)}function xo(e,t){return e>t}function To(e,t){return null!=e&&dc.call(e,t)}function yo(e,t){return null!=e&&t in oc(e)}function bo(e,t,n){return e>=Vc(t,n)&&e<zc(t,n)}function Co(e,t,n){for(var o=n?d:f,r=e[0].length,a=e.length,i=a,l=Js(a),u=1/0,s=[];i--;){var c=e[i];i&&t&&(c=g(c,j(t))),u=Vc(c.length,u),l[i]=!n&&(t||r>=120&&c.length>=120)?new hn(i&&c):oe}c=e[0];var v=-1,h=l[0];e:for(;++v<r&&s.length<u;){var m=c[v],p=t?t(m):m;if(m=n||0!==m?m:0,!(h?A(h,p):o(s,p,n))){for(i=a;--i;){var x=l[i];if(!(x?A(x,p):o(e[i],p,n)))continue e}h&&h.push(p),s.push(m)}}return s}function Mo(e,t,n,o){return fo(e,function(e,r,a){t(o,n(e),r,a)}),o}function wo(e,t,n){t=Cr(t,e),e=Ha(e,t);var o=null==e?e:e[Ka(pi(t))];return null==o?oe:a(o,e,n)}function Po(e){return tu(e)&&po(e)==Ne}function _o(e){return tu(e)&&po(e)==it}function So(e){return tu(e)&&po(e)==We}function Io(e,t,n,o,r){return e===t||(null==e||null==t||!tu(e)&&!tu(t)?e!==e&&t!==t:ko(e,t,n,o,Io,r))}function ko(e,t,n,o,r,a){var i=gd(e),l=gd(t),u=i?Ue:Mf(e),s=l?Ue:Mf(t);u=u==Ne?Ze:u,s=s==Ne?Ze:s;var c=u==Ze,f=s==Ze,d=u==s;if(d&&hd(e)){if(!hd(t))return!1;i=!0,c=!1}if(d&&!c)return a||(a=new xn),i||yd(e)?ca(e,t,n,o,r,a):fa(e,t,u,n,o,r,a);if(!(n&ge)){var g=c&&dc.call(e,"__wrapped__"),v=f&&dc.call(t,"__wrapped__");if(g||v){var h=g?e.value():e,m=v?t.value():t;return a||(a=new xn),r(h,m,n,o,a)}}return!!d&&(a||(a=new xn),da(e,t,n,o,r,a))}function Oo(e){return tu(e)&&Mf(e)==Xe}function $o(e,t,n,o){var r=n.length,a=r,i=!o;if(null==e)return!a;for(e=oc(e);r--;){var l=n[r];if(i&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++r<a;){l=n[r];var u=l[0],s=e[u],c=l[1];if(i&&l[2]){if(s===oe&&!(u in e))return!1}else{var f=new xn;if(o)var d=o(s,c,u,e,t,f);if(!(d===oe?Io(c,s,ge|ve,o,f):d))return!1}}return!0}function Do(e){return!(!eu(e)||Ra(e))&&(Zl(e)?xc:Ht).test(Ga(e))}function jo(e){return tu(e)&&po(e)==Qe}function Eo(e){return tu(e)&&Mf(e)==et}function Ao(e){return tu(e)&&Ql(e.length)&&!!bn[po(e)]}function Ro(e){return"function"==typeof e?e:null==e?_s:"object"==typeof e?gd(e)?Vo(e[0],e[1]):zo(e):Es(e)}function Lo(e){if(!La(e))return Uc(e);var t=[];for(var n in oc(e))dc.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Bo(e){if(!eu(e))return za(e);var t=La(e),n=[];for(var o in e)("constructor"!=o||!t&&dc.call(e,o))&&n.push(o);return n}function No(e,t){return e<t}function Uo(e,t){var n=-1,o=Vl(e)?Js(e.length):[];return ff(e,function(e,r,a){o[++n]=t(e,r,a)}),o}function zo(e){var t=ya(e);return 1==t.length&&t[0][2]?Na(t[0][0],t[0][1]):function(n){return n===e||$o(n,e,t)}}function Vo(e,t){return ja(e)&&Ba(t)?Na(Ka(e),t):function(n){var o=ju(n,e);return o===oe&&o===t?Au(n,e):Io(t,o,ge|ve)}}function Wo(e,t,n,o,r){e!==t&&gf(t,function(a,i){if(eu(a))r||(r=new xn),Ho(e,t,i,n,Wo,o,r);else{var l=o?o(q(e,i),a,i+"",e,t,r):oe;l===oe&&(l=a),Rn(e,i,l)}},Lu)}function Ho(e,t,n,o,r,a,i){var l=q(e,n),u=q(t,n),s=i.get(u);if(s)return void Rn(e,n,s);var c=a?a(l,u,n+"",e,t,i):oe,f=c===oe;if(f){var d=gd(u),g=!d&&hd(u),v=!d&&!g&&yd(u);c=u,d||g||v?gd(l)?c=l:Wl(l)?c=Er(l):g?(f=!1,c=wr(u,!0)):v?(f=!1,c=kr(u,!0)):c=[]:su(u)||dd(u)?(c=l,dd(l)?c=bu(l):(!eu(l)||o&&Zl(l))&&(c=Sa(u))):f=!1}f&&(i.set(u,c),r(c,u,o,a,i),i.delete(u)),Rn(e,n,c)}function Fo(e,t){var n=e.length;if(n)return t+=t<0?n:0,$a(t,n)?e[t]:oe}function Yo(e,t,n){var o=-1;return t=g(t.length?t:[_s],j(xa())),k(Uo(e,function(e,n,r){return{criteria:g(t,function(t){return t(e)}),index:++o,value:e}}),function(e,t){return $r(e,t,n)})}function qo(e,t){return Xo(e,t,function(t,n){return Au(e,n)})}function Xo(e,t,n){for(var o=-1,r=t.length,a={};++o<r;){var i=t[o],l=ho(e,i);n(l,i)&&rr(a,Cr(i,e),l)}return a}function Ko(e){return function(t){return ho(t,e)}}function Go(e,t,n,o){var r=o?M:C,a=-1,i=t.length,l=e;for(e===t&&(t=Er(t)),n&&(l=g(e,j(n)));++a<i;)for(var u=0,s=t[a],c=n?n(s):s;(u=r(l,c,u,o))>-1;)l!==e&&_c.call(l,u,1),_c.call(e,u,1);return e}function Zo(e,t){for(var n=e?t.length:0,o=n-1;n--;){var r=t[n];if(n==o||r!==a){var a=r;$a(r)?_c.call(e,r,1):vr(e,r)}}return e}function Jo(e,t){return e+Ac(Fc()*(t-e+1))}function Qo(e,t,n,o){for(var r=-1,a=zc(Ec((t-e)/(n||1)),0),i=Js(a);a--;)i[o?a:++r]=e,e+=n;return i}function er(e,t){var n="";if(!e||t<1||t>De)return n;do{t%2&&(n+=e),(t=Ac(t/2))&&(e+=e)}while(t);return n}function tr(e,t){return Sf(Wa(e,t,_s),e+"")}function nr(e){return Dn(Ku(e))}function or(e,t){var n=Ku(e);return Xa(n,eo(t,0,n.length))}function rr(e,t,n,o){if(!eu(e))return e;t=Cr(t,e);for(var r=-1,a=t.length,i=a-1,l=e;null!=l&&++r<a;){var u=Ka(t[r]),s=n;if(r!=i){var c=l[u];s=o?o(c,u,l):oe,s===oe&&(s=eu(c)?c:$a(t[r+1])?[]:{})}Wn(l,u,s),l=l[u]}return e}function ar(e){return Xa(Ku(e))}function ir(e,t,n){var o=-1,r=e.length;t<0&&(t=-t>r?0:r+t),n=n>r?r:n,n<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var a=Js(r);++o<r;)a[o]=e[o+t];return a}function lr(e,t){var n;return ff(e,function(e,o,r){return!(n=t(e,o,r))}),!!n}function ur(e,t,n){var o=0,r=null==e?o:e.length;if("number"==typeof t&&t===t&&r<=Le){for(;o<r;){var a=o+r>>>1,i=e[a];null!==i&&!du(i)&&(n?i<=t:i<t)?o=a+1:r=a}return r}return sr(e,t,_s,n)}function sr(e,t,n,o){t=n(t);for(var r=0,a=null==e?0:e.length,i=t!==t,l=null===t,u=du(t),s=t===oe;r<a;){var c=Ac((r+a)/2),f=n(e[c]),d=f!==oe,g=null===f,v=f===f,h=du(f);if(i)var m=o||v;else m=s?v&&(o||d):l?v&&d&&(o||!g):u?v&&d&&!g&&(o||!h):!g&&!h&&(o?f<=t:f<t);m?r=c+1:a=c}return Vc(a,Re)}function cr(e,t){for(var n=-1,o=e.length,r=0,a=[];++n<o;){var i=e[n],l=t?t(i):i;if(!n||!zl(l,u)){var u=l;a[r++]=0===i?0:i}}return a}function fr(e){return"number"==typeof e?e:du(e)?Ee:+e}function dr(e){if("string"==typeof e)return e;if(gd(e))return g(e,dr)+"";if(du(e))return sf?sf.call(e):"";var t=e+"";return"0"==t&&1/e==-$e?"-0":t}function gr(e,t,n){var o=-1,r=f,a=e.length,i=!0,l=[],u=l;if(n)i=!1,r=d;else if(a>=re){var s=t?null:Tf(e);if(s)return X(s);i=!1,r=A,u=new hn}else u=t?[]:l;e:for(;++o<a;){var c=e[o],g=t?t(c):c;if(c=n||0!==c?c:0,i&&g===g){for(var v=u.length;v--;)if(u[v]===g)continue e;t&&u.push(g),l.push(c)}else r(u,g,n)||(u!==l&&u.push(g),l.push(c))}return l}function vr(e,t){return t=Cr(t,e),null==(e=Ha(e,t))||delete e[Ka(pi(t))]}function hr(e,t,n,o){return rr(e,t,n(ho(e,t)),o)}function mr(e,t,n,o){for(var r=e.length,a=o?r:-1;(o?a--:++a<r)&&t(e[a],a,e););return n?ir(e,o?0:a,o?a+1:r):ir(e,o?a+1:0,o?r:a)}function pr(e,t){var n=e;return n instanceof x&&(n=n.value()),h(t,function(e,t){return t.func.apply(t.thisArg,v([e],t.args))},n)}function xr(e,t,n){var o=e.length;if(o<2)return o?gr(e[0]):[];for(var r=-1,a=Js(o);++r<o;)for(var i=e[r],l=-1;++l<o;)l!=r&&(a[r]=ao(a[r]||i,e[l],t,n));return gr(co(a,1),t,n)}function Tr(e,t,n){for(var o=-1,r=e.length,a=t.length,i={};++o<r;){var l=o<a?t[o]:oe;n(i,e[o],l)}return i}function yr(e){return Wl(e)?e:[]}function br(e){return"function"==typeof e?e:_s}function Cr(e,t){return gd(e)?e:ja(e,t)?[e]:If(Mu(e))}function Mr(e,t,n){var o=e.length;return n=n===oe?o:n,!t&&n>=o?e:ir(e,t,n)}function wr(e,t){if(t)return e.slice();var n=e.length,o=Cc?Cc(n):new e.constructor(n);return e.copy(o),o}function Pr(e){var t=new e.constructor(e.byteLength);return new bc(t).set(new bc(e)),t}function _r(e,t){var n=t?Pr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Sr(e){var t=new e.constructor(e.source,zt.exec(e));return t.lastIndex=e.lastIndex,t}function Ir(e){return uf?oc(uf.call(e)):{}}function kr(e,t){var n=t?Pr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Or(e,t){if(e!==t){var n=e!==oe,o=null===e,r=e===e,a=du(e),i=t!==oe,l=null===t,u=t===t,s=du(t);if(!l&&!s&&!a&&e>t||a&&i&&u&&!l&&!s||o&&i&&u||!n&&u||!r)return 1;if(!o&&!a&&!s&&e<t||s&&n&&r&&!o&&!a||l&&n&&r||!i&&r||!u)return-1}return 0}function $r(e,t,n){for(var o=-1,r=e.criteria,a=t.criteria,i=r.length,l=n.length;++o<i;){var u=Or(r[o],a[o]);if(u){if(o>=l)return u;return u*("desc"==n[o]?-1:1)}}return e.index-t.index}function Dr(e,t,n,o){for(var r=-1,a=e.length,i=n.length,l=-1,u=t.length,s=zc(a-i,0),c=Js(u+s),f=!o;++l<u;)c[l]=t[l];for(;++r<i;)(f||r<a)&&(c[n[r]]=e[r]);for(;s--;)c[l++]=e[r++];return c}function jr(e,t,n,o){for(var r=-1,a=e.length,i=-1,l=n.length,u=-1,s=t.length,c=zc(a-l,0),f=Js(c+s),d=!o;++r<c;)f[r]=e[r];for(var g=r;++u<s;)f[g+u]=t[u];for(;++i<l;)(d||r<a)&&(f[g+n[i]]=e[r++]);return f}function Er(e,t){var n=-1,o=e.length;for(t||(t=Js(o));++n<o;)t[n]=e[n];return t}function Ar(e,t,n,o){var r=!n;n||(n={});for(var a=-1,i=t.length;++a<i;){var l=t[a],u=o?o(n[l],e[l],l,n,e):oe;u===oe&&(u=e[l]),r?Jn(n,l,u):Wn(n,l,u)}return n}function Rr(e,t){return Ar(e,bf(e),t)}function Lr(e,t){return Ar(e,Cf(e),t)}function Br(e,t){return function(n,o){var r=gd(n)?i:Kn,a=t?t():{};return r(n,e,xa(o,2),a)}}function Nr(e){return tr(function(t,n){var o=-1,r=n.length,a=r>1?n[r-1]:oe,i=r>2?n[2]:oe;for(a=e.length>3&&"function"==typeof a?(r--,a):oe,i&&Da(n[0],n[1],i)&&(a=r<3?oe:a,r=1),t=oc(t);++o<r;){var l=n[o];l&&e(t,l,o,a)}return t})}function Ur(e,t){return function(n,o){if(null==n)return n;if(!Vl(n))return e(n,o);for(var r=n.length,a=t?r:-1,i=oc(n);(t?a--:++a<r)&&!1!==o(i[a],a,i););return n}}function zr(e){return function(t,n,o){for(var r=-1,a=oc(t),i=o(t),l=i.length;l--;){var u=i[e?l:++r];if(!1===n(a[u],u,a))break}return t}}function Vr(e,t,n){function o(){return(this&&this!==$n&&this instanceof o?a:e).apply(r?n:this,arguments)}var r=t&he,a=Fr(e);return o}function Wr(e){return function(t){t=Mu(t);var n=z(t)?Q(t):oe,o=n?n[0]:t.charAt(0),r=n?Mr(n,1).join(""):t.slice(1);return o[e]()+r}}function Hr(e){return function(t){return h(bs(ts(t).replace(gn,"")),e,"")}}function Fr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=cf(e.prototype),o=e.apply(n,t);return eu(o)?o:n}}function Yr(e,t,n){function o(){for(var i=arguments.length,l=Js(i),u=i,s=pa(o);u--;)l[u]=arguments[u];var c=i<3&&l[0]!==s&&l[i-1]!==s?[]:Y(l,s);return(i-=c.length)<n?oa(e,t,Kr,o.placeholder,oe,l,c,oe,oe,n-i):a(this&&this!==$n&&this instanceof o?r:e,this,l)}var r=Fr(e);return o}function qr(e){return function(t,n,o){var r=oc(t);if(!Vl(t)){var a=xa(n,3);t=Ru(t),n=function(e){return a(r[e],e,r)}}var i=e(t,n,o);return i>-1?r[a?t[i]:i]:oe}}function Xr(e){return ga(function(t){var n=t.length,o=n,a=r.prototype.thru;for(e&&t.reverse();o--;){var i=t[o];if("function"!=typeof i)throw new ic(ie);if(a&&!l&&"wrapper"==ma(i))var l=new r([],!0)}for(o=l?o:n;++o<n;){i=t[o];var u=ma(i),s="wrapper"==u?yf(i):oe;l=s&&Aa(s[0])&&s[1]==(Ce|xe|ye|Me)&&!s[4].length&&1==s[9]?l[ma(s[0])].apply(l,s[3]):1==i.length&&Aa(i)?l[u]():l.thru(i)}return function(){var e=arguments,o=e[0];if(l&&1==e.length&&gd(o))return l.plant(o).value();for(var r=0,a=n?t[r].apply(this,e):o;++r<n;)a=t[r].call(this,a);return a}})}function Kr(e,t,n,o,r,a,i,l,u,s){function c(){for(var p=arguments.length,x=Js(p),T=p;T--;)x[T]=arguments[T];if(v)var y=pa(c),b=B(x,y);if(o&&(x=Dr(x,o,r,v)),a&&(x=jr(x,a,i,v)),p-=b,v&&p<s){var C=Y(x,y);return oa(e,t,Kr,c.placeholder,n,x,C,l,u,s-p)}var M=d?n:this,w=g?M[e]:e;return p=x.length,l?x=Fa(x,l):h&&p>1&&x.reverse(),f&&u<p&&(x.length=u),this&&this!==$n&&this instanceof c&&(w=m||Fr(w)),w.apply(M,x)}var f=t&Ce,d=t&he,g=t&me,v=t&(xe|Te),h=t&we,m=g?oe:Fr(e);return c}function Gr(e,t){return function(n,o){return Mo(n,e,t(o),{})}}function Zr(e,t){return function(n,o){var r;if(n===oe&&o===oe)return t;if(n!==oe&&(r=n),o!==oe){if(r===oe)return o;"string"==typeof n||"string"==typeof o?(n=dr(n),o=dr(o)):(n=fr(n),o=fr(o)),r=e(n,o)}return r}}function Jr(e){return ga(function(t){return t=g(t,j(xa())),tr(function(n){var o=this;return e(t,function(e){return a(e,o,n)})})})}function Qr(e,t){t=t===oe?" ":dr(t);var n=t.length;if(n<2)return n?er(t,e):t;var o=er(t,Ec(e/J(t)));return z(t)?Mr(Q(o),0,e).join(""):o.slice(0,e)}function ea(e,t,n,o){function r(){for(var t=-1,u=arguments.length,s=-1,c=o.length,f=Js(c+u),d=this&&this!==$n&&this instanceof r?l:e;++s<c;)f[s]=o[s];for(;u--;)f[s++]=arguments[++t];return a(d,i?n:this,f)}var i=t&he,l=Fr(e);return r}function ta(e){return function(t,n,o){return o&&"number"!=typeof o&&Da(t,n,o)&&(n=o=oe),t=pu(t),n===oe?(n=t,t=0):n=pu(n),o=o===oe?t<n?1:-1:pu(o),Qo(t,n,o,e)}}function na(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=yu(t),n=yu(n)),e(t,n)}}function oa(e,t,n,o,r,a,i,l,u,s){var c=t&xe,f=c?i:oe,d=c?oe:i,g=c?a:oe,v=c?oe:a;t|=c?ye:be,(t&=~(c?be:ye))&pe||(t&=~(he|me));var h=[e,t,r,g,f,v,d,l,u,s],m=n.apply(oe,h);return Aa(e)&&Pf(m,h),m.placeholder=o,Ya(m,e,t)}function ra(e){var t=nc[e];return function(e,n){if(e=yu(e),n=null==n?0:Vc(xu(n),292)){var o=(Mu(e)+"e").split("e");return o=(Mu(t(o[0]+"e"+(+o[1]+n)))+"e").split("e"),+(o[0]+"e"+(+o[1]-n))}return t(e)}}function aa(e){return function(t){var n=Mf(t);return n==Xe?H(t):n==et?K(t):D(t,e(t))}}function ia(e,t,n,o,r,a,i,l){var u=t&me;if(!u&&"function"!=typeof e)throw new ic(ie);var s=o?o.length:0;if(s||(t&=~(ye|be),o=r=oe),i=i===oe?i:zc(xu(i),0),l=l===oe?l:xu(l),s-=r?r.length:0,t&be){var c=o,f=r;o=r=oe}var d=u?oe:yf(e),g=[e,t,n,o,r,c,f,a,i,l];if(d&&Ua(g,d),e=g[0],t=g[1],n=g[2],o=g[3],r=g[4],l=g[9]=g[9]===oe?u?0:e.length:zc(g[9]-s,0),!l&&t&(xe|Te)&&(t&=~(xe|Te)),t&&t!=he)v=t==xe||t==Te?Yr(e,t,l):t!=ye&&t!=(he|ye)||r.length?Kr.apply(oe,g):ea(e,t,n,o);else var v=Vr(e,t,n);return Ya((d?hf:Pf)(v,g),e,t)}function la(e,t,n,o){return e===oe||zl(e,sc[n])&&!dc.call(o,n)?t:e}function ua(e,t,n,o,r,a){return eu(e)&&eu(t)&&(a.set(t,e),Wo(e,t,oe,ua,a),a.delete(t)),e}function sa(e){return su(e)?oe:e}function ca(e,t,n,o,r,a){var i=n&ge,l=e.length,u=t.length;if(l!=u&&!(i&&u>l))return!1;var s=a.get(e);if(s&&a.get(t))return s==t;var c=-1,f=!0,d=n&ve?new hn:oe;for(a.set(e,t),a.set(t,e);++c<l;){var g=e[c],v=t[c];if(o)var h=i?o(v,g,c,t,e,a):o(g,v,c,e,t,a);if(h!==oe){if(h)continue;f=!1;break}if(d){if(!p(t,function(e,t){if(!A(d,t)&&(g===e||r(g,e,n,o,a)))return d.push(t)})){f=!1;break}}else if(g!==v&&!r(g,v,n,o,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function fa(e,t,n,o,r,a,i){switch(n){case lt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case it:return!(e.byteLength!=t.byteLength||!a(new bc(e),new bc(t)));case Ve:case We:case Ke:return zl(+e,+t);case Fe:return e.name==t.name&&e.message==t.message;case Qe:case tt:return e==t+"";case Xe:var l=H;case et:var u=o&ge;if(l||(l=X),e.size!=t.size&&!u)return!1;var s=i.get(e);if(s)return s==t;o|=ve,i.set(e,t);var c=ca(l(e),l(t),o,r,a,i);return i.delete(e),c;case nt:if(uf)return uf.call(e)==uf.call(t)}return!1}function da(e,t,n,o,r,a){var i=n&ge,l=va(e),u=l.length;if(u!=va(t).length&&!i)return!1;for(var s=u;s--;){var c=l[s];if(!(i?c in t:dc.call(t,c)))return!1}var f=a.get(e);if(f&&a.get(t))return f==t;var d=!0;a.set(e,t),a.set(t,e);for(var g=i;++s<u;){c=l[s];var v=e[c],h=t[c];if(o)var m=i?o(h,v,c,t,e,a):o(v,h,c,e,t,a);if(!(m===oe?v===h||r(v,h,n,o,a):m)){d=!1;break}g||(g="constructor"==c)}if(d&&!g){var p=e.constructor,x=t.constructor;p!=x&&"constructor"in e&&"constructor"in t&&!("function"==typeof p&&p instanceof p&&"function"==typeof x&&x instanceof x)&&(d=!1)}return a.delete(e),a.delete(t),d}function ga(e){return Sf(Wa(e,oe,si),e+"")}function va(e){return mo(e,Ru,bf)}function ha(e){return mo(e,Lu,Cf)}function ma(e){for(var t=e.name+"",n=ef[t],o=dc.call(ef,t)?n.length:0;o--;){var r=n[o],a=r.func;if(null==a||a==e)return r.name}return t}function pa(e){return(dc.call(n,"placeholder")?n:e).placeholder}function xa(){var e=n.iteratee||Ss;return e=e===Ss?Ro:e,arguments.length?e(arguments[0],arguments[1]):e}function Ta(e,t){var n=e.__data__;return Ea(t)?n["string"==typeof t?"string":"hash"]:n.map}function ya(e){for(var t=Ru(e),n=t.length;n--;){var o=t[n],r=e[o];t[n]=[o,r,Ba(r)]}return t}function ba(e,t){var n=U(e,t);return Do(n)?n:oe}function Ca(e){var t=dc.call(e,kc),n=e[kc];try{e[kc]=oe;var o=!0}catch(e){}var r=hc.call(e);return o&&(t?e[kc]=n:delete e[kc]),r}function Ma(e,t,n){for(var o=-1,r=n.length;++o<r;){var a=n[o],i=a.size;switch(a.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=Vc(t,e+i);break;case"takeRight":e=zc(e,t-i)}}return{start:e,end:t}}function wa(e){var t=e.match(Rt);return t?t[1].split(Lt):[]}function Pa(e,t,n){t=Cr(t,e);for(var o=-1,r=t.length,a=!1;++o<r;){var i=Ka(t[o]);if(!(a=null!=e&&n(e,i)))break;e=e[i]}return a||++o!=r?a:!!(r=null==e?0:e.length)&&Ql(r)&&$a(i,r)&&(gd(e)||dd(e))}function _a(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&dc.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Sa(e){return"function"!=typeof e.constructor||La(e)?{}:cf(Mc(e))}function Ia(e,t,n){var o=e.constructor;switch(t){case it:return Pr(e);case Ve:case We:return new o(+e);case lt:return _r(e,n);case ut:case st:case ct:case ft:case dt:case gt:case vt:case ht:case mt:return kr(e,n);case Xe:return new o;case Ke:case tt:return new o(e);case Qe:return Sr(e);case et:return new o;case nt:return Ir(e)}}function ka(e,t){var n=t.length;if(!n)return e;var o=n-1;return t[o]=(n>1?"& ":"")+t[o],t=t.join(n>2?", ":" "),e.replace(At,"{\n/* [wrapped with "+t+"] */\n")}function Oa(e){return gd(e)||dd(e)||!!(Sc&&e&&e[Sc])}function $a(e,t){var n=typeof e;return!!(t=null==t?De:t)&&("number"==n||"symbol"!=n&&Yt.test(e))&&e>-1&&e%1==0&&e<t}function Da(e,t,n){if(!eu(n))return!1;var o=typeof t;return!!("number"==o?Vl(n)&&$a(t,n.length):"string"==o&&t in n)&&zl(n[t],e)}function ja(e,t){if(gd(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!du(e))||(It.test(e)||!St.test(e)||null!=t&&e in oc(t))}function Ea(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function Aa(e){var t=ma(e),o=n[t];if("function"!=typeof o||!(t in x.prototype))return!1;if(e===o)return!0;var r=yf(o);return!!r&&e===r[0]}function Ra(e){return!!vc&&vc in e}function La(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||sc)}function Ba(e){return e===e&&!eu(e)}function Na(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==oe||e in oc(n)))}}function Ua(e,t){var n=e[1],o=t[1],r=n|o,a=r<(he|me|Ce),i=o==Ce&&n==xe||o==Ce&&n==Me&&e[7].length<=t[8]||o==(Ce|Me)&&t[7].length<=t[8]&&n==xe;if(!a&&!i)return e;o&he&&(e[2]=t[2],r|=n&he?0:pe);var l=t[3];if(l){var u=e[3];e[3]=u?Dr(u,l,t[4]):l,e[4]=u?Y(e[3],se):t[4]}return l=t[5],l&&(u=e[5],e[5]=u?jr(u,l,t[6]):l,e[6]=u?Y(e[5],se):t[6]),l=t[7],l&&(e[7]=l),o&Ce&&(e[8]=null==e[8]?t[8]:Vc(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r,e}function za(e){var t=[];if(null!=e)for(var n in oc(e))t.push(n);return t}function Va(e){return hc.call(e)}function Wa(e,t,n){return t=zc(t===oe?e.length-1:t,0),function(){for(var o=arguments,r=-1,i=zc(o.length-t,0),l=Js(i);++r<i;)l[r]=o[t+r];r=-1;for(var u=Js(t+1);++r<t;)u[r]=o[r];return u[t]=n(l),a(e,this,u)}}function Ha(e,t){return t.length<2?e:ho(e,ir(t,0,-1))}function Fa(e,t){for(var n=e.length,o=Vc(t.length,n),r=Er(e);o--;){var a=t[o];e[o]=$a(a,n)?r[a]:oe}return e}function Ya(e,t,n){var o=t+"";return Sf(e,ka(o,Za(wa(o),n)))}function qa(e){var t=0,n=0;return function(){var o=Wc(),r=Ie-(o-n);if(n=o,r>0){if(++t>=Se)return arguments[0]}else t=0;return e.apply(oe,arguments)}}function Xa(e,t){var n=-1,o=e.length,r=o-1;for(t=t===oe?o:t;++n<t;){var a=Jo(n,r),i=e[a];e[a]=e[n],e[n]=i}return e.length=t,e}function Ka(e){if("string"==typeof e||du(e))return e;var t=e+"";return"0"==t&&1/e==-$e?"-0":t}function Ga(e){if(null!=e){try{return fc.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Za(e,t){return l(Be,function(n){var o="_."+n[0];t&n[1]&&!f(e,o)&&e.push(o)}),e.sort()}function Ja(e){if(e instanceof x)return e.clone();var t=new r(e.__wrapped__,e.__chain__);return t.__actions__=Er(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Qa(e,t,n){t=(n?Da(e,t,n):t===oe)?1:zc(xu(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var r=0,a=0,i=Js(Ec(o/t));r<o;)i[a++]=ir(e,r,r+=t);return i}function ei(e){for(var t=-1,n=null==e?0:e.length,o=0,r=[];++t<n;){var a=e[t];a&&(r[o++]=a)}return r}function ti(){var e=arguments.length;if(!e)return[];for(var t=Js(e-1),n=arguments[0],o=e;o--;)t[o-1]=arguments[o];return v(gd(n)?Er(n):[n],co(t,1))}function ni(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===oe?1:xu(t),ir(e,t<0?0:t,o)):[]}function oi(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===oe?1:xu(t),t=o-t,ir(e,0,t<0?0:t)):[]}function ri(e,t){return e&&e.length?mr(e,xa(t,3),!0,!0):[]}function ai(e,t){return e&&e.length?mr(e,xa(t,3),!0):[]}function ii(e,t,n,o){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Da(e,t,n)&&(n=0,o=r),uo(e,t,n,o)):[]}function li(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=null==n?0:xu(n);return r<0&&(r=zc(o+r,0)),b(e,xa(t,3),r)}function ui(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=o-1;return n!==oe&&(r=xu(n),r=n<0?zc(o+r,0):Vc(r,o-1)),b(e,xa(t,3),r,!0)}function si(e){return(null==e?0:e.length)?co(e,1):[]}function ci(e){return(null==e?0:e.length)?co(e,$e):[]}function fi(e,t){return(null==e?0:e.length)?(t=t===oe?1:xu(t),co(e,t)):[]}function di(e){for(var t=-1,n=null==e?0:e.length,o={};++t<n;){var r=e[t];o[r[0]]=r[1]}return o}function gi(e){return e&&e.length?e[0]:oe}function vi(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=null==n?0:xu(n);return r<0&&(r=zc(o+r,0)),C(e,t,r)}function hi(e){return(null==e?0:e.length)?ir(e,0,-1):[]}function mi(e,t){return null==e?"":Nc.call(e,t)}function pi(e){var t=null==e?0:e.length;return t?e[t-1]:oe}function xi(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=o;return n!==oe&&(r=xu(n),r=r<0?zc(o+r,0):Vc(r,o-1)),t===t?Z(e,t,r):b(e,w,r,!0)}function Ti(e,t){return e&&e.length?Fo(e,xu(t)):oe}function yi(e,t){return e&&e.length&&t&&t.length?Go(e,t):e}function bi(e,t,n){return e&&e.length&&t&&t.length?Go(e,t,xa(n,2)):e}function Ci(e,t,n){return e&&e.length&&t&&t.length?Go(e,t,oe,n):e}function Mi(e,t){var n=[];if(!e||!e.length)return n;var o=-1,r=[],a=e.length;for(t=xa(t,3);++o<a;){var i=e[o];t(i,o,e)&&(n.push(i),r.push(o))}return Zo(e,r),n}function wi(e){return null==e?e:Yc.call(e)}function Pi(e,t,n){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&Da(e,t,n)?(t=0,n=o):(t=null==t?0:xu(t),n=n===oe?o:xu(n)),ir(e,t,n)):[]}function _i(e,t){return ur(e,t)}function Si(e,t,n){return sr(e,t,xa(n,2))}function Ii(e,t){var n=null==e?0:e.length;if(n){var o=ur(e,t);if(o<n&&zl(e[o],t))return o}return-1}function ki(e,t){return ur(e,t,!0)}function Oi(e,t,n){return sr(e,t,xa(n,2),!0)}function $i(e,t){if(null==e?0:e.length){var n=ur(e,t,!0)-1;if(zl(e[n],t))return n}return-1}function Di(e){return e&&e.length?cr(e):[]}function ji(e,t){return e&&e.length?cr(e,xa(t,2)):[]}function Ei(e){var t=null==e?0:e.length;return t?ir(e,1,t):[]}function Ai(e,t,n){return e&&e.length?(t=n||t===oe?1:xu(t),ir(e,0,t<0?0:t)):[]}function Ri(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===oe?1:xu(t),t=o-t,ir(e,t<0?0:t,o)):[]}function Li(e,t){return e&&e.length?mr(e,xa(t,3),!1,!0):[]}function Bi(e,t){return e&&e.length?mr(e,xa(t,3)):[]}function Ni(e){return e&&e.length?gr(e):[]}function Ui(e,t){return e&&e.length?gr(e,xa(t,2)):[]}function zi(e,t){return t="function"==typeof t?t:oe,e&&e.length?gr(e,oe,t):[]}function Vi(e){if(!e||!e.length)return[];var t=0;return e=c(e,function(e){if(Wl(e))return t=zc(e.length,t),!0}),$(t,function(t){return g(e,_(t))})}function Wi(e,t){if(!e||!e.length)return[];var n=Vi(e);return null==t?n:g(n,function(e){return a(t,oe,e)})}function Hi(e,t){return Tr(e||[],t||[],Wn)}function Fi(e,t){return Tr(e||[],t||[],rr)}function Yi(e){var t=n(e);return t.__chain__=!0,t}function qi(e,t){return t(e),e}function Xi(e,t){return t(e)}function Ki(){return Yi(this)}function Gi(){return new r(this.value(),this.__chain__)}function Zi(){this.__values__===oe&&(this.__values__=mu(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?oe:this.__values__[this.__index__++]}}function Ji(){return this}function Qi(e){for(var t,n=this;n instanceof o;){var r=Ja(n);r.__index__=0,r.__values__=oe,t?a.__wrapped__=r:t=r;var a=r;n=n.__wrapped__}return a.__wrapped__=e,t}function el(){var e=this.__wrapped__;if(e instanceof x){var t=e;return this.__actions__.length&&(t=new x(this)),t=t.reverse(),t.__actions__.push({func:Xi,args:[wi],thisArg:oe}),new r(t,this.__chain__)}return this.thru(wi)}function tl(){return pr(this.__wrapped__,this.__actions__)}function nl(e,t,n){var o=gd(e)?s:io;return n&&Da(e,t,n)&&(t=oe),o(e,xa(t,3))}function ol(e,t){return(gd(e)?c:so)(e,xa(t,3))}function rl(e,t){return co(cl(e,t),1)}function al(e,t){return co(cl(e,t),$e)}function il(e,t,n){return n=n===oe?1:xu(n),co(cl(e,t),n)}function ll(e,t){return(gd(e)?l:ff)(e,xa(t,3))}function ul(e,t){return(gd(e)?u:df)(e,xa(t,3))}function sl(e,t,n,o){e=Vl(e)?e:Ku(e),n=n&&!o?xu(n):0;var r=e.length;return n<0&&(n=zc(r+n,0)),fu(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&C(e,t,n)>-1}function cl(e,t){return(gd(e)?g:Uo)(e,xa(t,3))}function fl(e,t,n,o){return null==e?[]:(gd(t)||(t=null==t?[]:[t]),n=o?oe:n,gd(n)||(n=null==n?[]:[n]),Yo(e,t,n))}function dl(e,t,n){var o=gd(e)?h:I,r=arguments.length<3;return o(e,xa(t,4),n,r,ff)}function gl(e,t,n){var o=gd(e)?m:I,r=arguments.length<3;return o(e,xa(t,4),n,r,df)}function vl(e,t){return(gd(e)?c:so)(e,Il(xa(t,3)))}function hl(e){return(gd(e)?Dn:nr)(e)}function ml(e,t,n){return t=(n?Da(e,t,n):t===oe)?1:xu(t),(gd(e)?jn:or)(e,t)}function pl(e){return(gd(e)?An:ar)(e)}function xl(e){if(null==e)return 0;if(Vl(e))return fu(e)?J(e):e.length;var t=Mf(e);return t==Xe||t==et?e.size:Lo(e).length}function Tl(e,t,n){var o=gd(e)?p:lr;return n&&Da(e,t,n)&&(t=oe),o(e,xa(t,3))}function yl(e,t){if("function"!=typeof t)throw new ic(ie);return e=xu(e),function(){if(--e<1)return t.apply(this,arguments)}}function bl(e,t,n){return t=n?oe:t,t=e&&null==t?e.length:t,ia(e,Ce,oe,oe,oe,oe,t)}function Cl(e,t){var n;if("function"!=typeof t)throw new ic(ie);return e=xu(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=oe),n}}function Ml(e,t,n){t=n?oe:t;var o=ia(e,xe,oe,oe,oe,oe,oe,t);return o.placeholder=Ml.placeholder,o}function wl(e,t,n){t=n?oe:t;var o=ia(e,Te,oe,oe,oe,oe,oe,t);return o.placeholder=wl.placeholder,o}function Pl(e,t,n){function o(t){var n=d,o=g;return d=g=oe,x=t,h=e.apply(o,n)}function r(e){return x=e,m=_f(l,t),T?o(e):h}function a(e){var n=e-p,o=e-x,r=t-n;return y?Vc(r,v-o):r}function i(e){var n=e-p,o=e-x;return p===oe||n>=t||n<0||y&&o>=v}function l(){var e=td();if(i(e))return u(e);m=_f(l,a(e))}function u(e){return m=oe,b&&d?o(e):(d=g=oe,h)}function s(){m!==oe&&xf(m),x=0,d=p=g=m=oe}function c(){return m===oe?h:u(td())}function f(){var e=td(),n=i(e);if(d=arguments,g=this,p=e,n){if(m===oe)return r(p);if(y)return m=_f(l,t),o(p)}return m===oe&&(m=_f(l,t)),h}var d,g,v,h,m,p,x=0,T=!1,y=!1,b=!0;if("function"!=typeof e)throw new ic(ie);return t=yu(t)||0,eu(n)&&(T=!!n.leading,y="maxWait"in n,v=y?zc(yu(n.maxWait)||0,t):v,b="trailing"in n?!!n.trailing:b),f.cancel=s,f.flush=c,f}function _l(e){return ia(e,we)}function Sl(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ic(ie);var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],a=n.cache;if(a.has(r))return a.get(r);var i=e.apply(this,o);return n.cache=a.set(r,i)||a,i};return n.cache=new(Sl.Cache||ln),n}function Il(e){if("function"!=typeof e)throw new ic(ie);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function kl(e){return Cl(2,e)}function Ol(e,t){if("function"!=typeof e)throw new ic(ie);return t=t===oe?t:xu(t),tr(e,t)}function $l(e,t){if("function"!=typeof e)throw new ic(ie);return t=null==t?0:zc(xu(t),0),tr(function(n){var o=n[t],r=Mr(n,0,t);return o&&v(r,o),a(e,this,r)})}function Dl(e,t,n){var o=!0,r=!0;if("function"!=typeof e)throw new ic(ie);return eu(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),Pl(e,t,{leading:o,maxWait:t,trailing:r})}function jl(e){return bl(e,1)}function El(e,t){return ld(br(t),e)}function Al(){if(!arguments.length)return[];var e=arguments[0];return gd(e)?e:[e]}function Rl(e){return to(e,de)}function Ll(e,t){return t="function"==typeof t?t:oe,to(e,de,t)}function Bl(e){return to(e,ce|de)}function Nl(e,t){return t="function"==typeof t?t:oe,to(e,ce|de,t)}function Ul(e,t){return null==t||oo(e,t,Ru(t))}function zl(e,t){return e===t||e!==e&&t!==t}function Vl(e){return null!=e&&Ql(e.length)&&!Zl(e)}function Wl(e){return tu(e)&&Vl(e)}function Hl(e){return!0===e||!1===e||tu(e)&&po(e)==Ve}function Fl(e){return tu(e)&&1===e.nodeType&&!su(e)}function Yl(e){if(null==e)return!0;if(Vl(e)&&(gd(e)||"string"==typeof e||"function"==typeof e.splice||hd(e)||yd(e)||dd(e)))return!e.length;var t=Mf(e);if(t==Xe||t==et)return!e.size;if(La(e))return!Lo(e).length;for(var n in e)if(dc.call(e,n))return!1;return!0}function ql(e,t){return Io(e,t)}function Xl(e,t,n){n="function"==typeof n?n:oe;var o=n?n(e,t):oe;return o===oe?Io(e,t,oe,n):!!o}function Kl(e){if(!tu(e))return!1;var t=po(e);return t==Fe||t==He||"string"==typeof e.message&&"string"==typeof e.name&&!su(e)}function Gl(e){return"number"==typeof e&&Bc(e)}function Zl(e){if(!eu(e))return!1;var t=po(e);return t==Ye||t==qe||t==ze||t==Je}function Jl(e){return"number"==typeof e&&e==xu(e)}function Ql(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=De}function eu(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function tu(e){return null!=e&&"object"==typeof e}function nu(e,t){return e===t||$o(e,t,ya(t))}function ou(e,t,n){return n="function"==typeof n?n:oe,$o(e,t,ya(t),n)}function ru(e){return uu(e)&&e!=+e}function au(e){if(wf(e))throw new ec(ae);return Do(e)}function iu(e){return null===e}function lu(e){return null==e}function uu(e){return"number"==typeof e||tu(e)&&po(e)==Ke}function su(e){if(!tu(e)||po(e)!=Ze)return!1;var t=Mc(e);if(null===t)return!0;var n=dc.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&fc.call(n)==mc}function cu(e){return Jl(e)&&e>=-De&&e<=De}function fu(e){return"string"==typeof e||!gd(e)&&tu(e)&&po(e)==tt}function du(e){return"symbol"==typeof e||tu(e)&&po(e)==nt}function gu(e){return e===oe}function vu(e){return tu(e)&&Mf(e)==rt}function hu(e){return tu(e)&&po(e)==at}function mu(e){if(!e)return[];if(Vl(e))return fu(e)?Q(e):Er(e);if(Ic&&e[Ic])return W(e[Ic]());var t=Mf(e);return(t==Xe?H:t==et?X:Ku)(e)}function pu(e){if(!e)return 0===e?e:0;if((e=yu(e))===$e||e===-$e){return(e<0?-1:1)*je}return e===e?e:0}function xu(e){var t=pu(e),n=t%1;return t===t?n?t-n:t:0}function Tu(e){return e?eo(xu(e),0,Ae):0}function yu(e){if("number"==typeof e)return e;if(du(e))return Ee;if(eu(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=eu(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Dt,"");var n=Wt.test(e);return n||Ft.test(e)?In(e.slice(2),n?2:8):Vt.test(e)?Ee:+e}function bu(e){return Ar(e,Lu(e))}function Cu(e){return e?eo(xu(e),-De,De):0===e?e:0}function Mu(e){return null==e?"":dr(e)}function wu(e,t){var n=cf(e);return null==t?n:Gn(n,t)}function Pu(e,t){return y(e,xa(t,3),fo)}function _u(e,t){return y(e,xa(t,3),go)}function Su(e,t){return null==e?e:gf(e,xa(t,3),Lu)}function Iu(e,t){return null==e?e:vf(e,xa(t,3),Lu)}function ku(e,t){return e&&fo(e,xa(t,3))}function Ou(e,t){return e&&go(e,xa(t,3))}function $u(e){return null==e?[]:vo(e,Ru(e))}function Du(e){return null==e?[]:vo(e,Lu(e))}function ju(e,t,n){var o=null==e?oe:ho(e,t);return o===oe?n:o}function Eu(e,t){return null!=e&&Pa(e,t,To)}function Au(e,t){return null!=e&&Pa(e,t,yo)}function Ru(e){return Vl(e)?On(e):Lo(e)}function Lu(e){return Vl(e)?On(e,!0):Bo(e)}function Bu(e,t){var n={};return t=xa(t,3),fo(e,function(e,o,r){Jn(n,t(e,o,r),e)}),n}function Nu(e,t){var n={};return t=xa(t,3),fo(e,function(e,o,r){Jn(n,o,t(e,o,r))}),n}function Uu(e,t){return zu(e,Il(xa(t)))}function zu(e,t){if(null==e)return{};var n=g(ha(e),function(e){return[e]});return t=xa(t),Xo(e,n,function(e,n){return t(e,n[0])})}function Vu(e,t,n){t=Cr(t,e);var o=-1,r=t.length;for(r||(r=1,e=oe);++o<r;){var a=null==e?oe:e[Ka(t[o])];a===oe&&(o=r,a=n),e=Zl(a)?a.call(e):a}return e}function Wu(e,t,n){return null==e?e:rr(e,t,n)}function Hu(e,t,n,o){return o="function"==typeof o?o:oe,null==e?e:rr(e,t,n,o)}function Fu(e,t,n){var o=gd(e),r=o||hd(e)||yd(e);if(t=xa(t,4),null==n){var a=e&&e.constructor;n=r?o?new a:[]:eu(e)&&Zl(a)?cf(Mc(e)):{}}return(r?l:fo)(e,function(e,o,r){return t(n,e,o,r)}),n}function Yu(e,t){return null==e||vr(e,t)}function qu(e,t,n){return null==e?e:hr(e,t,br(n))}function Xu(e,t,n,o){return o="function"==typeof o?o:oe,null==e?e:hr(e,t,br(n),o)}function Ku(e){return null==e?[]:E(e,Ru(e))}function Gu(e){return null==e?[]:E(e,Lu(e))}function Zu(e,t,n){return n===oe&&(n=t,t=oe),n!==oe&&(n=yu(n),n=n===n?n:0),t!==oe&&(t=yu(t),t=t===t?t:0),eo(yu(e),t,n)}function Ju(e,t,n){return t=pu(t),n===oe?(n=t,t=0):n=pu(n),e=yu(e),bo(e,t,n)}function Qu(e,t,n){if(n&&"boolean"!=typeof n&&Da(e,t,n)&&(t=n=oe),n===oe&&("boolean"==typeof t?(n=t,t=oe):"boolean"==typeof e&&(n=e,e=oe)),e===oe&&t===oe?(e=0,t=1):(e=pu(e),t===oe?(t=e,e=0):t=pu(t)),e>t){var o=e;e=t,t=o}if(n||e%1||t%1){var r=Fc();return Vc(e+r*(t-e+Sn("1e-"+((r+"").length-1))),t)}return Jo(e,t)}function es(e){return Yd(Mu(e).toLowerCase())}function ts(e){return(e=Mu(e))&&e.replace(qt,Hn).replace(vn,"")}function ns(e,t,n){e=Mu(e),t=dr(t);var o=e.length;n=n===oe?o:eo(xu(n),0,o);var r=n;return(n-=t.length)>=0&&e.slice(n,r)==t}function os(e){return e=Mu(e),e&&Mt.test(e)?e.replace(bt,Fn):e}function rs(e){return e=Mu(e),e&&$t.test(e)?e.replace(Ot,"\\$&"):e}function as(e,t,n){e=Mu(e),t=xu(t);var o=t?J(e):0;if(!t||o>=t)return e;var r=(t-o)/2;return Qr(Ac(r),n)+e+Qr(Ec(r),n)}function is(e,t,n){e=Mu(e),t=xu(t);var o=t?J(e):0;return t&&o<t?e+Qr(t-o,n):e}function ls(e,t,n){e=Mu(e),t=xu(t);var o=t?J(e):0;return t&&o<t?Qr(t-o,n)+e:e}function us(e,t,n){return n||null==t?t=0:t&&(t=+t),Hc(Mu(e).replace(jt,""),t||0)}function ss(e,t,n){return t=(n?Da(e,t,n):t===oe)?1:xu(t),er(Mu(e),t)}function cs(){var e=arguments,t=Mu(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function fs(e,t,n){return n&&"number"!=typeof n&&Da(e,t,n)&&(t=n=oe),(n=n===oe?Ae:n>>>0)?(e=Mu(e),e&&("string"==typeof t||null!=t&&!xd(t))&&!(t=dr(t))&&z(e)?Mr(Q(e),0,n):e.split(t,n)):[]}function ds(e,t,n){return e=Mu(e),n=null==n?0:eo(xu(n),0,e.length),t=dr(t),e.slice(n,n+t.length)==t}function gs(e,t,o){var r=n.templateSettings;o&&Da(e,t,o)&&(t=oe),e=Mu(e),t=Pd({},t,r,la);var a,i,l=Pd({},t.imports,r.imports,la),u=Ru(l),s=E(l,u),c=0,f=t.interpolate||Xt,d="__p += '",g=rc((t.escape||Xt).source+"|"+f.source+"|"+(f===_t?Ut:Xt).source+"|"+(t.evaluate||Xt).source+"|$","g"),v="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++yn+"]")+"\n";e.replace(g,function(t,n,o,r,l,u){return o||(o=r),d+=e.slice(c,u).replace(Kt,N),n&&(a=!0,d+="' +\n__e("+n+") +\n'"),l&&(i=!0,d+="';\n"+l+";\n__p += '"),o&&(d+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),c=u+t.length,t}),d+="';\n";var h=t.variable;h||(d="with (obj) {\n"+d+"\n}\n"),d=(i?d.replace(pt,""):d).replace(xt,"$1").replace(Tt,"$1;"),d="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=qd(function(){return tc(u,v+"return "+d).apply(oe,s)});if(m.source=d,Kl(m))throw m;return m}function vs(e){return Mu(e).toLowerCase()}function hs(e){return Mu(e).toUpperCase()}function ms(e,t,n){if((e=Mu(e))&&(n||t===oe))return e.replace(Dt,"");if(!e||!(t=dr(t)))return e;var o=Q(e),r=Q(t);return Mr(o,R(o,r),L(o,r)+1).join("")}function ps(e,t,n){if((e=Mu(e))&&(n||t===oe))return e.replace(Et,"");if(!e||!(t=dr(t)))return e;var o=Q(e);return Mr(o,0,L(o,Q(t))+1).join("")}function xs(e,t,n){if((e=Mu(e))&&(n||t===oe))return e.replace(jt,"");if(!e||!(t=dr(t)))return e;var o=Q(e);return Mr(o,R(o,Q(t))).join("")}function Ts(e,t){var n=Pe,o=_e;if(eu(t)){var r="separator"in t?t.separator:r;n="length"in t?xu(t.length):n,o="omission"in t?dr(t.omission):o}e=Mu(e);var a=e.length;if(z(e)){var i=Q(e);a=i.length}if(n>=a)return e;var l=n-J(o);if(l<1)return o;var u=i?Mr(i,0,l).join(""):e.slice(0,l);if(r===oe)return u+o;if(i&&(l+=u.length-l),xd(r)){if(e.slice(l).search(r)){var s,c=u;for(r.global||(r=rc(r.source,Mu(zt.exec(r))+"g")),r.lastIndex=0;s=r.exec(c);)var f=s.index;u=u.slice(0,f===oe?l:f)}}else if(e.indexOf(dr(r),l)!=l){var d=u.lastIndexOf(r);d>-1&&(u=u.slice(0,d))}return u+o}function ys(e){return e=Mu(e),e&&Ct.test(e)?e.replace(yt,Yn):e}function bs(e,t,n){return e=Mu(e),t=n?oe:t,t===oe?V(e)?ne(e):T(e):e.match(t)||[]}function Cs(e){var t=null==e?0:e.length,n=xa();return e=t?g(e,function(e){if("function"!=typeof e[1])throw new ic(ie);return[n(e[0]),e[1]]}):[],tr(function(n){for(var o=-1;++o<t;){var r=e[o];if(a(r[0],this,n))return a(r[1],this,n)}})}function Ms(e){return no(to(e,ce))}function ws(e){return function(){return e}}function Ps(e,t){return null==e||e!==e?t:e}function _s(e){return e}function Ss(e){return Ro("function"==typeof e?e:to(e,ce))}function Is(e){return zo(to(e,ce))}function ks(e,t){return Vo(e,to(t,ce))}function Os(e,t,n){var o=Ru(t),r=vo(t,o);null!=n||eu(t)&&(r.length||!o.length)||(n=t,t=e,e=this,r=vo(t,Ru(t)));var a=!(eu(n)&&"chain"in n&&!n.chain),i=Zl(e);return l(r,function(n){var o=t[n];e[n]=o,i&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=Er(this.__actions__)).push({func:o,args:arguments,thisArg:e}),n.__chain__=t,n}return o.apply(e,v([this.value()],arguments))})}),e}function $s(){return $n._===this&&($n._=pc),this}function Ds(){}function js(e){return e=xu(e),tr(function(t){return Fo(t,e)})}function Es(e){return ja(e)?_(Ka(e)):Ko(e)}function As(e){return function(t){return null==e?oe:ho(e,t)}}function Rs(){return[]}function Ls(){return!1}function Bs(){return{}}function Ns(){return""}function Us(){return!0}function zs(e,t){if((e=xu(e))<1||e>De)return[];var n=Ae,o=Vc(e,Ae);t=xa(t),e-=Ae;for(var r=$(o,t);++n<e;)t(n);return r}function Vs(e){return gd(e)?g(e,Ka):du(e)?[e]:Er(If(Mu(e)))}function Ws(e){var t=++gc;return Mu(e)+t}function Hs(e){return e&&e.length?lo(e,_s,xo):oe}function Fs(e,t){return e&&e.length?lo(e,xa(t,2),xo):oe}function Ys(e){return P(e,_s)}function qs(e,t){return P(e,xa(t,2))}function Xs(e){return e&&e.length?lo(e,_s,No):oe}function Ks(e,t){return e&&e.length?lo(e,xa(t,2),No):oe}function Gs(e){return e&&e.length?O(e,_s):0}function Zs(e,t){return e&&e.length?O(e,xa(t,2)):0}t=null==t?$n:qn.defaults($n.Object(),t,qn.pick($n,Tn));var Js=t.Array,Qs=t.Date,ec=t.Error,tc=t.Function,nc=t.Math,oc=t.Object,rc=t.RegExp,ac=t.String,ic=t.TypeError,lc=Js.prototype,uc=tc.prototype,sc=oc.prototype,cc=t["__core-js_shared__"],fc=uc.toString,dc=sc.hasOwnProperty,gc=0,vc=function(){var e=/[^.]+$/.exec(cc&&cc.keys&&cc.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),hc=sc.toString,mc=fc.call(oc),pc=$n._,xc=rc("^"+fc.call(dc).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tc=En?t.Buffer:oe,yc=t.Symbol,bc=t.Uint8Array,Cc=Tc?Tc.allocUnsafe:oe,Mc=F(oc.getPrototypeOf,oc),wc=oc.create,Pc=sc.propertyIsEnumerable,_c=lc.splice,Sc=yc?yc.isConcatSpreadable:oe,Ic=yc?yc.iterator:oe,kc=yc?yc.toStringTag:oe,Oc=function(){try{var e=ba(oc,"defineProperty");return e({},"",{}),e}catch(e){}}(),$c=t.clearTimeout!==$n.clearTimeout&&t.clearTimeout,Dc=Qs&&Qs.now!==$n.Date.now&&Qs.now,jc=t.setTimeout!==$n.setTimeout&&t.setTimeout,Ec=nc.ceil,Ac=nc.floor,Rc=oc.getOwnPropertySymbols,Lc=Tc?Tc.isBuffer:oe,Bc=t.isFinite,Nc=lc.join,Uc=F(oc.keys,oc),zc=nc.max,Vc=nc.min,Wc=Qs.now,Hc=t.parseInt,Fc=nc.random,Yc=lc.reverse,qc=ba(t,"DataView"),Xc=ba(t,"Map"),Kc=ba(t,"Promise"),Gc=ba(t,"Set"),Zc=ba(t,"WeakMap"),Jc=ba(oc,"create"),Qc=Zc&&new Zc,ef={},tf=Ga(qc),nf=Ga(Xc),of=Ga(Kc),rf=Ga(Gc),af=Ga(Zc),lf=yc?yc.prototype:oe,uf=lf?lf.valueOf:oe,sf=lf?lf.toString:oe,cf=function(){function e(){}return function(t){if(!eu(t))return{};if(wc)return wc(t);e.prototype=t;var n=new e;return e.prototype=oe,n}}();n.templateSettings={escape:wt,evaluate:Pt,interpolate:_t,variable:"",imports:{_:n}},n.prototype=o.prototype,n.prototype.constructor=n,r.prototype=cf(o.prototype),r.prototype.constructor=r,x.prototype=cf(o.prototype),x.prototype.constructor=x,te.prototype.clear=Bt,te.prototype.delete=Gt,te.prototype.get=Zt,te.prototype.has=Jt,te.prototype.set=Qt,en.prototype.clear=tn,en.prototype.delete=nn,en.prototype.get=on,en.prototype.has=rn,en.prototype.set=an,ln.prototype.clear=un,ln.prototype.delete=sn,ln.prototype.get=cn,ln.prototype.has=fn,ln.prototype.set=dn,hn.prototype.add=hn.prototype.push=mn,hn.prototype.has=pn,xn.prototype.clear=Mn,xn.prototype.delete=wn,xn.prototype.get=Pn,xn.prototype.has=_n,xn.prototype.set=kn;var ff=Ur(fo),df=Ur(go,!0),gf=zr(),vf=zr(!0),hf=Qc?function(e,t){return Qc.set(e,t),e}:_s,mf=Oc?function(e,t){return Oc(e,"toString",{configurable:!0,enumerable:!1,value:ws(t),writable:!0})}:_s,pf=tr,xf=$c||function(e){return $n.clearTimeout(e)},Tf=Gc&&1/X(new Gc([,-0]))[1]==$e?function(e){return new Gc(e)}:Ds,yf=Qc?function(e){return Qc.get(e)}:Ds,bf=Rc?function(e){return null==e?[]:(e=oc(e),c(Rc(e),function(t){return Pc.call(e,t)}))}:Rs,Cf=Rc?function(e){for(var t=[];e;)v(t,bf(e)),e=Mc(e);return t}:Rs,Mf=po;(qc&&Mf(new qc(new ArrayBuffer(1)))!=lt||Xc&&Mf(new Xc)!=Xe||Kc&&"[object Promise]"!=Mf(Kc.resolve())||Gc&&Mf(new Gc)!=et||Zc&&Mf(new Zc)!=rt)&&(Mf=function(e){var t=po(e),n=t==Ze?e.constructor:oe,o=n?Ga(n):"";if(o)switch(o){case tf:return lt;case nf:return Xe;case of:return"[object Promise]";case rf:return et;case af:return rt}return t});var wf=cc?Zl:Ls,Pf=qa(hf),_f=jc||function(e,t){return $n.setTimeout(e,t)},Sf=qa(mf),If=function(e){var t=Sl(e,function(e){return n.size===ue&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(kt,function(e,n,o,r){t.push(o?r.replace(Nt,"$1"):n||e)}),t}),kf=tr(function(e,t){return Wl(e)?ao(e,co(t,1,Wl,!0)):[]}),Of=tr(function(e,t){var n=pi(t);return Wl(n)&&(n=oe),Wl(e)?ao(e,co(t,1,Wl,!0),xa(n,2)):[]}),$f=tr(function(e,t){var n=pi(t);return Wl(n)&&(n=oe),Wl(e)?ao(e,co(t,1,Wl,!0),oe,n):[]}),Df=tr(function(e){var t=g(e,yr);return t.length&&t[0]===e[0]?Co(t):[]}),jf=tr(function(e){var t=pi(e),n=g(e,yr);return t===pi(n)?t=oe:n.pop(),n.length&&n[0]===e[0]?Co(n,xa(t,2)):[]}),Ef=tr(function(e){var t=pi(e),n=g(e,yr);return t="function"==typeof t?t:oe,t&&n.pop(),n.length&&n[0]===e[0]?Co(n,oe,t):[]}),Af=tr(yi),Rf=ga(function(e,t){var n=null==e?0:e.length,o=Qn(e,t);return Zo(e,g(t,function(e){return $a(e,n)?+e:e}).sort(Or)),o}),Lf=tr(function(e){return gr(co(e,1,Wl,!0))}),Bf=tr(function(e){var t=pi(e);return Wl(t)&&(t=oe),gr(co(e,1,Wl,!0),xa(t,2))}),Nf=tr(function(e){var t=pi(e);return t="function"==typeof t?t:oe,gr(co(e,1,Wl,!0),oe,t)}),Uf=tr(function(e,t){return Wl(e)?ao(e,t):[]}),zf=tr(function(e){return xr(c(e,Wl))}),Vf=tr(function(e){var t=pi(e);return Wl(t)&&(t=oe),xr(c(e,Wl),xa(t,2))}),Wf=tr(function(e){var t=pi(e);return t="function"==typeof t?t:oe,xr(c(e,Wl),oe,t)}),Hf=tr(Vi),Ff=tr(function(e){var t=e.length,n=t>1?e[t-1]:oe;return n="function"==typeof n?(e.pop(),n):oe,Wi(e,n)}),Yf=ga(function(e){var t=e.length,n=t?e[0]:0,o=this.__wrapped__,a=function(t){return Qn(t,e)};return!(t>1||this.__actions__.length)&&o instanceof x&&$a(n)?(o=o.slice(n,+n+(t?1:0)),o.__actions__.push({func:Xi,args:[a],thisArg:oe}),new r(o,this.__chain__).thru(function(e){return t&&!e.length&&e.push(oe),e})):this.thru(a)}),qf=Br(function(e,t,n){dc.call(e,n)?++e[n]:Jn(e,n,1)}),Xf=qr(li),Kf=qr(ui),Gf=Br(function(e,t,n){dc.call(e,n)?e[n].push(t):Jn(e,n,[t])}),Zf=tr(function(e,t,n){var o=-1,r="function"==typeof t,i=Vl(e)?Js(e.length):[];return ff(e,function(e){i[++o]=r?a(t,e,n):wo(e,t,n)}),i}),Jf=Br(function(e,t,n){Jn(e,n,t)}),Qf=Br(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),ed=tr(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Da(e,t[0],t[1])?t=[]:n>2&&Da(t[0],t[1],t[2])&&(t=[t[0]]),Yo(e,co(t,1),[])}),td=Dc||function(){return $n.Date.now()},nd=tr(function(e,t,n){var o=he;if(n.length){var r=Y(n,pa(nd));o|=ye}return ia(e,o,t,n,r)}),od=tr(function(e,t,n){var o=he|me;if(n.length){var r=Y(n,pa(od));o|=ye}return ia(t,o,e,n,r)}),rd=tr(function(e,t){return ro(e,1,t)}),ad=tr(function(e,t,n){return ro(e,yu(t)||0,n)});Sl.Cache=ln;var id=pf(function(e,t){t=1==t.length&&gd(t[0])?g(t[0],j(xa())):g(co(t,1),j(xa()));var n=t.length;return tr(function(o){for(var r=-1,i=Vc(o.length,n);++r<i;)o[r]=t[r].call(this,o[r]);return a(e,this,o)})}),ld=tr(function(e,t){var n=Y(t,pa(ld));return ia(e,ye,oe,t,n)}),ud=tr(function(e,t){var n=Y(t,pa(ud));return ia(e,be,oe,t,n)}),sd=ga(function(e,t){return ia(e,Me,oe,oe,oe,t)}),cd=na(xo),fd=na(function(e,t){return e>=t}),dd=Po(function(){return arguments}())?Po:function(e){return tu(e)&&dc.call(e,"callee")&&!Pc.call(e,"callee")},gd=Js.isArray,vd=Ln?j(Ln):_o,hd=Lc||Ls,md=Bn?j(Bn):So,pd=Nn?j(Nn):Oo,xd=Un?j(Un):jo,Td=zn?j(zn):Eo,yd=Vn?j(Vn):Ao,bd=na(No),Cd=na(function(e,t){return e<=t}),Md=Nr(function(e,t){if(La(t)||Vl(t))return void Ar(t,Ru(t),e);for(var n in t)dc.call(t,n)&&Wn(e,n,t[n])}),wd=Nr(function(e,t){Ar(t,Lu(t),e)}),Pd=Nr(function(e,t,n,o){Ar(t,Lu(t),e,o)}),_d=Nr(function(e,t,n,o){Ar(t,Ru(t),e,o)}),Sd=ga(Qn),Id=tr(function(e,t){e=oc(e);var n=-1,o=t.length,r=o>2?t[2]:oe;for(r&&Da(t[0],t[1],r)&&(o=1);++n<o;)for(var a=t[n],i=Lu(a),l=-1,u=i.length;++l<u;){var s=i[l],c=e[s];(c===oe||zl(c,sc[s])&&!dc.call(e,s))&&(e[s]=a[s])}return e}),kd=tr(function(e){return e.push(oe,ua),a(Ed,oe,e)}),Od=Gr(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=hc.call(t)),e[t]=n},ws(_s)),$d=Gr(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=hc.call(t)),dc.call(e,t)?e[t].push(n):e[t]=[n]},xa),Dd=tr(wo),jd=Nr(function(e,t,n){Wo(e,t,n)}),Ed=Nr(function(e,t,n,o){Wo(e,t,n,o)}),Ad=ga(function(e,t){var n={};if(null==e)return n;var o=!1;t=g(t,function(t){return t=Cr(t,e),o||(o=t.length>1),t}),Ar(e,ha(e),n),o&&(n=to(n,ce|fe|de,sa));for(var r=t.length;r--;)vr(n,t[r]);return n}),Rd=ga(function(e,t){return null==e?{}:qo(e,t)}),Ld=aa(Ru),Bd=aa(Lu),Nd=Hr(function(e,t,n){return t=t.toLowerCase(),e+(n?es(t):t)}),Ud=Hr(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),zd=Hr(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Vd=Wr("toLowerCase"),Wd=Hr(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Hd=Hr(function(e,t,n){return e+(n?" ":"")+Yd(t)}),Fd=Hr(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Yd=Wr("toUpperCase"),qd=tr(function(e,t){try{return a(e,oe,t)}catch(e){return Kl(e)?e:new ec(e)}}),Xd=ga(function(e,t){return l(t,function(t){t=Ka(t),Jn(e,t,nd(e[t],e))}),e}),Kd=Xr(),Gd=Xr(!0),Zd=tr(function(e,t){return function(n){return wo(n,e,t)}}),Jd=tr(function(e,t){return function(n){return wo(e,n,t)}}),Qd=Jr(g),eg=Jr(s),tg=Jr(p),ng=ta(),og=ta(!0),rg=Zr(function(e,t){return e+t},0),ag=ra("ceil"),ig=Zr(function(e,t){return e/t},1),lg=ra("floor"),ug=Zr(function(e,t){return e*t},1),sg=ra("round"),cg=Zr(function(e,t){return e-t},0);return n.after=yl,n.ary=bl,n.assign=Md,n.assignIn=wd,n.assignInWith=Pd,n.assignWith=_d,n.at=Sd,n.before=Cl,n.bind=nd,n.bindAll=Xd,n.bindKey=od,n.castArray=Al,n.chain=Yi,n.chunk=Qa,n.compact=ei,n.concat=ti,n.cond=Cs,n.conforms=Ms,n.constant=ws,n.countBy=qf,n.create=wu,n.curry=Ml,n.curryRight=wl,n.debounce=Pl,n.defaults=Id,n.defaultsDeep=kd,n.defer=rd,n.delay=ad,n.difference=kf,n.differenceBy=Of,n.differenceWith=$f,n.drop=ni,n.dropRight=oi,n.dropRightWhile=ri,n.dropWhile=ai,n.fill=ii,n.filter=ol,n.flatMap=rl,n.flatMapDeep=al,n.flatMapDepth=il,n.flatten=si,n.flattenDeep=ci,n.flattenDepth=fi,n.flip=_l,n.flow=Kd,n.flowRight=Gd,n.fromPairs=di,n.functions=$u,n.functionsIn=Du,n.groupBy=Gf,n.initial=hi,n.intersection=Df,n.intersectionBy=jf,n.intersectionWith=Ef,n.invert=Od,n.invertBy=$d,n.invokeMap=Zf,n.iteratee=Ss,n.keyBy=Jf,n.keys=Ru,n.keysIn=Lu,n.map=cl,n.mapKeys=Bu,n.mapValues=Nu,n.matches=Is,n.matchesProperty=ks,n.memoize=Sl,n.merge=jd,n.mergeWith=Ed,n.method=Zd,n.methodOf=Jd,n.mixin=Os,n.negate=Il,n.nthArg=js,n.omit=Ad,n.omitBy=Uu,n.once=kl,n.orderBy=fl,n.over=Qd,n.overArgs=id,n.overEvery=eg,n.overSome=tg,n.partial=ld,n.partialRight=ud,n.partition=Qf,n.pick=Rd,n.pickBy=zu,n.property=Es,n.propertyOf=As,n.pull=Af,n.pullAll=yi,n.pullAllBy=bi,n.pullAllWith=Ci,n.pullAt=Rf,n.range=ng,n.rangeRight=og,n.rearg=sd,n.reject=vl,n.remove=Mi,n.rest=Ol,n.reverse=wi,n.sampleSize=ml,n.set=Wu,n.setWith=Hu,n.shuffle=pl,n.slice=Pi,n.sortBy=ed,n.sortedUniq=Di,n.sortedUniqBy=ji,n.split=fs,n.spread=$l,n.tail=Ei,n.take=Ai,n.takeRight=Ri,n.takeRightWhile=Li,n.takeWhile=Bi,n.tap=qi,n.throttle=Dl,n.thru=Xi,n.toArray=mu,n.toPairs=Ld,n.toPairsIn=Bd,n.toPath=Vs,n.toPlainObject=bu,n.transform=Fu,n.unary=jl,n.union=Lf,n.unionBy=Bf,n.unionWith=Nf,n.uniq=Ni,n.uniqBy=Ui,n.uniqWith=zi,n.unset=Yu,n.unzip=Vi,n.unzipWith=Wi,n.update=qu,n.updateWith=Xu,n.values=Ku,n.valuesIn=Gu,n.without=Uf,n.words=bs,n.wrap=El,n.xor=zf,n.xorBy=Vf,n.xorWith=Wf,n.zip=Hf,n.zipObject=Hi,n.zipObjectDeep=Fi,n.zipWith=Ff,n.entries=Ld,n.entriesIn=Bd,n.extend=wd,n.extendWith=Pd,Os(n,n),n.add=rg,n.attempt=qd,n.camelCase=Nd,n.capitalize=es,n.ceil=ag,n.clamp=Zu,n.clone=Rl,n.cloneDeep=Bl,n.cloneDeepWith=Nl,n.cloneWith=Ll,n.conformsTo=Ul,n.deburr=ts,n.defaultTo=Ps,n.divide=ig,n.endsWith=ns,n.eq=zl,n.escape=os,n.escapeRegExp=rs,n.every=nl,n.find=Xf,n.findIndex=li,n.findKey=Pu,n.findLast=Kf,n.findLastIndex=ui,n.findLastKey=_u,n.floor=lg,n.forEach=ll,n.forEachRight=ul,n.forIn=Su,n.forInRight=Iu,n.forOwn=ku,n.forOwnRight=Ou,n.get=ju,n.gt=cd,n.gte=fd,n.has=Eu,n.hasIn=Au,n.head=gi,n.identity=_s,n.includes=sl,n.indexOf=vi,n.inRange=Ju,n.invoke=Dd,n.isArguments=dd,n.isArray=gd,n.isArrayBuffer=vd,n.isArrayLike=Vl,n.isArrayLikeObject=Wl,n.isBoolean=Hl,n.isBuffer=hd,n.isDate=md,n.isElement=Fl,n.isEmpty=Yl,n.isEqual=ql,n.isEqualWith=Xl,n.isError=Kl,n.isFinite=Gl,n.isFunction=Zl,n.isInteger=Jl,n.isLength=Ql,n.isMap=pd,n.isMatch=nu,n.isMatchWith=ou,n.isNaN=ru,n.isNative=au,n.isNil=lu,n.isNull=iu,n.isNumber=uu,n.isObject=eu,n.isObjectLike=tu,n.isPlainObject=su,n.isRegExp=xd,n.isSafeInteger=cu,n.isSet=Td,n.isString=fu,n.isSymbol=du,n.isTypedArray=yd,n.isUndefined=gu,n.isWeakMap=vu,n.isWeakSet=hu,n.join=mi,n.kebabCase=Ud,n.last=pi,n.lastIndexOf=xi,n.lowerCase=zd,n.lowerFirst=Vd,n.lt=bd,n.lte=Cd,n.max=Hs,n.maxBy=Fs,n.mean=Ys,n.meanBy=qs,n.min=Xs,n.minBy=Ks,n.stubArray=Rs,n.stubFalse=Ls,n.stubObject=Bs,n.stubString=Ns,n.stubTrue=Us,n.multiply=ug,n.nth=Ti,n.noConflict=$s,n.noop=Ds,n.now=td,n.pad=as,n.padEnd=is,n.padStart=ls,n.parseInt=us,n.random=Qu,n.reduce=dl,n.reduceRight=gl,n.repeat=ss,n.replace=cs,n.result=Vu,n.round=sg,n.runInContext=e,n.sample=hl,n.size=xl,n.snakeCase=Wd,n.some=Tl,n.sortedIndex=_i,n.sortedIndexBy=Si,n.sortedIndexOf=Ii,n.sortedLastIndex=ki,n.sortedLastIndexBy=Oi,n.sortedLastIndexOf=$i,n.startCase=Hd,n.startsWith=ds,n.subtract=cg,n.sum=Gs,n.sumBy=Zs,n.template=gs,n.times=zs,n.toFinite=pu,n.toInteger=xu,n.toLength=Tu,n.toLower=vs,n.toNumber=yu,n.toSafeInteger=Cu,n.toString=Mu,n.toUpper=hs,n.trim=ms,n.trimEnd=ps,n.trimStart=xs,n.truncate=Ts,n.unescape=ys,n.uniqueId=Ws,n.upperCase=Fd,n.upperFirst=Yd,n.each=ll,n.eachRight=ul,n.first=gi,Os(n,function(){var e={};return fo(n,function(t,o){dc.call(n.prototype,o)||(e[o]=t)}),e}(),{chain:!1}),n.VERSION="4.17.5",l(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){n[e].placeholder=n}),l(["drop","take"],function(e,t){x.prototype[e]=function(n){n=n===oe?1:zc(xu(n),0);var o=this.__filtered__&&!t?new x(this):this.clone();return o.__filtered__?o.__takeCount__=Vc(n,o.__takeCount__):o.__views__.push({size:Vc(n,Ae),type:e+(o.__dir__<0?"Right":"")}),o},x.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),l(["filter","map","takeWhile"],function(e,t){var n=t+1,o=n==ke||3==n;x.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:xa(e,3),type:n}),t.__filtered__=t.__filtered__||o,t}}),l(["head","last"],function(e,t){var n="take"+(t?"Right":"");x.prototype[e]=function(){return this[n](1).value()[0]}}),l(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");x.prototype[e]=function(){return this.__filtered__?new x(this):this[n](1)}}),x.prototype.compact=function(){return this.filter(_s)},x.prototype.find=function(e){return this.filter(e).head()},x.prototype.findLast=function(e){return this.reverse().find(e)},x.prototype.invokeMap=tr(function(e,t){return"function"==typeof e?new x(this):this.map(function(n){return wo(n,e,t)})}),x.prototype.reject=function(e){return this.filter(Il(xa(e)))},x.prototype.slice=function(e,t){e=xu(e);var n=this;return n.__filtered__&&(e>0||t<0)?new x(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==oe&&(t=xu(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},x.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},x.prototype.toArray=function(){return this.take(Ae)},fo(x.prototype,function(e,t){var o=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),i=n[a?"take"+("last"==t?"Right":""):t],l=a||/^find/.test(t);i&&(n.prototype[t]=function(){var t=this.__wrapped__,u=a?[1]:arguments,s=t instanceof x,c=u[0],f=s||gd(t),d=function(e){var t=i.apply(n,v([e],u));return a&&g?t[0]:t};f&&o&&"function"==typeof c&&1!=c.length&&(s=f=!1);var g=this.__chain__,h=!!this.__actions__.length,m=l&&!g,p=s&&!h;if(!l&&f){t=p?t:new x(this);var T=e.apply(t,u);return T.__actions__.push({func:Xi,args:[d],thisArg:oe}),new r(T,g)}return m&&p?e.apply(this,u):(T=this.thru(d),m?a?T.value()[0]:T.value():T)})}),l(["pop","push","shift","sort","splice","unshift"],function(e){var t=lc[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);n.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var n=this.value();return t.apply(gd(n)?n:[],e)}return this[o](function(n){return t.apply(gd(n)?n:[],e)})}}),fo(x.prototype,function(e,t){var o=n[t];if(o){var r=o.name+"";(ef[r]||(ef[r]=[])).push({name:t,func:o})}}),ef[Kr(oe,me).name]=[{name:"wrapper",func:oe}],x.prototype.clone=S,x.prototype.reverse=G,x.prototype.value=ee,n.prototype.at=Yf,n.prototype.chain=Ki,n.prototype.commit=Gi,n.prototype.next=Zi,n.prototype.plant=Qi,n.prototype.reverse=el,n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=tl,n.prototype.first=n.prototype.head,Ic&&(n.prototype[Ic]=Ji),n}();$n._=qn,(r=function(){return qn}.call(t,n,t,o))!==oe&&(o.exports=r)}).call(this)}).call(t,n(125),n(126)(e))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function o(e){console.log("ENABLE UNDO");var t=(0,i.getToolState)(e,"regions"),n=t.data[0];if(!(n.history.length<1)){var o=n.history.pop();console.log("HIST",n.history),n.buffer=o,a.external.cornerstone.updateImage(e)}}function r(e){}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(1);t.default={activate:o,deactivate:r,enable:o,disable:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="1.1.0"}])});
//# sourceMappingURL=cornerstoneTools.min.js.map